{"version":1,"kind":"Notebook","sha256":"7913d885b7c7e7c6b39da424eec575b40c6e24e72db6383b9e2b331cfb8732f6","slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-cloud-uncertainties","location":"/external_notebooks/esa-cci/ect-training/lps_vienna_06_2025/LPS_cloud_uncertainties.ipynb","dependencies":[],"frontmatter":{"title":"1. Import Necessary Packages","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"github":"https://github.com/esa-cci/cci-notebook-viewers","subject":"CCI Examples","numbering":{"title":{"offset":4}},"edit_url":"https://github.com/esa-cci/cci-notebook-viewers/blob/main/external_notebooks/esa-cci/ect-training/lps_vienna_06_2025/LPS_cloud_uncertainties.ipynb","exports":[{"format":"ipynb","filename":"LPS_cloud_uncertainties.ipynb","url":"/cci-notebook-viewers/build/LPS_cloud_uncertaint-35970927097ec602df9a9f5d4e24ce84.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"div","style":{"textAlign":"center"},"children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"LPS Training - Advanced Level: Uncertainties in Essential Climate Variables (ECVs): A Focus on Clouds","key":"sJg8uEQGQU"}],"identifier":"lps-training-advanced-level-uncertainties-in-essential-climate-variables-ecvs-a-focus-on-clouds","label":"LPS Training - Advanced Level: Uncertainties in Essential Climate Variables (ECVs): A Focus on Clouds","html_id":"lps-training-advanced-level-uncertainties-in-essential-climate-variables-ecvs-a-focus-on-clouds","implicit":true,"key":"vBWYNYI0Y1"}],"key":"Qo7WRJPNTx"}],"key":"e3FnOqvhcX"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Image, display\ndisplay(Image(filename='CCI_logo.PNG'))","key":"diJSOtkLUg"},{"type":"output","id":"9CET-B_vaORPDFK23WpUU","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d7470a09559f4e8130ac3a2b99a44940","path":"/cci-notebook-viewers/build/d7470a09559f4e8130ac3a2b99a44940.png"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}}],"key":"FQl78Xe8BU"}],"key":"sdoXvHhbDN"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[{"type":"heading","depth":2,"children":[{"type":"text","value":"Introduction:","key":"MV8l3nkgpN"}],"identifier":"introduction","label":"Introduction:","html_id":"introduction","implicit":true,"key":"TRIeKRH6AG"}],"key":"hP22kR3hdc"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In climate science, no measurement is perfect—and understanding the uncertainties in our data is crucial for interpreting trends and making robust conclusions. This notebook explores the uncertainties associated with Essential Climate Variables (ECVs), using cloud properties as a representative example.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"c0XAKPKzSd"}],"key":"WlIS65QYjn"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The ESA Climate Change Initiative (CCI) provides not only long-term datasets of key climate parameters, but also associated per-pixel uncertainty layers that quantify the confidence in each data point. These uncertainty values reflect the effects of sensor noise, retrieval limitations, and algorithm assumptions, all of which are especially relevant in satellite-derived variables like cloud cover.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"VStxEgyAV0"}],"key":"f7TxRZnFre"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Using the ESA CCI Toolbox, we will:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Zv1jXHftiu"}],"key":"WoRw5bfBl5"}],"key":"KwVm5K3enF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Load both the primary cloud dataset (e.g. total cloud fraction and liquid water path) and its associated uncertainty layer","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"vuU5PjIepd"}],"key":"eF5kM95LOJ"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Visualize spatial patterns of cloud cover and uncertainty and liquid water path and its uncertainty","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"EljfUftEEm"}],"key":"mK03G6AOHK"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Discuss what these uncertainty values represent and how to interpret them when analyzing climate signals","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"doWRmDtOjw"}],"key":"XmQ6Q5OLVO"}],"key":"oUeXjSxt6D"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"By the end of this section, you’ll gain a better understanding of:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"A0yCWjkiCq"}],"key":"dGb2eT1YXj"}],"key":"YlUd2wLnbt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Why uncertainty information is critical for satellite climate datasets","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"pVhw4ilYgN"}],"key":"Ch6fjWXJd3"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"How the CCI represents and provides uncertainty","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"pHX2KOEn67"}],"key":"jCmFHmCxuF"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"How to visualize and work with these values in your own analyses","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"XUq2wLbl2y"}],"key":"GkXJPHnP2D"}],"key":"WZtQTIYArL"},{"type":"div","children":[],"key":"hG57D3fb5X"}],"key":"b25uDL2St2"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1. Import Necessary Packages","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y1B9e3UIvV"}],"identifier":"id-1-import-necessary-packages","label":"1. Import Necessary Packages","html_id":"id-1-import-necessary-packages","implicit":true,"key":"wOQQFfLsav"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this section, we import the required Python packages to work with ESA Climate Change Initiative (CCI) data. Most notably, we use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mi59EMroM6"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ESA Climate Toolbox","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"R8JHqWJ53u"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/","key":"gvEnhusW1b"},{"type":"text","value":" which simplifies access, manipulation, and visualization of CCI datasets in Python.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XqdYtXDkP2"}],"key":"CIeZpcKwyJ"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"These packages allow us to:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rAej5sVViQ"}],"key":"t4NakREm5U"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Access satellite-based climate data records from ESA.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QtXw5Uihsg"}],"key":"C4MH2T6yWt"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Handle geospatial and temporal dimensions efficiently.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"RkybM8tlsP"}],"key":"sKjoDGECjm"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Visualize data with intuitive plotting tools.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"PdvKzVXSSA"}],"key":"qll8jmDAdm"}],"key":"QTZxwRlfVn"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"📚 For a broader introduction to the toolbox and how to install it, visit:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"B527pIM7k4"},{"type":"break","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"OfAZJNaAI9"},{"type":"text","value":"🔗 ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"mit2DmSRJ6"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#jupyter-notebooks","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"ESA CCI Climate Toolbox Quick Start","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"flrMOObJDo"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#jupyter-notebooks","key":"SPqOE3osy0"},{"type":"break","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"h5oBJIOm3y"},{"type":"text","value":"🔗 ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"dq4L1sTi6C"},{"type":"link","url":"https://climate.esa.int/en/data/toolbox/","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"ESA Climate Data Toolbox Website","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"oWH9AY8KLJ"}],"urlSource":"https://climate.esa.int/en/data/toolbox/","key":"Ad3z5E75lD"}],"key":"yP7c1XNzc1"}],"key":"aEb9K7yV6p"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Create a new data store (e.g., remote or local access point for datasets)\nfrom xcube.core.store import new_data_store\n\n# Core functions from the ESA Climate Toolbox to access and process ECV datasets\nfrom esa_climate_toolbox.core import get_op               # Get predefined operations (e.g., time series mean, subsetting)\nfrom esa_climate_toolbox.core import list_ecv_datasets    # List available Essential Climate Variable (ECV) datasets\nfrom esa_climate_toolbox.core import get_store            # Connect to a specific data store (e.g., ESA CCI)\nfrom esa_climate_toolbox.core import list_datasets        # List all datasets within the selected store\n\n# Plotting utility for ESA CCI toolbox outputs\nfrom esa_climate_toolbox.ops import plot                  # Quick plotting for processed data\n\n# Work with labeled multi-dimensional arrays (ideal for satellite/climate data)\nimport xarray as xr\n\n# Plotting library for static figures\nimport matplotlib.pyplot as plt\n# Ensure that plots appear inline in Jupyter notebooks\n%matplotlib inline  \n\n# Suppress warning messages (optional, for cleaner notebook output)\nimport warnings\n\n# Numerical operations and array manipulation\nimport numpy as np\n\n# Interactive plotting with Plotly\nimport plotly.io as pio\npio.renderers.default = 'notebook_connected'  # Ensures Plotly figures render properly in notebooks\n\nimport plotly.graph_objects as go  # Create detailed and interactive figures with full layout control","key":"gXuZxrh2Tp"},{"type":"output","id":"SJDxT8TDxhvayEL6AUPiW","data":[],"key":"au45VMRPnU"}],"key":"adDEqp3kEL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 2: Connect to the ESA CCI Data Store","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GKXuUewbRd"}],"identifier":"step-2-connect-to-the-esa-cci-data-store","label":"Step 2: Connect to the ESA CCI Data Store","html_id":"step-2-connect-to-the-esa-cci-data-store","implicit":true,"key":"fQ0o0d61V7"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ESA Climate Toolbox provides direct access to the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ViGpWSEgGJ"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ESA Climate Data Store","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H5tdaHEBQA"}],"key":"Bop1jV7NRD"},{"type":"text","value":", which hosts harmonized satellite-based climate data records produced under the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Rc5uPV4Ete"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ESA Climate Change Initiative (CCI)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cxzlHNmmmC"}],"key":"faXMYG6AuV"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZMA6VIK5Sd"}],"key":"BOnDkywi9T"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In this step, we establish a connection to the data store so we can browse and open datasets. This connection allows us to access data ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yYbSXuTiZ1"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"without having to download files manually","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"G4k4cH1ynB"}],"key":"MKIcjR58rg"},{"type":"text","value":" — a convenient way to explore and analyze large geospatial datasets in cloud-friendly formats such as ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"RTVdOrRL1x"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Zarr","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"n1VItsyVBy"}],"key":"TabDGSqlpM"},{"type":"text","value":" or ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cBHZAOuMCK"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Kerchunk","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZbXgclgSih"}],"key":"gQQJUQAQCU"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"W6Ddnh6KtB"}],"key":"W8bQElKlMy"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The data store includes a wide range of essential climate variables (ECVs), such as aerosols, land surface temperature, sea level, and soil moisture.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PVf0HLorT2"}],"key":"SHyhlMvwG0"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"📘 Learn more about available datasets:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"F1jvQ5I7LK"},{"type":"break","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qQcH4ej7p1"},{"type":"text","value":"🔗 ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"yOxo48H0IP"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#data-access","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"ESA Climate Data Toolbox – Quick Start Guide","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qGTjzyqWA5"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#data-access","key":"xFKX3s16CV"}],"key":"azJe0N71d8"}],"key":"Aw73bVX4Vd"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"cci_store = new_data_store(\"esa-cci\")\n# List all available data sets of an ECV\nlist_ecv_datasets(\"Cloud\")","key":"kkAeaFwSZL"},{"type":"output","id":"ayasJWxv3DGpphhXGpDhJ","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"[('esacci.CLOUD.mon.L3C.CLD_PRODUCTS.MODIS.Aqua.MODIS_AQUA.2-0.r1', 'esa-cci'),\n ('esacci.CLOUD.mon.L3C.CLD_PRODUCTS.MODIS.Terra.MODIS_TERRA.2-0.r1',\n  'esa-cci'),\n ('esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.multi-platform.ATSR2-AATSR.3-0.r1',\n  'esa-cci'),\n ('esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.multi-platform.AVHRR-AM.3-0.r1',\n  'esa-cci'),\n ('esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.multi-platform.AVHRR-PM.3-0.r1',\n  'esa-cci'),\n ('esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.multi-platform.MERIS-AATSR.2-0.r1',\n  'esa-cci'),\n ('ESACCI-L3C_CLOUD-CLD_PRODUCTS-MODIS_AQUA-200208-201412-fv2.0_kr1.0',\n  'esa-cci-kc'),\n ('ESACCI-L3C_CLOUD-CLD_PRODUCTS-ATSR2_AATSR-199506-201204-fv3.0-kr1.1',\n  'esa-cci-kc'),\n ('ESACCI-L3C_CLOUD-CLD_PRODUCTS-AVHRR_AM-199109-201612-fv3.0-kr1.1',\n  'esa-cci-kc'),\n ('ESACCI-L3C_CLOUD-CLD_PRODUCTS-AVHRR_PM-198201-201612-fv3.0-kr1.1',\n  'esa-cci-kc'),\n ('ESACCI-L3C_CLOUD-CLD_PRODUCTS-MERIS-AATSR_ENVISAT-200301-201112_fv2.0_kr1.0',\n  'esa-cci-kc'),\n ('ESACCI-L3C_CLOUD-CLD_PRODUCTS-AVHRR_NOAA-1982-2016-fv3.0.zarr',\n  'esa-cci-zarr')]","content_type":"text/plain"}}}],"key":"BgtwjlrqRh"}],"key":"Px2H7DQ2ih"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 3: Define the Dataset ID","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ynif4PJ49T"}],"identifier":"step-3-define-the-dataset-id","label":"Step 3: Define the Dataset ID","html_id":"step-3-define-the-dataset-id","implicit":true,"key":"PfpU6iocBI"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"To work with a specific ESA CCI dataset, we need to specify its ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"oUG6RohOem"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"dataset ID","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"aPtd7K4Ycr"}],"key":"LYHQWKdQpt"},{"type":"text","value":". This unique identifier tells the toolbox which variable and product we want to access.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FjvHm3sabZ"}],"key":"okdLtvx5Cu"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In this example, we are using a dataset from the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Hgu1iPZRUt"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Cloud CCI project","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"EmngUdyGB8"}],"key":"lv7o1WmD7S"},{"type":"text","value":" that provides monthly Level 3 cloud property products, derived from multiple satellite sensors. These products include key cloud variables such as ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"AnxHlvMRwl"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"cloud fraction (cfc)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UJAGS6Ql2Z"}],"key":"lwWoL9iplH"},{"type":"text","value":" and ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"pbX7zyd1gJ"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"liquid water path (lwp)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"VhDe9bNceO"}],"key":"FNERLUMF6e"},{"type":"text","value":" including their uncertainties.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WOGQD93qj4"}],"key":"eMxoYtBTzZ"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"We will use the following dataset ID:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"aKYzBuSL9S"}],"key":"Oe6OVV6Wkd"}],"key":"JwmPk1ssnB"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"data_id = 'esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.multi-platform.AVHRR-PM.3-0.r1'\ncci_store.describe_data(data_id)","key":"wio0z5l2XG"},{"type":"output","id":"vAa3ceSJEjxBUaJgy9QAu","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"application/json":{"content_type":"application/json","hash":"4a745d7e7defa0d989f263f9fcd8a08b","path":"/cci-notebook-viewers/build/4a745d7e7defa0d989f263f9fcd8a08b.json"},"text/plain":{"content":"<xcube.core.store.descriptor.DatasetDescriptor at 0x7f4b4eef6a50>","content_type":"text/plain"}}}],"key":"MqVGklWEhW"}],"key":"TklcITT2ua"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"You can find more information on the dataset on the CEDA website ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BtPc9XmFke"},{"type":"link","url":"https://catalogue.ceda.ac.uk/uuid/004fd44ff5124174ad3c03dd2c67d548/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"(Link)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ngT7h2fk4j"}],"urlSource":"https://catalogue.ceda.ac.uk/uuid/004fd44ff5124174ad3c03dd2c67d548/","key":"RAGc9fMBRe"},{"type":"text","value":".\nIf you click on “Related Documents”, you can find the documents about the algorithm description (ATBD CC4CL and ATBD). Those documents include the information on how the uncertainties are calculated and which parameters are included in the dataset.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lEYRrkSBZk"}],"key":"xIy66sXx6W"}],"key":"ZLbd4YO1UL"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 4: Define Time Range and Variables of Interest and Open the Dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l1GT0phBwF"}],"identifier":"step-4-define-time-range-and-variables-of-interest-and-open-the-dataset","label":"Step 4: Define Time Range and Variables of Interest and Open the Dataset","html_id":"step-4-define-time-range-and-variables-of-interest-and-open-the-dataset","implicit":true,"key":"itBL9soisU"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Before opening the dataset, we define a few key parameters. We focus on only one day to decrease the dataload. If you wish to look at the time series of the uncertainties, you can change the start and end date to the desired time range.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Jew9WRlrRC"}],"key":"a1m1sxXe9Q"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Time range","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ScQuSnEw88"}],"key":"H0A7DvoSlo"},{"type":"text","value":": the date(s) we want to load","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Fgf0JmHzRr"}],"key":"dr0MahADID"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Variables","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"vm1vqf0dK7"}],"key":"VT1y5v51U9"},{"type":"text","value":": which data variable(s) to retrieve","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ery62MM8GD"}],"key":"oDrqUqZYbL"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"(Optional)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"hXNsUldsgF"}],"key":"Ii1LfjRkvl"},{"type":"text","value":" ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GuLZEET0l1"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Bounding box","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gOfPAHIi7p"}],"key":"Ukawx7w0Mj"},{"type":"text","value":": spatial region of interest — here we skip it to load the global dataset","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CIxNwvg9QR"}],"key":"Xz6C9GbifS"}],"key":"rRFNLDq1XZ"}],"key":"xFSebeL2y4"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"variables = ['cfc','cfc_unc','lwp','lwp_unc','lwp_prop_unc','lwp_corr_unc']  # Variables to retrieve, their names can be found through the cci_store.describe_data(data_id) command above\nstart_date = '1997-12-01'    # Start and end date (same for a single timestep)\nend_date = '1997-12-01'","key":"q5VODigWTB"},{"type":"output","id":"jt3ew5NnizSZ9-0pkVYic","data":[],"key":"YPuuFewdnb"}],"key":"qJs64CvMht"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now we open the dataset using the selected parameters.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zn22XaONzs"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IZ2wl1PS6B"},{"type":"text","value":"The ESA Climate Toolbox will download only the necessary data (e.g., variable and time range).\nYou can always adjust the time range or variables to explore different slices of the dataset.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SJdrAOl8Mr"}],"key":"HNP1Phlh9u"}],"key":"o9Rgbq7ODd"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"cloud_ds = cci_store.open_data(\n    data_id=data_id,\n    variable_names=variables,\n    time_range=[start_date, end_date]\n)\ndisplay(cloud_ds)","key":"WjWVCV4xIp"},{"type":"output","id":"B4LL6W6TedHS-D-dqTwZY","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"6ef28f8e77dcab6ae7f1f1ebdc97d5e5","path":"/cci-notebook-viewers/build/6ef28f8e77dcab6ae7f1f1ebdc97d5e5.html"},"text/plain":{"content":"<xarray.Dataset> Size: 12MB\nDimensions:                       (time: 1, lat: 360, lon: 720,\n                                   hist1d_cer_bin_border: 12,\n                                   hist1d_cer_bin_centre: 11,\n                                   hist1d_cla_vis006_bin_border: 14,\n                                   hist1d_cla_vis006_bin_centre: 13,\n                                   hist1d_cla_vis008_bin_border: 14,\n                                   ...\n                                   hist1d_cwp_bin_centre: 14,\n                                   hist2d_cot_bin_border: 14,\n                                   hist2d_cot_bin_centre: 13,\n                                   hist2d_ctp_bin_border: 16,\n                                   hist2d_ctp_bin_centre: 15, hist_phase: 2,\n                                   bnds: 2)\nCoordinates: (12/23)\n  * hist1d_cer_bin_border         (hist1d_cer_bin_border) float32 48B 0.0 ......\n  * hist1d_cer_bin_centre         (hist1d_cer_bin_centre) float32 44B 1.5 ......\n  * hist1d_cla_vis006_bin_border  (hist1d_cla_vis006_bin_border) float32 56B ...\n  * hist1d_cla_vis006_bin_centre  (hist1d_cla_vis006_bin_centre) float32 52B ...\n  * hist1d_cla_vis008_bin_border  (hist1d_cla_vis008_bin_border) float32 56B ...\n  * hist1d_cla_vis008_bin_centre  (hist1d_cla_vis008_bin_centre) float32 52B ...\n    ...                            ...\n  * hist2d_ctp_bin_centre         (hist2d_ctp_bin_centre) float32 60B 45.5 .....\n  * hist_phase                    (hist_phase) int8 2B 0 1\n  * lat                           (lat) float32 1kB -89.75 -89.25 ... 89.75\n  * lon                           (lon) float32 3kB -179.8 -179.2 ... 179.8\n  * time                          (time) datetime64[ns] 8B 1997-12-16T12:00:00\n    time_bnds                     (time, bnds) datetime64[ns] 16B dask.array<chunksize=(1, 2), meta=np.ndarray>\nDimensions without coordinates: bnds\nData variables:\n    cfc                           (time, lat, lon) float64 2MB dask.array<chunksize=(1, 360, 720), meta=np.ndarray>\n    cfc_unc                       (time, lat, lon) float64 2MB dask.array<chunksize=(1, 360, 720), meta=np.ndarray>\n    lwp                           (time, lat, lon) float64 2MB dask.array<chunksize=(1, 360, 720), meta=np.ndarray>\n    lwp_corr_unc                  (time, lat, lon) float64 2MB dask.array<chunksize=(1, 360, 720), meta=np.ndarray>\n    lwp_prop_unc                  (time, lat, lon) float64 2MB dask.array<chunksize=(1, 360, 720), meta=np.ndarray>\n    lwp_unc                       (time, lat, lon) float64 2MB dask.array<chunksize=(1, 360, 720), meta=np.ndarray>\nAttributes:\n    Conventions:             CF-1.7\n    title:                   esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.m...\n    date_created:            2025-06-18T13:35:53.010899\n    processing_level:        L3C\n    time_coverage_start:     1997-12-01T00:00:00\n    time_coverage_end:       1998-01-01T00:00:00\n    time_coverage_duration:  P31DT0H0M0S\n    history:                 [{'program': 'xcube_cci.chunkstore.CciChunkStore...","content_type":"text/plain"}}}],"key":"HXdeWMl61a"}],"key":"KZRV0EfbZs"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 5: Extract the Variables and create a 3D Plot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YZJdvQtEw3"}],"identifier":"step-5-extract-the-variables-and-create-a-3d-plot","label":"Step 5: Extract the Variables and create a 3D Plot","html_id":"step-5-extract-the-variables-and-create-a-3d-plot","implicit":true,"key":"olEznnOTSZ"},{"type":"heading","depth":4,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Cloud Fraction (CFC)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"KJjIFAYlOf"}],"identifier":"cloud-fraction-cfc","label":"Cloud Fraction (CFC)","html_id":"cloud-fraction-cfc","implicit":true,"key":"VxyAk9gXgA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Next, we extract the variables we would like to plot. We start with the cloud fraction (CFC) and its uncertainty.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QJoxWyJT2G"}],"key":"Q8ZTn3rqxJ"}],"key":"kKxoegaRXh"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Extract variables\ncfc = cloud_ds['cfc'].squeeze()\ncfc_unc = cloud_ds['cfc_unc'].squeeze()\n\n# Get coordinate arrays - the lat and lon are the same for cfc_unc and cfc, thus we only load them here via the cfc variable\nlon = cfc['lon'].values\nlat = cfc['lat'].values\n\n# Get 2D grids (assuming dims are [lat, lon])\nz_unc = cfc_unc.values  # Uncertainty for Z-axis\nsurface_color = cfc.values  # For coloring the surface","key":"fRTBCkdXuL"},{"type":"output","id":"wgSQp97cQPgYCJTAxgiEy","data":[],"key":"UZQrw8awfR"}],"key":"BOqotxZnk3"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZYcrwxoOiB"},{"type":"inlineCode","value":"plotly","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xbhwf28zKs"},{"type":"text","value":" package to create an interactive plot of the uncertainty. We use the CFC as color and the uncertainty will be shown on the vertical axis.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MJywC7Rymp"}],"key":"Q0Y9oyuR4k"}],"key":"Pto3Xif7MT"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Create 2D coordinate grids\nlon2d, lat2d = np.meshgrid(lon, lat)\n\n# Check that all arrays have the same shape\nassert lon2d.shape == lat2d.shape == z_unc.shape == surface_color.shape, \"Shape mismatch\"\n\n# Create surface plot, define hover variables too show data via mouse hovering\nfig = go.Figure(\n    data=[go.Surface(\n        x=lon2d,\n        y=lat2d,\n        z=z_unc,\n        surfacecolor=surface_color,\n        colorscale=\"Blues_r\",\n        colorbar=dict(title=\"Cloud Fraction\"),\n        hovertemplate=\n            \"Longitude: %{x}<br>\" +\n            \"Latitude: %{y}<br>\" +\n            \"Uncertainty in %: %{z:.2f}<br>\"\n    )]\n)\n\nfig.update_layout(\n    title=dict(text='Cloud Fraction Uncertainty Surface'),\n    autosize=False,\n    width=700,\n    height=600,\n    margin=dict(l=65, r=50, b=65, t=90),\n    scene=dict(\n        xaxis_title=\"Longitude\",\n        yaxis_title=\"Latitude\",\n        zaxis_title=\"Uncertainty in %\",\n        yaxis=dict(range=[90, -90]),  # Reverse latitude axis \n        xaxis=dict(range=[180,-180]) # Reverse longitude axis\n    )\n)\n\nfig.show()\n","key":"sp5uJmKWyX"},{"type":"output","id":"SZWRhYhjzjfkq8BPamjAI","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"        <script type=\"text/javascript\">\n        window.PlotlyConfig = {MathJaxConfig: 'local'};\n        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\n        </script>\n        <script type=\"module\">import \"https://cdn.plot.ly/plotly-3.0.1.min\"</script>\n        ","content_type":"text/html"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"fac681c39324ffa305a473e1f83bd21b","path":"/cci-notebook-viewers/build/fac681c39324ffa305a473e1f83bd21b.html"}}}],"key":"DqFmbyebTA"}],"key":"bFQUqMnMpU"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What do we see?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SuFrdttDKP"}],"identifier":"what-do-we-see","label":"What do we see?","html_id":"what-do-we-see","implicit":true,"key":"XSbNRSvLuV"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The uncertainties in Cloud Fraction Cover (CFC) are relatively straightforward to interpret.\nThey are based on the average probability of cloud presence for each pixel, where the cloud detection algorithm classifies pixels as either “cloud” (1) or “no cloud” (0).","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Mc7hMAJWm6"}],"key":"gtMK2eI6k2"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Uncertainties arise in cases where the classification is ambiguous—for example, over bright surfaces like snow or desert, where high surface albedo makes it difficult to distinguish clouds from the background. In such situations, the cloud detection confidence is reduced, leading to higher uncertainty values. We can see this above Antarctica, for example, where the uncertainty is abruptly rising while above the ocean along the coast of Antarctica and further north, the uncertainties are very low.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TSwBBwEZ01"}],"key":"SosypmDq6c"}],"key":"lbwfGC8mH1"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Liquid Water Path (LWP)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hv3GDwApJK"}],"identifier":"liquid-water-path-lwp","label":"Liquid Water Path (LWP)","html_id":"liquid-water-path-lwp","implicit":true,"key":"Bav0v8bOb3"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Now we move on to a more complex parameter, the liquid water path (LWP).","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"AqJuhra6Bh"}],"key":"Dx5ZtisRQg"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Satellite retrievals of LWP are based on radiative measurements (like reflectance, brightness temperature) which are fed into physical models. These retrievals are subject to various uncertainties, which are separated into two main types:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"mAbdhYWEQQ"}],"key":"X3YIn68kMI"},{"type":"heading","depth":5,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"1. Propagated Uncertainty (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"CjJTjBDYxa"},{"type":"inlineCode","value":"lwp_prop_unc","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"vnSNR2nc1s"},{"type":"text","value":")","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"iiv9Rt85EI"}],"key":"nSn3nButPx"}],"identifier":"id-1-propagated-uncertainty-lwp-prop-unc","label":"1. Propagated Uncertainty (lwp_prop_unc)","html_id":"id-1-propagated-uncertainty-lwp-prop-unc","implicit":true,"key":"Yo4exwuOmw"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Definition:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"xNDPIIUQhE"}],"key":"ClYezo6OTx"}],"key":"xH8PcNa6yo"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Uncertainties that originate from input measurements and propagate through the retrieval algorithm.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"oyRv6byntn"}],"key":"F6lwcxZGYG"}],"key":"wLxXWfvkkI"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"These stem from:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"gHfIXHilXA"}],"key":"Aku1ige3W9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Instrumental noise","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"LDoT1RntYe"}],"key":"gI3DbOfvib"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Calibration errors","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"XOh6avP31r"}],"key":"hvXT6c0UBY"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Assumed atmospheric conditions","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"a3B0eYKdmF"}],"key":"sJ7ATmppAh"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Model assumptions within the retrieval algorithm","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"DXXgI7kbww"}],"key":"g5O4hw6tR3"}],"key":"tAwDyEH1hE"}],"key":"Mvv9UV1YfI"}],"key":"Gd6sJII15l"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"How it’s computed:","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"OKDHJL5qy7"}],"key":"WXoypXlopm"}],"key":"QMF0kTaVFw"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":20,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Derived by error propagation using ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ZiQwosnoZQ"},{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"analytic formulas","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"rgQUZBXt3V"}],"key":"O7G76FIIXD"},{"type":"text","value":" or ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"P7ilkQdhzQ"},{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"sensitivity analysis","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"HVUtSBQcB6"}],"key":"v2ezc3lOfr"},{"type":"text","value":".","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"iKMf5vwT7c"}],"key":"k1QhmmqSwi"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"It accounts for how small errors in input variables affect the output (LWP).","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"sFsRM4jPAM"}],"key":"EnHKNIs8uX"}],"key":"vrmFb2lNcb"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"strong","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Characteristics:","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"CyHaPxZOVs"}],"key":"mAYtluyPEC"}],"key":"A1XJfSg4mJ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":25,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Pixel-specific","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"r19hFOh6xv"}],"key":"rvO6oXo0lZ"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Varies with atmospheric conditions, viewing geometry, surface type","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"Ytenn85u6s"}],"key":"ugGuTJbOd9"}],"key":"easa6PbpLa"},{"type":"heading","depth":5,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"2. Correlated Uncertainty (","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"N0sTzpj4uP"},{"type":"inlineCode","value":"lwp_corr_unc","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"ozl79Xh4Z8"},{"type":"text","value":")","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"lPl4ExpU1y"}],"key":"JfxbJwuvv2"}],"identifier":"id-2-correlated-uncertainty-lwp-corr-unc","label":"2. Correlated Uncertainty (lwp_corr_unc)","html_id":"id-2-correlated-uncertainty-lwp-corr-unc","implicit":true,"key":"nGx03sMpn1"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"strong","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Definition","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"RTdjguaO1O"}],"key":"u0KQGGK554"}],"key":"JQgxGKfdmT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":31,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Uncertainties that are spatially or temporally correlated, not random per pixel.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"tDs3N1i62Q"}],"key":"BLABlQvpzs"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"These come from:","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"nbKuwZ2DRO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":33,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Systematic biases in retrieval algorithms","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"D93JlDBy1T"}],"key":"cfif60TuvW"},{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Assumptions in radiative transfer models","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"FCv4MAUAkD"}],"key":"ihiBB5e5TN"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Shared calibration errors across multiple observations","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"JdVVbyZi0E"}],"key":"c0nTS4shTR"}],"key":"abOUCq1cNy"}],"key":"gY3lnPI3YS"}],"key":"RoMP6hupXx"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"strong","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Characteristics:","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"flND75DKVt"}],"key":"wE58MvfUXO"}],"key":"umNFfFe1qV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":39,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Not independent from pixel to pixel","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"dl0DdZxdBy"}],"key":"x9I1UrKNli"},{"type":"listItem","spread":true,"position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Important for regional or temporal averaging","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"NRq657kKPb"}],"key":"tLuQhGwD9y"},{"type":"listItem","spread":true,"position":{"start":{"line":41,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Not properly accounting for this can lead to overconfident estimates","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"Q4TgL1h8nA"}],"key":"Y3ogy1pvjI"}],"key":"WRo7Bw35zC"},{"type":"heading","depth":5,"position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"3. Total Uncertainty (","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"xhOQxYvcjO"},{"type":"inlineCode","value":"lwp_unc","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"Dq22QmNyc6"},{"type":"text","value":")","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"hKTGThD7FH"}],"key":"pTWdTk4ZUy"}],"identifier":"id-3-total-uncertainty-lwp-unc","label":"3. Total Uncertainty (lwp_unc)","html_id":"id-3-total-uncertainty-lwp-unc","implicit":true,"key":"WSVszpLo0G"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"ESA CCI computes total uncertainty as a quadrature sum of both components:","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"tqvmm1XfKI"}],"key":"VttG9wzrgY"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"inlineMath","value":"\\text{lwp\\_unc} = \\sqrt{(\\text{lwp\\_prop\\_unc})^2 + (\\text{lwp\\_corr\\_unc})^2}","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>lwp_unc</mtext><mo>=</mo><msqrt><mrow><mo stretchy=\"false\">(</mo><mtext>lwp_prop_unc</mtext><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy=\"false\">(</mo><mtext>lwp_corr_unc</mtext><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">\\text{lwp\\_unc} = \\sqrt{(\\text{lwp\\_prop\\_unc})^2 + (\\text{lwp\\_corr\\_unc})^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0044em;vertical-align:-0.31em;\"></span><span class=\"mord text\"><span class=\"mord\">lwp_unc</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.24em;vertical-align:-0.335em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.905em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">lwp_prop_unc</span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord text\"><span class=\"mord\">lwp_corr_unc</span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-2.865em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.335em;\"><span></span></span></span></span></span></span></span></span>","key":"CwegKVOzup"}],"key":"tuxlMtmIBq"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"This assumes the propagated and correlated components are independent.","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"tfBd5wYWsw"}],"key":"fhDFK8z7hI"},{"type":"heading","depth":5,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"strong","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Why is the combination of uncertainties relevant?","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"iRDGhMD9Xs"}],"key":"ngaNO64MJc"}],"identifier":"why-is-the-combination-of-uncertainties-relevant","label":"Why is the combination of uncertainties relevant?","html_id":"why-is-the-combination-of-uncertainties-relevant","implicit":true,"key":"F7RtUdZfyC"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"If you’re analyzing individual pixels, the propagated uncertainty dominates. If you’re computing regional means or trends, you must consider correlated uncertainty — otherwise, your confidence intervals will be too optimistic.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"HJm5SmgX67"}],"key":"ERxCM2L9k1"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"In this publication, you can read a more detailed description: ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"JuO1PiXQlv"},{"type":"cite","url":"https://doi.org/10.5194/essd-9-881-2017","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Stengel et al., Cloud property datasets retrieved from AVHRR, MODIS, AATSR and MERIS in the framework of the Cloud_cci project (2017)","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"H3NRVdkmjO"}],"kind":"narrative","label":"Stengel_2017","identifier":"https://doi.org/10.5194/essd-9-881-2017","enumerator":"1","key":"rf7WmeKKJh"},{"type":"text","value":".","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"DZ2XXZnPUp"}],"key":"udy0yp980T"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"In this ESA Cloud CCI Product User Guide, you can find all parameters and uncertainties listed: ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"t2RIemn9kk"},{"type":"link","url":"https://climate.esa.int/media/documents/Cloud_Product-User-Guide-PUG_v5.1.pdf","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"ESA Cloud_cci Product User Guide (PUG)","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"TaAYBM39cz"}],"urlSource":"https://climate.esa.int/media/documents/Cloud_Product-User-Guide-PUG_v5.1.pdf","key":"TrjAe4RmB9"},{"type":"text","value":".","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"u04bxlF8kd"}],"key":"J1ap7vaV1U"}],"key":"tzStk8ONvD"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plotting the Correlated Uncertainty","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z6huQamkF6"}],"identifier":"plotting-the-correlated-uncertainty","label":"Plotting the Correlated Uncertainty","html_id":"plotting-the-correlated-uncertainty","implicit":true,"key":"DfBfqU7WgC"}],"key":"YkqWaaa0HR"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Extract and squeeze variables\nlwp = cloud_ds['lwp'].squeeze()\nlwp_corr_unc = cloud_ds['lwp_corr_unc'].squeeze()\n\n# Get 1D coordinate arrays\nlon = lwp['lon'].values\nlat = lwp['lat'].values\n\n# Create 2D coordinate grids\nlon2d, lat2d = np.meshgrid(lon, lat)\n\n# Get 2D data arrays\nz_unc = lwp_corr_unc.values\nsurface_color = lwp.values\n\n# Check that all arrays have the same shape\nassert lon2d.shape == lat2d.shape == z_unc.shape == surface_color.shape, \"Shape mismatch\"\n\n# Create surface plot\nfig = go.Figure(\n    data=[go.Surface(\n        x=lon2d,\n        y=lat2d,\n        z=z_unc,\n        surfacecolor=surface_color,\n        colorscale=\"viridis\",\n        colorbar=dict(title=\"Liquid Water Path (g/m2)\"),\n        cmin = 0,\n        cmax = 500,\n        hovertemplate=\n            \"Longitude: %{x}<br>\" +\n            \"Latitude: %{y}<br>\" +\n            \"Correlated Uncertainty (g/m2): %{z:.2f}<br>\"\n    )]\n)\n\nfig.update_layout(\n    title=dict(text='Liquid Water Path Correlated Uncertainty'),\n    autosize=False,\n    width=700,\n    height=600,\n    margin=dict(l=65, r=50, b=65, t=90),\n    scene=dict(\n        xaxis_title=\"Longitude\",\n        yaxis_title=\"Latitude\",\n        zaxis_title=\"Correlated Uncertainty (g/m2)\",\n        yaxis=dict(range=[90, -90]),  # Reverse latitude axis \n        xaxis=dict(range=[180,-180]) # Reverse longitude axis\n    )\n)\n\n# uncomment the next line \"fig.show()\" AND comment the \"pass\" command to show the figure:\n#fig.show()\npass","key":"W58EtQK5UE"},{"type":"output","id":"SnGvWX4wMs2MldGmq-n0b","data":[],"key":"MubQ600IVT"}],"key":"AXauPGc3Cl"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Extract and squeeze variables\nlwp = cloud_ds['lwp'].squeeze()\nlwp_prop_unc = cloud_ds['lwp_prop_unc'].squeeze()\n\n# Get 1D coordinate arrays\nlon = lwp['lon'].values\nlat = lwp['lat'].values\n\n# Create 2D coordinate grids\nlon2d, lat2d = np.meshgrid(lon, lat)\n\n# Get 2D data arrays\nz_unc = lwp_prop_unc.values\nsurface_color = lwp.values\n\n# Check that all arrays have the same shape\nassert lon2d.shape == lat2d.shape == z_unc.shape == surface_color.shape, \"Shape mismatch\"\n\n# Create surface plot\nfig = go.Figure(\n    data=[go.Surface(\n        x=lon2d,\n        y=lat2d,\n        z=z_unc,\n        surfacecolor=surface_color,\n        colorscale=\"viridis\",\n        colorbar=dict(title=\"Liquid Water Path (g/m2)\"),\n        cmin = 0,\n        cmax = 500,\n        hovertemplate=\n            \"Longitude: %{x}<br>\" +\n            \"Latitude: %{y}<br>\" +\n            \"Propagated Uncertainty (g/m2): %{z:.2f}<br>\"\n    )]\n)\n\nfig.update_layout(\n    title=dict(text='Liquid Water Path Propagated Uncertainty'),\n    autosize=False,\n    width=700,\n    height=600,\n    margin=dict(l=65, r=50, b=65, t=90),\n    scene=dict(\n        xaxis_title=\"Longitude\",\n        yaxis_title=\"Latitude\",\n        zaxis_title=\"Propagated Uncertainty (g/m2)\",\n        yaxis=dict(range=[90, -90]),  # Reverse latitude axis \n        xaxis=dict(range=[180,-180]) # Reverse longitude axis\n    )\n)\n\n# uncomment the next line \"fig.show()\" AND comment the \"pass\" command to show the figure:\n#fig.show()\npass","key":"c7wE9bGl4J"},{"type":"output","id":"fYVa1uuj_wFHBbCtBqbY7","data":[],"key":"l7UzhnEtFP"}],"key":"mSxg7YgKKq"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plotting the total uncertainty of LWP","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tX4uZghht4"}],"identifier":"plotting-the-total-uncertainty-of-lwp","label":"Plotting the total uncertainty of LWP","html_id":"plotting-the-total-uncertainty-of-lwp","implicit":true,"key":"UH2SXWkbxM"}],"key":"FqJv03SnTB"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Extract and squeeze variables\nlwp = cloud_ds['lwp'].squeeze()\nlwp_unc = cloud_ds['lwp_unc'].squeeze()\n\n# Get 1D coordinate arrays\nlon = lwp['lon'].values\nlat = lwp['lat'].values\n\n# Create 2D coordinate grids\nlon2d, lat2d = np.meshgrid(lon, lat)\n\n# Get 2D data arrays\nz_unc = lwp_unc.values\nsurface_color = lwp.values\n\n# Check that all arrays have the same shape\nassert lon2d.shape == lat2d.shape == z_unc.shape == surface_color.shape, \"Shape mismatch\"\n\n# Create surface plot\nfig = go.Figure(\n    data=[go.Surface(\n        x=lon2d,\n        y=lat2d,\n        z=z_unc,\n        surfacecolor=surface_color,\n        colorscale=\"viridis\",\n        colorbar=dict(title=\"Liquid Water Path (g/m2)\"),\n        cmin = 0,\n        cmax = 500,\n        hovertemplate=\n            \"Longitude: %{x}<br>\" +\n            \"Latitude: %{y}<br>\" +\n            \"Uncertainty (g/m2): %{z:.2f}<br>\"\n    )]\n)\n\nfig.update_layout(\n    title=dict(text='Liquid Water Path Total Uncertainty'),\n    autosize=False,\n    width=700,\n    height=600,\n    margin=dict(l=65, r=50, b=65, t=90),\n    scene=dict(\n        xaxis_title=\"Longitude\",\n        yaxis_title=\"Latitude\",\n        zaxis_title=\"Uncertainty (g/m2)\",\n        yaxis=dict(range=[90, -90]),  # Reverse latitude axis \n        xaxis=dict(range=[180,-180]) # Reverse longitude axis\n    )\n)\n\n# uncomment the next line \"fig.show()\" AND comment the \"pass\" command to show the figure:\n#fig.show()\npass","key":"q7pWNcSy12"},{"type":"output","id":"vq8awk8ovDWXAlXYu4i_m","data":[],"key":"JQYa3U0dZe"}],"key":"oZLmaoJuhb"},{"type":"block","kind":"notebook-content","data":{},"children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What do we see?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M0Ep4JrxuG"}],"identifier":"what-do-we-see","label":"What do we see?","html_id":"what-do-we-see-1","implicit":true,"key":"mH12BxL7wS"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The uncertainty increases toward the northern polar region. Since this data is from December, the Sun’s zenith angle is low in these latitudes, resulting in limited visible light and higher retrieval uncertainty. Therefore, the high LWP values observed in the northern hemisphere should be interpreted with caution, as they are associated with high uncertainty.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"TLBKyIHaex"}],"key":"bpvYBEJ4TA"}],"key":"U8a5h9tiOq"}],"key":"zYdiIXbAAE"},"references":{"cite":{"order":["Stengel_2017"],"data":{"Stengel_2017":{"label":"Stengel_2017","enumerator":"1","doi":"10.5194/essd-9-881-2017","html":"Stengel, M., Stapelberg, S., Sus, O., Schlundt, C., Poulsen, C., Thomas, G., Christensen, M., Carbajal Henken, C., Preusker, R., Fischer, J., Devasthale, A., Willén, U., Karlsson, K.-G., McGarragh, G. R., Proud, S., Povey, A. C., Grainger, R. G., Meirink, J. F., Feofilov, A., … Hollmann, R. (2017). Cloud property datasets retrieved from AVHRR, MODIS, AATSR and MERIS in the framework of the Cloud_cci project. <i>Earth System Science Data</i>, <i>9</i>(2), 881–904. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5194/essd-9-881-2017\">10.5194/essd-9-881-2017</a>","url":"https://doi.org/10.5194/essd-9-881-2017"}}}},"footer":{"navigation":{"prev":{"title":"ect-training","url":"/external-notebooks/esa-cci/ect-training/readme","group":"Ect Training"},"next":{"title":"Questions We Aim to Explore","url":"/external-notebooks/esa-cci/ect-training/lps-vienna-06-2025/lps-intermediate-level-elnino","group":"Lps Vienna 06 2025"}}},"domain":"http://localhost:3000"}