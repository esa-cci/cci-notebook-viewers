{"version":2,"kind":"Notebook","sha256":"d0df054f6353084cf41b76dd4d33fe35f21f27b5022aa3642e29a888b057735d","slug":"external-notebooks.esa-cci.ect-training.esa-climate-change-competition.competition-forests-in-a-changing-climate","location":"/external_notebooks/esa-cci/ect-training/ESA_Climate_Change_Competition/Competition_Forests_in_a_Changing_Climate.ipynb","dependencies":[],"frontmatter":{"title":"ESA Climate Change Competition: Forests in a Changing Climate","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"github":"https://github.com/esa-cci/cci-notebook-viewers","subject":"CCI Examples","numbering":{"title":{"offset":4}},"edit_url":"https://github.com/esa-cci/cci-notebook-viewers/blob/main/external_notebooks/esa-cci/ect-training/ESA_Climate_Change_Competition/Competition_Forests_in_a_Changing_Climate.ipynb","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","exports":[{"format":"ipynb","filename":"Competition_Forests_in_a_Changing_Climate.ipynb","url":"/cci-notebook-viewers/build/Competition_Forests_-b74b76314c026cb972440199d768db03.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","alt":"CCI_Logo_large.PNG","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wGYsyNJtAD","urlSource":"data:image/png;base64,iVBORw0KGg...lFTkSuQmCC"}],"key":"TY7QcNUaHK"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e9ecef","padding":"10px","borderLeft":"5px solid #e9ecef"},"children":[{"type":"heading","depth":3,"children":[{"type":"text","value":"Welcome to the ESA Climate Change Communication Competition","key":"FxMMbY2HDb"}],"identifier":"welcome-to-the-esa-climate-change-communication-competition","label":"Welcome to the ESA Climate Change Communication Competition","html_id":"welcome-to-the-esa-climate-change-communication-competition","implicit":true,"key":"o197ojkk0G"},{"type":"heading","depth":3,"children":[{"type":"text","value":"Explore forests in a changing climate with the ESA CCI datasets","key":"S4RTdh6yQO"}],"identifier":"explore-forests-in-a-changing-climate-with-the-esa-cci-datasets","label":"Explore forests in a changing climate with the ESA CCI datasets","html_id":"explore-forests-in-a-changing-climate-with-the-esa-cci-datasets","implicit":true,"key":"FsaTjPgbyU"},{"type":"heading","depth":4,"children":[{"type":"text","value":"What You‚Äôll Learn in this Notebook","key":"Fyo6e84pxK"}],"identifier":"what-youll-learn-in-this-notebook","label":"What You‚Äôll Learn in this Notebook","html_id":"what-youll-learn-in-this-notebook","implicit":true,"key":"tmYpzSYnPD"},{"type":"paragraph","children":[{"type":"text","value":"By working through this notebook, you will:","key":"pnC92sHLiB"}],"key":"FV1Nbc6JEF"},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Access and explore CCI datasets using the ESA Climate Toolbox","key":"yAERJtVvrz"}],"key":"te6M9ljiuF"}],"key":"FxFPrlvUn4"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Create regional and temporal subsets of climate variables","key":"JkHv6fYij4"}],"key":"OCIrCT4ZJo"}],"key":"lU571XZ1Up"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Visualize different essential climate variables (ECV)","key":"k7zyBu6JA6"}],"key":"lUpbfiANsG"}],"key":"b1vqkcdyTP"}],"key":"J6yWq1CF9i"}],"key":"veZjNlsj4l"}],"key":"e826iQFqHp"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[{"type":"heading","depth":3,"children":[{"type":"text","value":"Setup & Connect to ESA CCI","key":"kazxEMNxtP"}],"identifier":"setup-connect-to-esa-cci","label":"Setup & Connect to ESA CCI","html_id":"setup-connect-to-esa-cci","implicit":true,"key":"jHf18eaLzn"},{"type":"paragraph","children":[{"type":"text","value":"In this section, we import the required Python packages to work with ESA Climate Change Initiative (CCI) data. Most notably, we use the ","key":"S66aDSRl61"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/","children":[{"type":"text","value":"ESA Climate Toolbox","key":"qPd4KOsacm"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/","key":"EEeGuSAmRb"},{"type":"text","value":" which simplifies access, manipulation, and visualization of CCI datasets in Python.","key":"sR0UgFKDpP"}],"key":"qA7lu9WATN"},{"type":"paragraph","children":[{"type":"text","value":"These packages allow us to:","key":"hNr98dihAm"}],"key":"q8R03WS9eA"},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Access satellite-based climate data records from ESA.","key":"WUVYdtxJ1z"}],"key":"Fl7JVHXVwC"}],"key":"jJ4PUA14cV"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Handle geospatial and temporal dimensions efficiently.","key":"p3syEbviEB"}],"key":"PdpKKYyGzs"}],"key":"dD13xck6kp"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Visualize data with intuitive plotting tools.","key":"B9xEDBNGrG"}],"key":"aC8N2npEIH"}],"key":"JZEKMxeLmb"}],"key":"M56pJv1gyB"},{"type":"paragraph","children":[{"type":"text","value":"üìö For a broader introduction to the toolbox and how to install it, visit:","key":"qlKYcnGxZA"},{"type":"break","key":"dhdwBrbMGl"},{"type":"text","value":" üîó ","key":"W8FkYcxwHc"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#jupyter-notebooks","children":[{"type":"text","value":"ESA CCI Climate Toolbox Quick Start","key":"puWnT22GTQ"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#jupyter-notebooks","key":"z7Bs7u8bjj"},{"type":"break","key":"CueZT4kbf8"},{"type":"text","value":" üîó ","key":"iAbdnp92zh"},{"type":"link","url":"https://climate.esa.int/en/data/toolbox/","children":[{"type":"text","value":"ESA Climate Data Toolbox Website","key":"kZGLuXXUZ1"}],"urlSource":"https://climate.esa.int/en/data/toolbox/","key":"nsgHSxOaOL"}],"key":"T6JVhKPRGF"}],"key":"nlMc59eqjG"}],"key":"fyrrsiHm2M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# ESA Climate Toolbox imports for accessing and plotting ESA CCI data\nfrom esa_climate_toolbox.core import get_op              # Get predefined operations (e.g., time series, averages)\nfrom esa_climate_toolbox.core import list_ecv_datasets   # List available datasets per ECV (Essential Climate Variable)\nfrom esa_climate_toolbox.core import get_store           # Connect to an ESA data store\nfrom esa_climate_toolbox.core import list_datasets       # List all datasets in a store\nfrom esa_climate_toolbox.ops import plot                 # High-level plotting functions for CCI data\n\n# Used for connecting to remote data sources (e.g., ESA CCI ODP)\nfrom xcube.core.store import new_data_store\n\n# For displaying geographic regions interactively (if desired)\nfrom IPython.display import GeoJSON\nimport shapely.geometry   # Handling geometric objects like bounding boxes\n\n# Core data science libraries\nimport pandas as pd       # For tabular data handling and time manipulation\nimport numpy as np        # For numerical operations\nimport xarray as xr       # For multi-dimensional climate data structures\n\n# Mapping and plotting\nimport matplotlib.pyplot as plt       # Plotting library\nimport cartopy.crs as ccrs            # Cartographic projections for spatial data\n\n# Individual colormap creation\nfrom matplotlib.colors import ListedColormap\n\n# Notebook settings\nimport warnings\nwarnings.filterwarnings(\"ignore\") # Suppressing warnings to keep notebook output clean\n%matplotlib inline","key":"TbeZquOr5p"},{"type":"output","id":"fhUcbgFD37X55ggtgRySn","data":[],"key":"X6ZDU1kjuI"}],"key":"KLadFgjjeq"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[{"type":"heading","depth":3,"children":[{"type":"text","value":"Zooming In - Defining a Region of Interest","key":"MccuYB0Yas"}],"identifier":"zooming-in-defining-a-region-of-interest","label":"Zooming In - Defining a Region of Interest","html_id":"zooming-in-defining-a-region-of-interest","implicit":true,"key":"njzQNDiS2o"},{"type":"paragraph","children":[{"type":"text","value":"The challenge is focussing on tropic biomass. Thus, we can define a ","key":"ZfeNJI3m7b"},{"type":"strong","children":[{"type":"text","value":"region of interest","key":"IZYjxlTNhm"}],"key":"Ik299E1g05"},{"type":"text","value":" that captures parts of the tropical forest, e.g. in the Amazon.","key":"vXjr3VneFr"}],"key":"BMIiTvyeGm"},{"type":"paragraph","children":[{"type":"text","value":"We can define smaller regions, e.g. north of Bolivia which has experienced some decline in Biomass over the years due to droughts and fires. Another example area is defined around Altamira in Brazil, which experienced a lot deforestation due to agriculture.","key":"cs6lKIiPSk"}],"key":"cs0E3Rimwm"}],"key":"cBqlaSO9hT"}],"key":"M5FVoxCYbX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set bounding box by defining the longitude minimum, latitude minimum, longitude maximum and latitude maximum\n# Example bboxes: \nbbox = (-51.0, -2.8, -50.0, -2) # Altamira region\n\n# bbox = (-63, -15.5, -52, -9) # Larger bounding box -> longer computation time\n \n# Display bounding box for reference\nGeoJSON(shapely.geometry.box(*bbox).__geo_interface__)","key":"oKYgTuJ61o"},{"type":"output","id":"4fEd42sDfWzEZxOD-eLFV","data":[{"output_type":"display_data","metadata":{"application/geo+json":{"expanded":false,"root":"root"}},"data":{"application/geo+json":{"content":"{\"coordinates\":[[[-50,-2.8],[-50,-2],[-51,-2],[-51,-2.8],[-50,-2.8]]],\"type\":\"Polygon\"}","content_type":"application/geo+json"},"text/plain":{"content":"<IPython.display.GeoJSON object>","content_type":"text/plain"}}}],"key":"TivnsJwf1b"}],"key":"fp2hI03xlo"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[{"type":"heading","depth":3,"children":[{"type":"text","value":"Using the ESA Climate Toolbox","key":"lkm6Okwofi"}],"identifier":"using-the-esa-climate-toolbox","label":"Using the ESA Climate Toolbox","html_id":"using-the-esa-climate-toolbox","implicit":true,"key":"CoguWI6Sxl"},{"type":"paragraph","children":[{"type":"text","value":"The ESA Climate Toolbox provides direct access to the ","key":"vYxGUZHZD7"},{"type":"strong","children":[{"type":"text","value":"ESA Climate Data Store","key":"R6B4pKty3M"}],"key":"FaRUfVjn2l"},{"type":"text","value":", which hosts harmonized satellite-based climate data records produced under the ","key":"zhmPY7qNvP"},{"type":"strong","children":[{"type":"text","value":"ESA Climate Change Initiative (CCI)","key":"z9JC5XwHZP"}],"key":"UYaNGA8nBP"},{"type":"text","value":".","key":"ryrEiftsn5"}],"key":"iOK2Qz1IJG"},{"type":"paragraph","children":[{"type":"text","value":"In this step, we establish a connection to the data store so we can browse and open datasets. This connection allows us to access data ","key":"w8WP0WkPjT"},{"type":"strong","children":[{"type":"text","value":"without having to download files manually","key":"OE6BBElUjl"}],"key":"Hs57Ww90PV"},{"type":"text","value":" ‚Äî a convenient way to explore and analyze large geospatial datasets in cloud-friendly formats such as ","key":"EYaAI8Vari"},{"type":"strong","children":[{"type":"text","value":"Zarr","key":"SLJmTPtDFQ"}],"key":"EFOtGq251c"},{"type":"text","value":" or ","key":"YAcYETKapR"},{"type":"strong","children":[{"type":"text","value":"Kerchunk","key":"Cag3YeniAV"}],"key":"PnBoMUOIVJ"},{"type":"text","value":".","key":"zlnaFRDzVK"}],"key":"Ai0wAdCtXO"},{"type":"paragraph","children":[{"type":"text","value":"The data store includes a wide range of essential climate variables (ECVs), such as biomass, land surface temperature, burned areas, and soil moisture.","key":"rsZyiYCCJe"}],"key":"gS5l57IdsZ"},{"type":"paragraph","children":[{"type":"text","value":"üìò Learn more about available datasets:","key":"danzYFPCb4"},{"type":"break","key":"gsOlsexeyR"},{"type":"text","value":" üîó ","key":"MutQYJrVB9"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#data-access","children":[{"type":"text","value":"ESA Climate Data Toolbox ‚Äì Quick Start Guide","key":"rpDsPRfEKh"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#data-access","key":"Uv4qfKtz6z"}],"key":"hRnI0OgIWS"},{"type":"paragraph","children":[{"type":"text","value":"First, we explore how to access the biomass data from the ESA Climate Change Initiative (CCI) data store. This includes identifying datasets of interest, understanding their metadata, and preparing for subsequent analysis.","key":"u5IxR2ZiET"}],"key":"eg5g2ZGEwU"}],"key":"OLPkBKk85s"}],"key":"ODMktAmfa0"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[{"type":"heading","depth":3,"children":[{"type":"text","value":"Explore the Biomass Dataset","key":"vdhBTx8Rml"}],"identifier":"explore-the-biomass-dataset","label":"Explore the Biomass Dataset","html_id":"explore-the-biomass-dataset","implicit":true,"key":"HCxLDstKyE"},{"type":"paragraph","children":[{"type":"text","value":"Identify the biomass datasets which are available for access. The ","key":"TYWpx7schi"},{"type":"inlineCode","value":"list_ecv_datasets","key":"kIQHtiYWoy"},{"type":"text","value":" command returns the names of datasets for a given ECV.","key":"xSpFc8Aykl"}],"key":"Wtcw23SElj"}],"key":"n5bBitisiK"}],"key":"Q0k0x7xiJF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# list_ecv_datasets(\"biomass\")","key":"VHFGT9ZKY3"},{"type":"output","id":"uZh7j6p5lBz37h3ICvrdV","data":[],"key":"sTX6clhyOH"}],"key":"ECcwRpOgZy"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[{"type":"heading","depth":4,"children":[{"type":"text","value":"Background: zarr & kerchunk & NetCDF format","key":"zPDnDQDp7E"}],"identifier":"background-zarr-kerchunk-netcdf-format","label":"Background: zarr & kerchunk & NetCDF format","html_id":"background-zarr-kerchunk-netcdf-format","implicit":true,"key":"LynvMeGe0j"},{"type":"paragraph","children":[{"type":"text","value":"For some data it might be a good idea to use the zarr or kerchunk format, as data loading will be much faster. Several CCI data records are available in these formats as they have some advantages. Zarr is ideal for new datasets that will be frequently accessed, updated, or analyzed and it is suitable for large-scale distributed processing in cloud-native workflows. Kerchunk is best for efficiently accessing legacy data formats (e.g., NetCDF, GRIB) stored in object stores without converting them and useful when data duplication must be avoided. NetCDF, while widely used and highly compatible with scientific tools, is less optimized for cloud-native workflows and accessing large datasets efficiently, making it better suited for smaller-scale, traditional file-based analysis.","key":"tl2R9TBn94"}],"key":"kXHPd5ejC3"},{"type":"table","children":[{"type":"tableRow","children":[{"type":"tableCell","header":true,"children":[{"type":"strong","children":[{"type":"text","value":"Feature","key":"GpTpCsgrXg"}],"key":"QcMjOfDJX8"}],"key":"MeEpjYophK"},{"type":"tableCell","header":true,"children":[{"type":"strong","children":[{"type":"text","value":"Zarr","key":"Gj9unwWIXU"}],"key":"RZ103THi52"}],"key":"hLHhpxZa8D"},{"type":"tableCell","header":true,"children":[{"type":"strong","children":[{"type":"text","value":"Kerchunk","key":"Cbu6nStEuT"}],"key":"vG6yU9pexB"}],"key":"PZWpiilVRj"},{"type":"tableCell","header":true,"children":[{"type":"strong","children":[{"type":"text","value":"NetCDF","key":"L01wdinpQL"}],"key":"bUKLquASOe"}],"key":"NmVCyWCDUg"}],"key":"u3cHegLy23"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"strong","children":[{"type":"text","value":"Storage Format","key":"MgV2v8514U"}],"key":"nQQWJfiq33"}],"key":"jPLLTBdnqp"},{"type":"tableCell","children":[{"type":"text","value":"Self-contained, new format","key":"twQgtiDsX0"}],"key":"FXJcOpEzAh"},{"type":"tableCell","children":[{"type":"text","value":"Wrapper for existing formats","key":"qX6dUdtwd8"}],"key":"IvROfRO7Gw"},{"type":"tableCell","children":[{"type":"text","value":"Traditional file-based format","key":"h5TcAfhk73"}],"key":"gKnhZpdvZe"}],"key":"wtadh4IaIF"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"strong","children":[{"type":"text","value":"Cloud-Native","key":"rAxWWAQN20"}],"key":"HIIeskKKX1"}],"key":"p2vWxtuq6b"},{"type":"tableCell","children":[{"type":"text","value":"Yes","key":"EjqbVNPOJN"}],"key":"KTsD0aS80Q"},{"type":"tableCell","children":[{"type":"text","value":"Yes","key":"g8tPh0BGBB"}],"key":"DQVLkNujQ6"},{"type":"tableCell","children":[{"type":"text","value":"No","key":"CRueTNAr8H"}],"key":"HTe1gW4xAd"}],"key":"phkfqPsvPw"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"strong","children":[{"type":"text","value":"Efficiency","key":"NxTj1dVDUP"}],"key":"q7BeYnRz4X"}],"key":"b58VYOLnRi"},{"type":"tableCell","children":[{"type":"text","value":"Good for accessing subsets","key":"DbBZQt8YJG"}],"key":"M7Vm2XMY8b"},{"type":"tableCell","children":[{"type":"text","value":"Great for legacy data in object stores","key":"RyRrrIIWUF"}],"key":"djzo4CGOON"},{"type":"tableCell","children":[{"type":"text","value":"Efficient for small to medium files","key":"mrr2L2Z0cl"}],"key":"UxXaCnoA5G"}],"key":"i4oar3tagz"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"strong","children":[{"type":"text","value":"Compression","key":"KqfCVC0jMH"}],"key":"mDqRNln0DD"}],"key":"a1q8bdY5xB"},{"type":"tableCell","children":[{"type":"text","value":"Supports multiple algorithms","key":"w6YnBLD9S0"}],"key":"OLkTcnSROp"},{"type":"tableCell","children":[{"type":"text","value":"Depends on underlying format","key":"mRPcU9c4cs"}],"key":"xjnTLui3so"},{"type":"tableCell","children":[{"type":"text","value":"Limited to format-specific methods","key":"oLcX3pcozj"}],"key":"LlckPGqDkH"}],"key":"epVgS2zIuP"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"strong","children":[{"type":"text","value":"Metadata Handling","key":"rOlMNyNuGI"}],"key":"iZXMvshROa"}],"key":"lnHjlgoMUk"},{"type":"tableCell","children":[{"type":"text","value":"Embedded metadata","key":"YlmkMwEHFt"}],"key":"uH6uICfKK7"},{"type":"tableCell","children":[{"type":"text","value":"External JSON index","key":"tmTQt08BMC"}],"key":"UAIYRVwpkU"},{"type":"tableCell","children":[{"type":"text","value":"Embedded in file","key":"fdNXdICwqn"}],"key":"hL23q1B4iZ"}],"key":"TJ8sCnMiG0"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"strong","children":[{"type":"text","value":"Read/Write Access","key":"MYIi4DwNai"}],"key":"SeNW73hQIi"}],"key":"vKtHQgYjkd"},{"type":"tableCell","children":[{"type":"text","value":"Supports both","key":"m1nhpMMTGq"}],"key":"MNGAhsyHTz"},{"type":"tableCell","children":[{"type":"text","value":"Read-only","key":"b6kTRrEEgb"}],"key":"fCThKGzuCC"},{"type":"tableCell","children":[{"type":"text","value":"Read and write","key":"GBjBHs9yuI"}],"key":"RZKSGC4m4X"}],"key":"AoYTgEXcJw"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"strong","children":[{"type":"text","value":"Setup Overhead","key":"gjkjP1NiTe"}],"key":"kNDMzJK0Np"}],"key":"hnlqGZ3ML9"},{"type":"tableCell","children":[{"type":"text","value":"None, works out of the box","key":"E4hKPGcaT8"}],"key":"tER327bgvD"},{"type":"tableCell","children":[{"type":"text","value":"Requires pre-generated JSON indices","key":"ypYvytAzEb"}],"key":"CQFohir6O9"},{"type":"tableCell","children":[{"type":"text","value":"None, but slower for large datasets","key":"QswE7nBEB7"}],"key":"g5rgTcKCei"}],"key":"D4IQ8YNdkK"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"strong","children":[{"type":"text","value":"Storage Duplication","key":"WqrXkmjlrK"}],"key":"DVChFc4XS2"}],"key":"hTMpvUCt8V"},{"type":"tableCell","children":[{"type":"text","value":"Requires duplicating data","key":"j8KlLMGE4e"}],"key":"vih5zEt6Dk"},{"type":"tableCell","children":[{"type":"text","value":"Minimal, uses existing files","key":"fkLhsDssvd"}],"key":"QvaivDs2w2"},{"type":"tableCell","children":[{"type":"text","value":"Minimal, as data is stored in single files","key":"ZUcJxsDMc4"}],"key":"wZ8iRDjIJs"}],"key":"eVKTnEBmft"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"strong","children":[{"type":"text","value":"Performance","key":"Mk1xUIFaN4"}],"key":"NhbjTmWDLY"}],"key":"UhseG7XYty"},{"type":"tableCell","children":[{"type":"text","value":"Optimized for chunk-based access","key":"NQeZJbEHPR"}],"key":"P8Xu1Dcqw4"},{"type":"tableCell","children":[{"type":"text","value":"Slight overhead for index lookup","key":"MRExIG2H6X"}],"key":"Ww1hbMxLia"},{"type":"tableCell","children":[{"type":"text","value":"Can be slow for very large files","key":"hMx1K9lpLV"}],"key":"OvoHQNeXUz"}],"key":"nRHJZNEDuJ"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"strong","children":[{"type":"text","value":"Selective loading","key":"bxjFO3fKWQ"}],"key":"DDXlK5LAlS"}],"key":"eOhgGuU9hD"},{"type":"tableCell","children":[{"type":"text","value":"Not supported, entire dataset must be loaded","key":"TIcJ5B1Iwp"}],"key":"u5N65BoSFy"},{"type":"tableCell","children":[{"type":"text","value":"Not supported, entire dataset must be loaded","key":"bPPvX85HZg"}],"key":"x2bfp1Xpfy"},{"type":"tableCell","children":[{"type":"text","value":"Allows selecting variables and time ranges before loading","key":"vqizcSWzzP"}],"key":"KvscJBKVpK"}],"key":"T9pN8Z0vTi"}],"key":"F8Q1WEM9oq"}],"key":"zfmsY5xArI"}],"key":"D63fWhn4M6"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[],"key":"U9LZYxT61v"},{"type":"heading","depth":3,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Load & Visualise the Biomass Data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"J3TrA1pjrL"}],"identifier":"load-visualise-the-biomass-data","label":"Load & Visualise the Biomass Data","html_id":"load-visualise-the-biomass-data","implicit":true,"key":"y8OppDi96K"},{"type":"heading","depth":4,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Define the Dataset ID","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"RhA5cHjxdU"}],"identifier":"define-the-dataset-id","label":"Define the Dataset ID","html_id":"define-the-dataset-id","implicit":true,"key":"OrwDaCz9Q8"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"To work with a specific ESA CCI dataset, we need to specify its ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"MjPbNinRDk"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"dataset ID","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gRyjgSAE5o"}],"key":"Uav0svCZsH"},{"type":"text","value":". This unique identifier tells the toolbox which variable and product we want to access.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Se1PZlSDBP"}],"key":"F87IifuLVK"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"In this section, we are using a the biomass zarr file. The latest biomass zarr file is only available unti 2020, however, the file will soon be updated.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"EXskp9BUta"}],"key":"RPhFlPVjiJ"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"You can find the variables of the products under ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"UcCIB2QyGl"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"data_vars","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"QlWDsxFTmD"}],"key":"mWndb0Sv20"},{"type":"text","value":". For the biomass, we will use the variable ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"vU3fbdyMCP"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"agb","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"wXQhcoxAoH"}],"key":"AKb5OvdH8l"},{"type":"text","value":" which is the abbreviation for ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hzaEwFipZ5"},{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"above-ground biomass","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"sjiZwN7Y5B"}],"key":"Wks9FsZCec"}],"key":"ECRDOgoqWi"},{"type":"text","value":".","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"off4SB4Mk7"}],"key":"vFDHSP9rO8"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"First, we define the dataset ID and the store from which we retrieve the data (for the biomass zarr file it is ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"b5CFWj6M7e"},{"type":"inlineCode","value":"esa-cci-zarr","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"rnO78cxpgg"},{"type":"text","value":", if you choose to call the netcdf file, use the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"kOB50TCQqz"},{"type":"inlineCode","value":"esa-cci","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"qXHNoRAEPQ"},{"type":"text","value":"store). With the command ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"YxQCANhZ0P"},{"type":"inlineCode","value":"describe_data","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"OttSBwv2TR"},{"type":"text","value":", we can have a look at the structure of the file, such as time, dimension and the variable stored within.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"KCLrcNZJFR"}],"key":"djT6BrczRH"}],"key":"Wy6Ugjnsx3"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"# Uncomment the next line, if you want to use the cci store to call a netcdf file\n# cci_store = new_data_store(\"esa-cci\")\n\n# Defining the esa cci zarr store\ncci_zarr_store = new_data_store(\"esa-cci-zarr\")\n\n# Defining the data id (see list above from the command list_ecv_datasets\ndata_id = 'ESACCI-BIOMASS-L4-AGB-MERGED-100m-2010-2020-fv4.0.zarr'","key":"OdWoZlrVoN"},{"type":"output","id":"rZBlfSOw3HhDndCiIEJBx","data":[],"key":"ssK645kz06"}],"key":"tlcvq1ywrV"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[{"type":"heading","depth":4,"children":[{"type":"text","value":"Describe the Dataset (Check Available Variables and Metadata)","key":"zdUakGVEYB"}],"identifier":"describe-the-dataset-check-available-variables-and-metadata","label":"Describe the Dataset (Check Available Variables and Metadata)","html_id":"describe-the-dataset-check-available-variables-and-metadata","implicit":true,"key":"Ul43LBlZqu"},{"type":"paragraph","children":[{"type":"text","value":"Before loading the full dataset, it‚Äôs helpful to ","key":"XYNjswQ9VX"},{"type":"strong","children":[{"type":"text","value":"inspect the metadata","key":"IjOuciAtzq"}],"key":"p7LaNgWgsH"},{"type":"text","value":" to understand its structure. This includes:","key":"FonjBtZNMI"}],"key":"TWD571jkR0"},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Available variables (e.g., ","key":"ziJ82z5VAg"},{"type":"strong","children":[{"type":"text","value":"above ground biomass","key":"o2tppY0Qq6"}],"key":"rS3oOwIc6k"},{"type":"text","value":" (agb), uncertainty estimates)","key":"NeIF8ilEqv"}],"key":"IZp8jcV6tS"}],"key":"KALkG5IBwW"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Temporal and spatial coverage","key":"CMyMPe8ecq"}],"key":"Q27mhPyaOj"}],"key":"DiaVqBXzBb"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Data format and structure","key":"jVnO7LS4NX"}],"key":"yclrOxflXI"}],"key":"mIvW4ZWrrK"}],"key":"YoR7rAZlxV"},{"type":"paragraph","children":[{"type":"text","value":"This step ensures we know what the dataset contains and how to work with it. It also helps confirm that the variable we want to plot or analyze is actually included.","key":"DlUWclu9sM"}],"key":"DiHXMhqItL"},{"type":"paragraph","children":[{"type":"text","value":"üõ†Ô∏è Tip: You can use the description to verify variable names, dimensions (e.g., ","key":"pnCjSAEeeB"},{"type":"inlineCode","value":"lat","key":"m51EVEN9oW"},{"type":"text","value":", ","key":"G3DPpzW4Bl"},{"type":"inlineCode","value":"lon","key":"jIcMtgKdh5"},{"type":"text","value":", ","key":"gTkRnA1cUt"},{"type":"inlineCode","value":"time","key":"rzcAPzOxee"},{"type":"text","value":"), and time coverage.","key":"gOw4LxU9rD"}],"key":"lLtk5QjpBd"},{"type":"paragraph","children":[{"type":"text","value":"üìò More on dataset structure:","key":"atZm3KXawd"},{"type":"break","key":"JcIMfoZyoP"},{"type":"text","value":" üîó ","key":"UITAGs4MMN"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#accessing-data","children":[{"type":"text","value":"ESA Climate Toolbox ‚Äì Data Access","key":"FxBPdNbEFE"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#accessing-data","key":"GhKzuVH67R"}],"key":"UpSMBiYt1q"}],"key":"NJsdrVQfv5"}],"key":"aYTePh2Hfz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Uncomment the next line if you are using the netcdf file\n# cci_store.describe_data(data_id)\n\n# Checking the data structure of the chosen file\ncci_zarr_store.describe_data(data_id)","key":"VBgkNXLVUX"},{"type":"output","id":"X44HKPyXwjkSqZBUOkmmb","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"application/json":{"content":"{\"attrs\":{\"Conventions\":\"CF-1.7\",\"EPSG\":\"4326\",\"GeoTransform\":\"-180   0.00088888888888                  0                 80                  0  -0.00088888888888\",\"catalogue_url\":\"https://catalogue.ceda.ac.uk/uuid/84403d09cef3485883158f4df2989b0c\",\"cdm_data_type\":\"INT\",\"comment\":\"These data were produced at ESA CCI as part of the ESA Biomass CCI project.\",\"creator_email\":\"santoro@gamma-rs.ch\",\"creator_name\":\"GAMMA Remote Sensing\",\"creator_url\":\"www.gamma-rs.ch\",\"date_created\":\"21-Mar-2023 06:16:52\",\"false_easting\":0,\"false_northing\":0,\"format_version\":\"CCI Data Standards v2.1\",\"geospatial_lat_max\":\"80\",\"geospatial_lat_min\":\"-60\",\"geospatial_lat_resolution\":\"0.00088889\",\"geospatial_lat_units\":\"degrees_north\",\"geospatial_lon_max\":\"180\",\"geospatial_lon_min\":\"-180\",\"geospatial_lon_resolution\":\"0.00088889\",\"geospatial_lon_units\":\"degrees_east\",\"geospatial_vertical_max\":\"0.0\",\"geospatial_vertical_min\":\"0.0\",\"grid_mapping_name\":\"latitude_longitude\",\"history\":\"AGB estimation with BIOMASAR-L, v202301, AGB estimation with BIOMASAR-C, v202301, Merging of AGB estimates, v202301\",\"id\":\"ESACCI-BIOMASS-L4-AGB-MERGED-100m-2020-fv4.0.nc\",\"institution\":\"GAMMA Remote Sensing\",\"inverse_flattening\":298.257223563,\"key_variables\":\"agb\",\"keywords\":\"satellite, observation, forest, biomass\",\"keywords_vocabulary\":\"NASA Global Change Master Directory (GCMD) Science Keywords\",\"license\":\"ESA CCI Data Policy: free and open access\",\"long_name\":\"CRS definition\",\"longitude_of_prime_meridian\":0,\"naming authority\":\"ch.gamma-rs\",\"platform\":\"ALOS-2, Sentinel-1A, Sentinel-1B\",\"product_version\":\"4.0\",\"proj4\":\"+proj=longlat +datum=WGS84 +no_defs\",\"project\":\"Climate Change Initiative - European Space Agency\",\"references\":\"http://cci.esa.int/biomass\",\"semi_major_axis\":6378137,\"sensor\":\"PALSAR-2, SAR-C\",\"source\":\"ALOS-2 PALSAR-2 FB and WB mosaics, Sentinel-1 GRD\",\"spatial_ref\":\"GEOGCS[\\\"WGS 84\\\",DATUM[\\\"WGS_1984\\\",SPHEROID[\\\"WGS 84\\\",6378137,298.257223563,AUTHORITY[\\\"EPSG\\\",\\\"7030\\\"]],AUTHORITY[\\\"EPSG\\\",\\\"6326\\\"]],PRIMEM[\\\"Greenwich\\\",0],UNIT[\\\"degree\\\",0.0174532925199433],AUTHORITY[\\\"EPSG\\\",\\\"4326\\\"]]\",\"spatial_resolution\":\"100 m\",\"standard_name_vocabulary\":\"NetCDF Climate and Forecast (CF) Metadata Convention version 67\",\"summary\":\"This dataset contains a global map of above-ground biomass of the epoch 2020 obtained from L-and C-band spaceborne SAR backscatter, placed onto a regular grid.\",\"time_coverage_duration\":\"P1Y\",\"time_coverage_end\":\"20201231T000000Z\",\"time_coverage_resolution\":\"P1Y\",\"time_coverage_start\":\"20100101T000000Z\",\"title\":\"ESA CCI above-ground biomass product level 4, year 2020\",\"tracking_id\":\"cd5cb1d2-e582-41ab-a0fc-637f050baf9e\"},\"bbox\":[-180,-59.9999999986,179.9999999964,80],\"coords\":{\"lat\":{\"attrs\":{\"bounds\":\"lat_bnds\",\"long_name\":\"WGS84 latitude coordinate\",\"standard_name\":\"latitude\",\"units\":\"degrees_north\",\"valid_max\":80,\"valid_min\":-60},\"dims\":[\"lat\"],\"dtype\":\"float64\",\"name\":\"lat\"},\"lat_bnds\":{\"chunks\":[1575,2],\"dims\":[\"lat\",\"nv\"],\"dtype\":\"float64\",\"name\":\"lat_bnds\"},\"lon\":{\"attrs\":{\"bounds\":\"lon_bnds\",\"long_name\":\"WGS84 longitude coordinate\",\"standard_name\":\"longitude\",\"units\":\"degrees_east\",\"valid_max\":180,\"valid_min\":-180},\"dims\":[\"lon\"],\"dtype\":\"float64\",\"name\":\"lon\"},\"lon_bnds\":{\"chunks\":[2025,2],\"dims\":[\"lon\",\"nv\"],\"dtype\":\"float64\",\"name\":\"lon_bnds\"},\"time\":{\"dims\":[\"time\"],\"dtype\":\"datetime64[ns]\",\"name\":\"time\"},\"time_bnds\":{\"chunks\":[1,2],\"dims\":[\"time\",\"nv\"],\"dtype\":\"datetime64[ns]\",\"name\":\"time_bnds\"}},\"data_id\":\"ESACCI-BIOMASS-L4-AGB-MERGED-100m-2010-2020-fv4.0.zarr\",\"data_type\":\"dataset\",\"data_vars\":{\"agb\":{\"attrs\":{\"ancillary_variables\":\"agb_se\",\"grid_mapping\":\"crs\",\"long_name\":\"Above-ground biomass\",\"units\":\"Mg/ha\",\"valid_max\":10000,\"valid_min\":0},\"chunks\":[1,1575,2025],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float32\",\"name\":\"agb\"},\"agb_se\":{\"attrs\":{\"grid_mapping\":\"crs\",\"long_name\":\"Above-ground biomass standard_error\",\"units\":\"Mg/ha\",\"valid_max\":10000,\"valid_min\":0},\"chunks\":[1,1575,2025],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float32\",\"name\":\"agb_se\"}},\"dims\":{\"lat\":157500,\"lon\":405000,\"nv\":2,\"time\":5},\"spatial_res\":0.0008888888888805013,\"time_range\":[\"2010-01-01\",\"2020-12-31\"]}","content_type":"application/json"},"text/plain":{"content":"<xcube.core.store.descriptor.DatasetDescriptor at 0x722bbfa067b0>","content_type":"text/plain"}}}],"key":"CWwlnKzaiB"}],"key":"wukw5eBPAm"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[{"type":"heading","depth":4,"children":[{"type":"text","value":"Open the Dataset","key":"OSOVry99AT"}],"identifier":"open-the-dataset","label":"Open the Dataset","html_id":"open-the-dataset","implicit":true,"key":"w6DRiJSZ9q"},{"type":"paragraph","children":[{"type":"text","value":"Now we open the dataset using the zarr. When using the zarr format, the whole dataset is loaded. We will later use the cci-store where we can define the variables and time range we are interested in. For now, let‚Äôs load the entire dataset:","key":"ldJEljNJLE"}],"key":"N0FeYq49Ad"}],"key":"lNrTy4s83q"}],"key":"oelhYE3CHD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"biomass_ds = cci_zarr_store.open_data(\n    data_id=data_id\n)","key":"Um2aFwTrgE"},{"type":"output","id":"SHY9kuSc9MRANIyuMi8Bj","data":[],"key":"QhnXvPTlgn"}],"key":"dPklHdj0GK"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[{"type":"heading","depth":4,"children":[{"type":"text","value":"Create a Spacial Subset of the Dataset:","key":"xorEVadwJG"}],"identifier":"create-a-spacial-subset-of-the-dataset","label":"Create a Spacial Subset of the Dataset:","html_id":"create-a-spacial-subset-of-the-dataset","implicit":true,"key":"walROuMHfo"},{"type":"paragraph","children":[{"type":"text","value":"To focus our analysis on the defined region above, we extract a ","key":"MMZLIlpto6"},{"type":"strong","children":[{"type":"text","value":"spatial subset","key":"ZN9wl6A4jw"}],"key":"K0xbO24kT9"},{"type":"text","value":" from the global dataset. Using the bounding box we defined earlier, the function ","key":"AIhlWrRrVS"},{"type":"inlineCode","value":"subset_spatial","key":"TghjvXkrtQ"},{"type":"text","value":" filters the dataset to include only the relevant area. This helps reduce data volume and enables more targeted visualizations and calculations in the following steps.","key":"JZWpRBHosl"}],"key":"IfQ5ZKElm4"},{"type":"paragraph","children":[{"type":"text","value":"If you would like to retrieve a list of all available operation tools, you can execute:","key":"HW4edqQT0b"}],"key":"EGPLXmzbEK"},{"type":"paragraph","children":[{"type":"inlineCode","value":"from esa_climate_toolbox.core import list_operations","key":"YREdeLJMgG"}],"key":"j0FxaqyTgU"},{"type":"paragraph","children":[{"type":"inlineCode","value":"list_operations()","key":"OT4lkWzeK4"}],"key":"OOmbmAaLbZ"}],"key":"pmOA0xkLYB"}],"key":"G8V4jqSIuk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"subset_spatial_op = get_op('subset_spatial')\nbiomass_sub = subset_spatial_op(ds=biomass_ds, region=bbox)","key":"sHe1JhWvmr"},{"type":"output","id":"4KQpQ2yfD5g10UjZWVUDx","data":[],"key":"dPaqBgm4Vs"}],"key":"GIkJSVxGff"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[],"key":"zGcdZfZoe7"},{"type":"heading","depth":4,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Visualize the Results","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xxXndrNaCz"}],"identifier":"visualize-the-results","label":"Visualize the Results","html_id":"visualize-the-results","implicit":true,"key":"Oy4lwZw0UQ"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"We now create a simple map plot of the spatial subset and loop it across the years.\nThis allows us to explore the spatial patterns of the biomass.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NPnlmsUsIG"}],"key":"jcuTL8jIYT"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"For more interactive and advanced visualizations, check out the ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"cfMHZyopdj"},{"type":"link","url":"https://climate.esa.int/en/data/toolbox/","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"ESA Climate Toolbox","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"JwM7lElHVY"}],"urlSource":"https://climate.esa.int/en/data/toolbox/","key":"cT6W9hnAog"},{"type":"text","value":" or the ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"BDnEC0VBEt"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#jupyter-notebooks","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Toolbox documentation","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"tba9cSUPea"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#jupyter-notebooks","key":"PZQrSSksGq"},{"type":"text","value":".","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"W9a0L4VKwE"}],"key":"C2RlpcwLBl"}],"key":"FOjr7tzSp8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nscript_dir = os.getcwd()  # Gets current working directory\npng_dir = os.path.join(script_dir, 'Biomass/')\n# Create directory if it doesn't exist\nos.makedirs(png_dir, exist_ok=True)\n\n# Define years to loop through\nyears = range(2018, 2021)  # you can adapt the range here according to data availability; if you want to include 2020, you need to end the range at 2021\n\nfor year in years:\n    print(f\"Processing year {year}...\")\n    \n    # Create timestep for biomass (yearly data)\n    timestep = f'{year}-01-01'\n    \n    # Load and extract the biomass data\n    biomass = biomass_sub[\"agb\"].sel(time=timestep, method='nearest').compute()\n    time_str = biomass_sub['time'].sel(time=timestep, method='nearest').dt.strftime('%Y').item()\n    lat = biomass_sub[\"lat\"]\n    lon = biomass_sub[\"lon\"]\n    \n    fig = plt.figure(figsize=(12, 6))\n    \n    # Create two axes with the same projection\n    ax = plt.axes(projection=ccrs.PlateCarree())\n  \n    # Plot biomass, mask the data and only use positive values\n    masked_biomass = np.ma.masked_where(biomass <= 0, biomass)\n    mesh_biomass = ax.pcolormesh(\n        lon, lat, masked_biomass,\n        cmap=\"YlGn\", shading=\"auto\",\n        norm=plt.matplotlib.colors.LogNorm(vmin=1, vmax=np.nanpercentile(biomass, 99)) # avoid outliers to darken the colormap unneccessarily by using np.nanpercentile\n    )\n    # Hide grid lines \n    ax.grid(False)\n     # Add year label in upper-right corner\n    ax.text(\n        -50.9,-2.75, # define location for the text\n        str(year),\n        color='white',\n        fontsize=28,\n        fontweight='bold',\n        transform=ccrs.PlateCarree()\n    ) \n    # Save with year in filename\n    plt.savefig(os.path.join(png_dir, f'Biomass_{year}.png'), bbox_inches='tight')\n    plt.show() # show the plot below the cell\n    plt.close()  # Close figure to free memory\n    ","key":"JbBvxdtqtB"},{"type":"output","id":"A6-SDsobVG9Zn2khu4rR7","data":[{"name":"stdout","output_type":"stream","text":"Processing year 2018...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3f5a8d4bb857edbd034e5c2c3fc19534","path":"/cci-notebook-viewers/build/3f5a8d4bb857edbd034e5c2c3fc19534.png"},"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"Processing year 2019...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7dcb94c4c6f29d1626d0323b77830bf3","path":"/cci-notebook-viewers/build/7dcb94c4c6f29d1626d0323b77830bf3.png"},"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"Processing year 2020...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"213a29a6dff883ba38e16ae825238992","path":"/cci-notebook-viewers/build/213a29a6dff883ba38e16ae825238992.png"},"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"PhfzwCnqRr"}],"key":"TBNGMLasNz"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[],"key":"Soqi30UPXZ"},{"type":"heading","depth":4,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Create a Gif from the Pictures","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KHUMASdnCR"}],"identifier":"create-a-gif-from-the-pictures","label":"Create a Gif from the Pictures","html_id":"create-a-gif-from-the-pictures","implicit":true,"key":"vTjR3wn44j"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Next, we show you how to create a small animation from the produced pictures and save it as gif. This obviously only makes sense if you have produced several plots and saved them in one folder.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"I8rCi72csP"}],"key":"sL9hC9Ajlo"}],"key":"KAAwJhZUlD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from PIL import Image\nimport os\npng_dir = './Biomass/'\n\nimages = []\nfor filename in sorted(os.listdir(png_dir)):\n    if filename.endswith('.png'):\n        img = Image.open(os.path.join(png_dir, filename))\n        images.append(img)\n\nimages[0].save(\n    './biomass.gif',\n    save_all=True,\n    append_images=images[1:],\n    duration=500,  # milliseconds per frame adjust for your purpose\n    loop=0\n)","key":"Juka4RG6uj"},{"type":"output","id":"sfHr3iNUpaDbysmXsj3xn","data":[],"key":"ARHhiplhjp"}],"key":"OkzIfHFCB5"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[{"type":"heading","depth":2,"children":[{"type":"text","value":"Land Cover","key":"ACaPj0h9qB"}],"identifier":"land-cover","label":"Land Cover","html_id":"land-cover","implicit":true,"key":"UZcProqoxr"},{"type":"heading","depth":3,"children":[{"type":"text","value":"Load and Visualise the Land Cover Dataset","key":"i5yA2YKcwi"}],"identifier":"load-and-visualise-the-land-cover-dataset","label":"Load and Visualise the Land Cover Dataset","html_id":"load-and-visualise-the-land-cover-dataset","implicit":true,"key":"ZC8lPRuNog"},{"type":"paragraph","children":[{"type":"text","value":"Next, we are loading the land cover dataset. The procedure is the same as for the biomass data.","key":"MgDTIn5DOB"}],"key":"P73FL11z3i"},{"type":"paragraph","children":[{"type":"text","value":"The land cover classes and their colours are defined below and can be found in the üîó ","key":"KiO2DPC9Wr"},{"type":"link","url":"https://climate.esa.int/media/documents/CCI_Land_Cover_PUG_v2.0.pdf","children":[{"type":"text","value":"Product User Guide","key":"CEnHr6abZh"}],"urlSource":"https://climate.esa.int/media/documents/CCI_Land_Cover_PUG_v2.0.pdf","key":"E7BmsKEOys"},{"type":"text","value":".","key":"eofssMoIgv"}],"key":"ppqzcHxziE"},{"type":"heading","depth":4,"children":[{"type":"text","value":"Land Cover Classification System (LCCS) - the CCI-Land Cover legend","key":"pAHLia0cS6"}],"identifier":"land-cover-classification-system-lccs-the-cci-land-cover-legend","label":"Land Cover Classification System (LCCS) - the CCI-Land Cover legend","html_id":"land-cover-classification-system-lccs-the-cci-land-cover-legend","implicit":true,"key":"ZwgbjIfkrx"},{"type":"table","children":[{"type":"tableRow","children":[{"type":"tableCell","header":true,"children":[{"type":"text","value":"VALUE","key":"WWM88fgelk"}],"key":"W5ui2DykYA"},{"type":"tableCell","header":true,"children":[{"type":"text","value":"LCCS LABEL","key":"UKDjXAUaVr"}],"key":"MK4XbvG29C"}],"key":"JwVPDpHZQx"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"10","key":"D6ANCWZq0Z"}],"key":"Qfqkm71tTp"},{"type":"tableCell","children":[{"type":"text","value":"Rainfed shrub crops // Rainfed tree crops // Rainfed herbaceous crops","key":"F3xhJPklOO"}],"key":"iuToYaKTSD"}],"key":"zWTGmhlzI9"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"11","key":"G1Ez74XnZe"}],"key":"Fa2N4EOur3"},{"type":"tableCell","children":[{"type":"text","value":"Rainfed herbaceous crops","key":"QxKwjqbrco"}],"key":"mrlSP14DCj"}],"key":"dCtBDee6Dh"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"12","key":"XCDv6tVd3A"}],"key":"dSnkYmM6Hf"},{"type":"tableCell","children":[{"type":"text","value":"Rainfed shrub crops // Rainfed tree crops","key":"HmIIQ9STW8"}],"key":"aRPSMneQ71"}],"key":"OwEWfeDx4u"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"20","key":"RTiZwJimxG"}],"key":"K7KOKCx3N5"},{"type":"tableCell","children":[{"type":"text","value":"Irrigated tree crops // Irrigated shrub crops // Irrigated herbaceous crops // Post-flooding cultivation of herbaceous crops","key":"WgHtZw9qgU"}],"key":"fVWlPV2rJy"}],"key":"xqsOFkrgNV"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"30","key":"iDPZQt6pgT"}],"key":"aFWAi5CXVx"},{"type":"tableCell","children":[{"type":"text","value":"Cultivated and managed terrestrial areas / Natural and semi-natural primarily terrestrial vegetation","key":"KbCOxnG9o0"}],"key":"uNmVpm9Hnz"}],"key":"g31akUBsta"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"40","key":"zdQ1AsBOGo"}],"key":"pHAQh8b3EQ"},{"type":"tableCell","children":[{"type":"text","value":"Natural and semi-natural primarily terrestrial vegetation / Cultivated and managed terrestrial areas","key":"O7iH9cO2Hg"}],"key":"TfMUQWjuPm"}],"key":"nnop60ndk7"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"50","key":"b7cUcFxPVG"}],"key":"lrkqPR1VHn"},{"type":"tableCell","children":[{"type":"text","value":"Broadleaved evergreen closed to open trees // Broadleaved semi-deciduous closed to open trees","key":"j5eVuqtUAl"}],"key":"dESi1i0xFi"}],"key":"h7aFbauRN4"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"60","key":"pWuzbFeFiu"}],"key":"ranUHh3Qzr"},{"type":"tableCell","children":[{"type":"text","value":"Broadleaved deciduous closed to open trees","key":"Ervn2sqktm"}],"key":"O6giOPJiOA"}],"key":"f2aNIW1aWn"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"61","key":"WT38g07gh9"}],"key":"jFuSbFHQez"},{"type":"tableCell","children":[{"type":"text","value":"Broadleaved deciduous closed (100-40%) trees","key":"NY64YbpuRo"}],"key":"UtA16KbBlu"}],"key":"sXbG2QZUgk"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"62","key":"NvwCx897Hc"}],"key":"Y13e7SOFo9"},{"type":"tableCell","children":[{"type":"text","value":"Broadleaved deciduous open (40-(20-10)%) trees","key":"hXG6SdPfhq"}],"key":"kFteimItsv"}],"key":"RzxsweCXGa"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"70","key":"XYF8x2jaaW"}],"key":"RY0uJUFiRg"},{"type":"tableCell","children":[{"type":"text","value":"Needleleaved evergreen closed to open trees","key":"ARe3DXQe55"}],"key":"PudMVOl4Rr"}],"key":"QM2OTizHMr"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"71","key":"zVvvfJuHFU"}],"key":"iOd096Nncc"},{"type":"tableCell","children":[{"type":"text","value":"Needleleaved evergreen closed (100-40%) trees","key":"wsQOmTGUYd"}],"key":"RlAvgSNPhy"}],"key":"q0hyqn0JoS"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"72","key":"EkqpKyHK0L"}],"key":"Ed8JOi43my"},{"type":"tableCell","children":[{"type":"text","value":"Needleleaved evergreen open (40-(20-10)%) trees","key":"xZZzoVgpKU"}],"key":"CAPOWu3Dlq"}],"key":"gtdaKhZmWE"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"80","key":"XrRp5XcRV8"}],"key":"k6XqB3nwbc"},{"type":"tableCell","children":[{"type":"text","value":"Needleleaved deciduous closed to open trees","key":"iqg47ubeXC"}],"key":"j2IDCy24GO"}],"key":"IpdptHP2OV"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"81","key":"kjmLvMiP3t"}],"key":"ftOmk878PB"},{"type":"tableCell","children":[{"type":"text","value":"Needleleaved deciduous closed (100-40%) trees","key":"npmIWfiwZW"}],"key":"YQ1sXvhuge"}],"key":"b87uNnitSm"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"82","key":"OyZZ6LzR8A"}],"key":"hz2wp0xqJ0"},{"type":"tableCell","children":[{"type":"text","value":"Needleleaved deciduous open (40-(20-10)%) trees","key":"m095JjhvTJ"}],"key":"JO9qseSqcE"}],"key":"ImvxQov2F1"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"90","key":"foEWlWA4sf"}],"key":"CJhFp0LWR9"},{"type":"tableCell","children":[{"type":"text","value":"Broadleaved closed to open trees / Needleleaved closed to open trees","key":"IXpG4wbseA"}],"key":"uxaaBypucS"}],"key":"Tb0wzFUaBz"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"100","key":"HUSAgcEQFC"}],"key":"lqnUZwMZbh"},{"type":"tableCell","children":[{"type":"text","value":"Closed to open trees / Closed to open shrubland (thicket) // Herbaceous closed to open vegetation","key":"JdGku9i4zL"}],"key":"yll4xXb74B"}],"key":"YPYmm3R28U"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"110","key":"EJeR42vInr"}],"key":"jCwZj6PcnW"},{"type":"tableCell","children":[{"type":"text","value":"Herbaceous closed to open vegetation // Closed to open trees / Closed to open shrubland (thicket)","key":"Ef2TapgDfJ"}],"key":"pZ0eq9qwfe"}],"key":"ozLGLkLXkj"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"120","key":"iO2yKR7m8z"}],"key":"EHlqs9bWX2"},{"type":"tableCell","children":[{"type":"text","value":"Broadleaved closed to open shrubland (thicket)","key":"LeoyVOnajy"}],"key":"F3yvtTIf88"}],"key":"NVN48Qm7Ve"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"121","key":"jKmUPVtfCG"}],"key":"f6FdbaAqze"},{"type":"tableCell","children":[{"type":"text","value":"Broadleaved Evergreen Closed to Open Thicket // Needleleaved Evergreen Closed to Open Thicket","key":"c7zL8szbCX"}],"key":"C73wmziytb"}],"key":"tZxkC8MQCA"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"122","key":"k7M4juCdVq"}],"key":"HezOpFJ9on"},{"type":"tableCell","children":[{"type":"text","value":"Broadleaved Deciduous Closed to Open Thicket // Needleleaved Deciduous Closed to Open Thicket","key":"sQVpuvkeW5"}],"key":"ZtOLRi8z7f"}],"key":"fuQvV6ErSg"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"130","key":"ps3SL8HJ3H"}],"key":"vochSQxQY8"},{"type":"tableCell","children":[{"type":"text","value":"Herbaceous closed to very open vegetation 21453 A2A20","key":"oNC3ftr8Je"}],"key":"GDOE8nW1CN"}],"key":"ayRzFmYB68"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"140","key":"TKj2okgQvN"}],"key":"uZXN93mjR6"},{"type":"tableCell","children":[{"type":"text","value":"Closed to open lichens/mosses","key":"PIf11eROnD"}],"key":"jrR46W8VjG"}],"key":"odgTqqK9ke"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"150","key":"N6G8Yl6FJd"}],"key":"hihnrocCeH"},{"type":"tableCell","children":[{"type":"text","value":"Sparse trees // Herbaceous sparse vegetation // Sparse shrubs","key":"GJ1IdMbVng"}],"key":"pw9ZdyYYcJ"}],"key":"S2LCxLk4iI"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"151","key":"NBsPhs7IHv"}],"key":"wpyjbuHqw2"},{"type":"tableCell","children":[{"type":"text","value":"Sparse Trees","key":"hMD0fJhsks"}],"key":"uT9Pj8V1OI"}],"key":"eRYgxkmuKq"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"152","key":"n51QslbKoh"}],"key":"boAGGEAfoK"},{"type":"tableCell","children":[{"type":"text","value":"Sparse Shrubs","key":"vJZ977ysRd"}],"key":"JHESAUAkRn"}],"key":"SAR0lkSPmW"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"153","key":"PvxGzL5Sio"}],"key":"aBqE2t0ngS"},{"type":"tableCell","children":[{"type":"text","value":"Herbaceous Sparse Vegetation","key":"TZq63uwDuY"}],"key":"QJOGqcFbE5"}],"key":"m9dSEk7vmq"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"160","key":"QwWXiYotJQ"}],"key":"spqlDBRjxv"},{"type":"tableCell","children":[{"type":"text","value":"Closed to open (100-40%) broadleaved trees on temporarily flooded land, water quality: fresh water // Closed to open (100-40%) broadleaved trees on permanently flooded land, water quality: fresh water","key":"liTNIYRMOY"}],"key":"tMtqOKnfEo"}],"key":"D8Vm0N3JXx"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"170","key":"vuNArivOsB"}],"key":"tejsHaSwYP"},{"type":"tableCell","children":[{"type":"text","value":"Closed to open (100-40%) broadleaved trees on permanently flooded land (with daily variations), water quality: saline water // Closed to open (100-40%) broadleaved trees on permanently flooded land (with daily variations), water quality: brackish water // Closed to open (100-40%) semi-deciduous shrubland on permanently flooded land (with daily variations), water quality: saline water // Closed to open (100-40%) semi-deciduous shrubland on permanently flooded land (with daily variations), water quality: brackish water","key":"eouWJ7b2Oj"}],"key":"r8ovUvbgbC"}],"key":"RAp55477OF"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"180","key":"qTWRBNdXQF"}],"key":"Th4hw3Lis2"},{"type":"tableCell","children":[{"type":"text","value":"Closed to open shrubs on permanently flooded land // Closed to open herbaceous vegetation on permanently flooded land // Closed to open shrubs on temporarily flooded land // Closed to open herbaceous vegetation on temporarily flooded land // Closed to open shrubs on waterlogged soil // Closed to open herbaceous vegetation on waterlogged soil (Water quality: fresh, brackish or saline water)","key":"XtJb1RXUGV"}],"key":"litVi6yJIN"}],"key":"BqGTUJgQYv"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"190","key":"sW6o3MikGK"}],"key":"op76AMNhaL"},{"type":"tableCell","children":[{"type":"text","value":"Artificial surfaces and associated areas","key":"RDriNpVLrX"}],"key":"Pgo00JzoLj"}],"key":"ZOeGT61Jzr"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"200","key":"gKdEIYKvmZ"}],"key":"ewPJMNzJzb"},{"type":"tableCell","children":[{"type":"text","value":"Bare areas","key":"L9dhHTFmgs"}],"key":"ERSgQynyqf"}],"key":"FNH94GO6ts"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"201","key":"W2SUdYD7IW"}],"key":"WtxJDNeVq5"},{"type":"tableCell","children":[{"type":"text","value":"Consolidated Material(s)","key":"OhPKTHGFuT"}],"key":"SPBChd5NYJ"}],"key":"nfwokPhBjh"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"202","key":"xyVWNikG3l"}],"key":"Nm8cQPLAX6"},{"type":"tableCell","children":[{"type":"text","value":"Unconsolidated Material(s)","key":"G2DyVjdedT"}],"key":"KuZIRViJrW"}],"key":"zyCgfNu5nZ"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"210","key":"qaiWjbpPfK"}],"key":"CCYiFmxmEu"},{"type":"tableCell","children":[{"type":"text","value":"Natural water bodies // Artificial water bodies","key":"MjlVxHDxfO"}],"key":"GrVwrwda0e"}],"key":"Adx664MjRV"},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"220","key":"adAzMSVCF0"}],"key":"Kq5V1MwgNc"},{"type":"tableCell","children":[{"type":"text","value":"Artificial perennial snow // Artificial perennial ice // Perennial snow // Perennial ice","key":"HE5VgxyjvU"}],"key":"EMYpqjwllE"}],"key":"EyjhXlR577"}],"key":"nmVYgeTzSW"},{"type":"paragraph","children":[{"type":"text","value":"Next, we define the class IDs, their names and the correct colours for the plotting.","key":"sojUs3M8Op"}],"key":"XQtbvLauT1"}],"key":"Qg8ewgF0To"}],"key":"uw7iajMZXA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Define the LCCS colours according to their ID and names\nclass_ids = [\n    10, 11, 12, 20, 30, 40,           # Cultivated areas\n    50, 60, 61, 62,                  # Broadleaved trees\n    70, 71, 72,                      # Needleleaved evergreen trees\n    80, 81, 82,                      # Needleleaved deciduous trees\n    90, 100, 110,                    # Mixed vegetation\n    120, 121, 122,                   # Shrubland\n    130, 140,                        # Herbaceous and lichens/mosses\n    150, 151, 152, 153,              # Sparse vegetation\n    160, 170, 180,                   # Aquatic vegetation\n    190,                             # Artificial surfaces\n    200, 201, 202,                   # Bare areas\n    210, 220                         # Water bodies, snow and ice\n]\nclass_names = [\n    \"Rainfed crops\",                                   # 10\n    \"Rainfed herbaceous crops\",                        # 11\n    \"Rainfed shrub/tree crops\",                        # 12\n    \"Irrigated crops\",                                 # 20\n    \"Cropland/Natural vegetation mosaic\",              # 30\n    \"Natural vegetation/Cropland mosaic\",              # 40\n    \"Broadleaved evergreen/semi-deciduous trees\",      # 50\n    \"Broadleaved deciduous trees\",                     # 60\n    \"Broadleaved deciduous closed trees\",              # 61\n    \"Broadleaved deciduous open trees\",                # 62\n    \"Needleleaved evergreen trees\",                    # 70\n    \"Needleleaved evergreen closed trees\",             # 71\n    \"Needleleaved evergreen open trees\",               # 72\n    \"Needleleaved deciduous trees\",                    # 80\n    \"Needleleaved deciduous closed trees\",             # 81\n    \"Needleleaved deciduous open trees\",               # 82\n    \"Mixed broadleaved/needleleaved trees\",            # 90\n    \"Mixed trees/shrubland/herbaceous\",                # 100\n    \"Herbaceous/trees/shrubland\",                      # 110\n    \"Shrubland\",                                       # 120\n    \"Evergreen shrubland\",                             # 121\n    \"Deciduous shrubland\",                             # 122\n    \"Grassland\",                                       # 130\n    \"Lichens and mosses\",                              # 140\n    \"Sparse vegetation\",                               # 150\n    \"Sparse trees\",                                    # 151\n    \"Sparse shrubs\",                                   # 152\n    \"Sparse herbaceous\",                               # 153\n    \"Flooded trees (fresh water)\",                     # 160\n    \"Flooded trees (saline/brackish water)\",           # 170\n    \"Flooded shrubs/herbaceous\",                       # 180\n    \"Urban areas\",                                     # 190\n    \"Bare areas\",                                      # 200\n    \"Consolidated bare areas\",                         # 201\n    \"Unconsolidated bare areas\",                       # 202\n    \"Water bodies\",                                    # 210\n    \"Snow and ice\"                                     # 220\n]\n\ncolors = [\n    \"#ffff64\", \"#90ee90\", \"#228b22\", \"#ffd700\",        # Crops (10-12, 20)\n    \"#daa520\", \"#b8860b\",                              # Crop mosaics (30, 40)\n    \"#006400\", \"#228b22\", \"#32cd32\", \"#7cfc00\",        # Broadleaved trees (50, 60-62)\n    \"#2f4f4f\", \"#708090\", \"#778899\",                   # Needleleaved evergreen (70-72)\n    \"#8b4513\", \"#a0522d\", \"#cd853f\",                   # Needleleaved deciduous (80-82)\n    \"#556b2f\", \"#6b8e23\", \"#9acd32\",                   # Mixed/shrubland (90, 100, 110)\n    \"#d2691e\", \"#ff8c00\", \"#ffa500\",                   # Shrubland (120-122)\n    \"#adff2f\", \"#bdb76b\",                              # Grassland, lichens (130, 140)\n    \"#f5deb3\", \"#deb887\", \"#d2b48c\", \"#bc8f8f\",        # Sparse vegetation (150-153)\n    \"#4682b4\", \"#5f9ea0\", \"#20b2aa\",                   # Wetlands (160, 170, 180)\n    \"#dc143c\",                                         # Urban (190)\n    \"#f5f5dc\", \"#fff8dc\", \"#faebd7\",                   # Bare areas (200-202)\n    \"#4169e1\", \"#ffffff\"                               # Water, snow/ice (210, 220)\n]\n","key":"Ae25dMekOS"},{"type":"output","id":"O9OFOni7CSjFR1JDMTH53","data":[],"key":"GjdKO9QZyE"}],"key":"vdYitpiIWJ"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[{"type":"text","value":"Now let's load the dataset and build the subset for the defined bbox.","key":"fhZoCFUv9A"}],"key":"c2oS77BtFQ"}],"key":"WieotnWhps"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Land Cover data ID\ndata_id = 'ESACCI-LC-L4-LCCS-Map-300m-P1Y-1992-2015-v2.0.7b.zarr' \n\nlc_ds = cci_zarr_store.open_data(\n    data_id = data_id\n)\n# Building the subset \nsubset_spatial_op = get_op('subset_spatial')\nlc_sub = subset_spatial_op(ds=lc_ds, region=bbox)","key":"dhXs1jGCQz"},{"type":"output","id":"tbnSnTmXb4HclyUDcdflR","data":[],"key":"vVBoVOdxmi"}],"key":"DuDahwINEk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Define years to loop through\nyears = range(2018, 2021)  # adapt as needed\ncmap = ListedColormap(colors)\n\nfor year in years:\n    print(f\"Processing year {year}...\")\n    \n    # Create timestep for biomass (yearly data)\n    timestep = f'{year}-01-01'\n    \n    # Load and extract the biomass data\n    lc = lc_sub[\"lccs_class\"].sel(time=timestep, method='nearest').compute()\n    time_str = lc_sub['time'].sel(time=timestep, method='nearest').dt.strftime('%Y').item()\n    lat = lc_sub[\"lat\"]\n    lon = lc_sub[\"lon\"]\n    \n    fig = plt.figure(figsize=(12, 6))\n    \n    # Create two axes with the same projection\n    ax = plt.axes(projection=ccrs.PlateCarree())\n  \n    # Plot lc on first axis\n    mesh_biomass = ax.pcolormesh(\n        lon, lat, lc,\n        cmap=cmap, shading=\"auto\",\n    )\n    # Hide grid lines\n    ax.grid(False)\n     # Add year label in upper-right corner\n    # Add year label in upper-right corner\n    ax.text(\n        -50.9,-2.75, # define location for the text\n        str(year),\n        color='white',\n        fontsize=28,\n        fontweight='bold',\n        transform=ccrs.PlateCarree()\n    )  \n    \n    # Add custom legend\n    from matplotlib.patches import Patch\n    # Find the unique land cover classes in the current plotted area to reduce the legend entries\n    visible_classes = np.unique(lc.values)\n\n    # Build legend only for classes present in the plot\n    legend_handles = [\n        Patch(color=colors[class_ids.index(cid)], label=class_names[class_ids.index(cid)])\n        for cid in visible_classes if cid in class_ids\n    ]\n    \n    #ax.legend(handles=legend_handles, bbox_to_anchor=(1, 1), loc=\"upper right\", ncol=2,fontsize=8)\n    plt.show()\n        \n    # Save with year in filename\n    #plt.savefig(f'./LandCover_{year}.png', bbox_inches='tight')\n    #plt.close()  # Close figure to free memory\n   ","key":"u1UvtQmJsH"},{"type":"output","id":"tDjrsb5V1YLb5RTjtj1Fb","data":[{"name":"stdout","output_type":"stream","text":"Processing year 2018...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"53574812c7368d2d512f4836869e8c8b","path":"/cci-notebook-viewers/build/53574812c7368d2d512f4836869e8c8b.png"},"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"Processing year 2019...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7d7d2bcf1eba8a226da3561cfa6b3ad8","path":"/cci-notebook-viewers/build/7d7d2bcf1eba8a226da3561cfa6b3ad8.png"},"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"Processing year 2020...\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"224367e191c1637f8db491c6d38c83fd","path":"/cci-notebook-viewers/build/224367e191c1637f8db491c6d38c83fd.png"},"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"}}}],"key":"aEc5IGHtuZ"}],"key":"PjLccv2goa"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#F5D6AD","padding":"10px","borderRadius":"5px"},"children":[{"type":"heading","depth":3,"children":[{"type":"text","value":"Load Other Essential Climate Variables","key":"igo1siJPNr"}],"identifier":"load-other-essential-climate-variables","label":"Load Other Essential Climate Variables","html_id":"load-other-essential-climate-variables","implicit":true,"key":"uiC2O4cQQP"},{"type":"paragraph","children":[{"type":"text","value":"Below is a list of datafiles you can use for other ECVs which might be of interest when looking at biomass loss. If you need inspiration or tipps on how to visualise the parameters, you can have a look at the individual Jupyter Notebooks for each ECV either in the Example Explorer or on üîó ","key":"EQxyGi96RM"},{"type":"link","url":"https://github.com/esa-cci/cci-notebooks/tree/main/notebooks","children":[{"type":"text","value":"GitHub","key":"W3FyrIMEEP"}],"urlSource":"https://github.com/esa-cci/cci-notebooks/tree/main/notebooks","error":true,"key":"QUSdJAw8di"},{"type":"text","value":".","key":"VC0ID3NNlC"}],"key":"aBfZ5DS12a"},{"type":"heading","depth":4,"children":[{"type":"text","value":"Fire","key":"D5D74rN5Ew"}],"identifier":"fire","label":"Fire","html_id":"fire","implicit":true,"key":"YKFU4DjfEm"},{"type":"paragraph","children":[{"type":"inlineCode","value":"data_id = 'ESACCI-L4_FIRE-BA-MODIS-2001-2022-fv5.1.zarr'","key":"iYm0Af2H0P"}],"key":"AJoqMVWo0P"},{"type":"heading","depth":4,"children":[{"type":"text","value":"Clouds","key":"vTOmd3tdbN"}],"identifier":"clouds","label":"Clouds","html_id":"clouds","implicit":true,"key":"UecFp5pPvd"},{"type":"paragraph","children":[{"type":"inlineCode","value":"data_id = 'ESACCI-L3C_CLOUD-CLD_PRODUCTS-AVHRR_NOAA-1982-2016-fv3.0.zarr'","key":"hLJnoehX1E"}],"key":"amsNildoyY"},{"type":"heading","depth":4,"children":[{"type":"text","value":"Land Surface Temperature (LST)","key":"JXwADzWQrX"}],"identifier":"land-surface-temperature-lst","label":"Land Surface Temperature (LST)","html_id":"land-surface-temperature-lst","implicit":true,"key":"lHKJSsITOy"},{"type":"paragraph","children":[{"type":"inlineCode","value":"data_id = 'ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_DAY-1995-2020-fv3.00.zarr'","key":"QAZ5qYwLak"}],"key":"xoxc9AC8ER"},{"type":"heading","depth":4,"children":[{"type":"text","value":"Greenhouse Gases (GHG) - CO2","key":"XuM8CFKYHG"}],"identifier":"greenhouse-gases-ghg-co2","label":"Greenhouse Gases (GHG) - CO2","html_id":"greenhouse-gases-ghg-co2","implicit":true,"key":"z18UMld99I"},{"type":"paragraph","children":[{"type":"inlineCode","value":"data_id = 'ESACCI-GHG-L2-CO2-SCIAMACHY-WFMD-2002-2012-fv1.zarr'","key":"tchjDkIP7e"}],"key":"CjZV1d3YjL"},{"type":"heading","depth":4,"children":[{"type":"text","value":"Water Vapour","key":"wAbiV7RMqX"}],"identifier":"water-vapour","label":"Water Vapour","html_id":"water-vapour","implicit":true,"key":"UMSAs9gs0Z"},{"type":"paragraph","children":[{"type":"inlineCode","value":"data_id = 'ESACCI-WATERVAPOUR-L3C-TCWV-meris-005deg-2002-2017-fv3.2.zarr'","key":"DglpYnkGQi"}],"key":"Iv5tD5iOFH"}],"key":"OcT2s5F8O2"}],"key":"i7qKD2AT4g"}],"key":"T6fBGc2R2t"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"README","url":"/external-notebooks/esa-cci/ect-training/adaptation-futures-nz-10-2025/readme","group":"Adaptation Futures NZ 10 2025"},"next":{"title":"Step 1. Setup & Imports","url":"/external-notebooks/esa-cci/ect-training/lps-vienna-06-2025/lps-beginner","group":"Lps Vienna 06 2025"}}},"domain":"http://localhost:3000"}