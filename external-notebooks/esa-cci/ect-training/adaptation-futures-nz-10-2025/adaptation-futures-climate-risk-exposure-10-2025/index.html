<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Step 1. Setup &amp; Imports - CCI Examples</title><meta property="og:title" content="Step 1. Setup &amp; Imports - CCI Examples"/><meta name="generator" content="mystmd"/><meta name="description" content="Collection of examples relevant to the CCI activity"/><meta property="og:description" content="Collection of examples relevant to the CCI activity"/><meta name="keywords" content=""/><meta name="image" content="/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png"/><meta property="og:image" content="/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png"/><link rel="stylesheet" href="/cci-notebook-viewers/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/cci-notebook-viewers/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/cci-notebook-viewers/favicon.ico"/><link rel="stylesheet" href="/cci-notebook-viewers/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block lg:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/cci-notebook-viewers/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">‚åò</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] lg:hidden hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-none pr-2 smallcaps">CCI Examples</div><div class="flex-grow"></div><a href="https://github.com/esa-cci/cci-notebook-viewers" title="GitHub Repository: esa-cci/cci-notebook-viewers" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/esa-cci/cci-notebook-viewers/blob/main/external_notebooks/esa-cci/ect-training/adaptation-futures_NZ_10_2025/Adaptation-Futures_Climate-Risk-Exposure_10_2025.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Step 1. Setup &amp; Imports</h1></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="zCMRyN6jpa" class="relative group/block"><div class="" style="text-align:center"><h1 id="adaptation-futures-conference-af2025-training-illustrating-climate-risk-exposure-with-cci-data" class="relative group"><span class="heading-text">Adaptation Futures Conference (AF2025) Training - Illustrating Climate Risk Exposure with CCI Data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#adaptation-futures-conference-af2025-training-illustrating-climate-risk-exposure-with-cci-data" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h1></div><p>#Adaptation Futures Conference (AF2025) Training - Illustrating Climate Risk Exposure with CCI Data</p></div><div id="EVO69vQYeU" class="relative group/block"><img id="DcsspLsdx0" style="margin:0 auto" src="/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png" alt="cci_logo.png" data-canonical-url="data:image/png;base64,iVBORw0KGg...ORK5CYII=
" class=""/></div><div id="sLcYdJkYOH" class="relative group/block"><div class="" style="background-color:#e6f3ff;padding:10px;border-left:5px solid #e6f3ff"><h2 id="id-1-introduction" class="relative group"><span class="heading-text">1. Introduction:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-introduction" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h2><p>In this beginner-friendly notebook, we will use real satellite-based Essential Climate Variables (ECVs) data from the <a target="_blank" rel="noreferrer" href="https://climate.esa.int/en/odp/#/dashboard" class="">ESA Climate Change Initiative (CCI)</a> to explore recent climate trends. We will also look at how to combine population dataset with ECVs to have a first-order estimation of risk exposure caused by extreme weather events.</p><p>This notebook is designed for <strong>participants with no prior experience in Python or climate data analysis</strong>. You will learn:</p><ul><li><p>How to access CCI ECVs using the CCI Toolbox python Package</p></li><li><p>How to navigate and subset climate data using Xarray</p></li><li><p>How to compute basic plots using Matplotlib</p></li><li><p>How to save a figure you generated</p></li><li><p>How to map and interpret ECVs changes over time and space</p></li></ul></div></div><div id="yFNSuNgwNk" class="relative group/block"><h2 id="step-1-setup-imports" class="relative group"><span class="heading-text">Step 1. Setup &amp; Imports</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-1-setup-imports" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h2><p>Before we start working with the data, we need to import a few Python libraries. These libraries provide useful tools for working with satellite data, performing simple calculations, and creating visualizations.</p><p>Don‚Äôt worry if you‚Äôre not familiar with these yet ‚Äî we will explain what you need as we go.</p></div><div id="Is8lrSyMOd" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># ESA Climate Toolbox imports for accessing and plotting ESA CCI data
from esa_climate_toolbox.core import get_op              # Get predefined operations (e.g., time series, averages)
from esa_climate_toolbox.core import list_ecv_datasets   # List available datasets per ECV (Essential Climate Variable)
from esa_climate_toolbox.core import get_store           # Connect to an ESA data store
from esa_climate_toolbox.core import list_datasets       # List all datasets in a store
from esa_climate_toolbox.core import search
from esa_climate_toolbox.ops import plot                 # High-level plotting functions for CCI data

# Used for connecting to remote data sources (e.g., ESA CCI ODP)
from xcube.core.store import new_data_store

# For displaying geographic regions interactively (if desired)
from IPython.display import GeoJSON
import shapely.geometry   # Handling geometric objects like bounding boxes

# Core data science libraries
import pandas as pd       # For tabular data handling and time manipulation
import numpy as np        # For numerical operations
import xarray as xr       # For multi-dimensional climate data structures

# Mapping and plotting
import matplotlib.pyplot as plt       # Plotting library
from matplotlib.colors import TwoSlopeNorm
import cartopy.crs as ccrs            # Cartographic projections for spatial data
import cartopy.feature as cfeature
import rasterio                       # Used to read GeoTIFF files

# Notebook settings
import warnings
warnings.filterwarnings(&quot;ignore&quot;) # Suppressing warnings to keep notebook output clean
%matplotlib inline</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_wGTT9tj3RD4pkJFZbTix" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="H46AfP49dX" class="relative group/block"><h4 id="why-we-need-those-python-packages" class="relative group"><span class="heading-text"><strong>Why we need those Python packages:</strong></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#why-we-need-those-python-packages" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h4><ul><li><code>numpy</code>: helps with numbers and arrays.</li><li><code>matplotlib</code>: lets us create plots and maps.</li><li><code>xarray</code>: makes it easy to work with climate datasets.</li><li><code>cartopy</code>: helps plot maps with geographic context.</li><li><code>Toolbox</code>: a package that facilitates access and computation of CCI data</li></ul><h5 id="up-next-we-will-learn-how-to-access-ecvs-from-the-cci-toolbox" class="relative group"><span class="heading-text"><em><strong>Up next:</strong></em> We will learn how to <strong>access ECVs</strong> from the CCI Toolbox.</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#up-next-we-will-learn-how-to-access-ecvs-from-the-cci-toolbox" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h5></div><div id="UQO5J3NbjY" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#list_datasets(&quot;esa-cci-zarr&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-c55YeAeMrVb6XzfIU7pe" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="zhXLt6nVUA" class="relative group/block"><h2 id="step-2-load-visualize-land-surface-temperature-data-lst" class="relative group"><span class="heading-text">Step 2: Load &amp; Visualize Land Surface Temperature data (LST)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-2-load-visualize-land-surface-temperature-data-lst" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h2><h3 id="define-the-dataset-id" class="relative group"><span class="heading-text">Define the Dataset ID</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#define-the-dataset-id" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h3><p>To work with a specific ESA CCI dataset, we need to specify its <strong>dataset ID</strong>. This unique identifier tells the toolbox which variable and product we want to access.
When using the command <code>list_ecv_datasets</code>, you can see all available datasets for the chosen parameter (in this case <code>&quot;LST&quot;</code>).</p><p>First, we define the dataset ID and the store from which we retrieve the data (for the LST file it is <code>esa-cci</code>).
In this section, we are using <strong>land surface temperature (LST)</strong> data from the esa-cci-zarr store. You can find the variables of the products under <strong>data_vars</strong>. For the LST, we will use the variable <strong>lst</strong>.</p></div><div id="haxJU0lxaE" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Uncomment (-&gt; remove the &quot;# &quot;) the next line, if you wish to see all available datafiles for the LST
#list_ecv_datasets(&quot;LST&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bVjCdxKMhSWkWVjOCPQrN" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="b3YurSIltt" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Open the ESA CCI store
cci_store = new_data_store(&quot;esa-cci-zarr&quot;)
# define the dataset ID
data_id = &#x27;ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_DAY-1995-2020-fv3.00.zarr&#x27;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="VGQ2lF8e2ml8fS8yntpAq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="A4GX2nwQKM" class="relative group/block"><h3 id="describe-dataset-check-available-variables-and-metadata" class="relative group"><span class="heading-text">Describe Dataset (Check Available Variables and Metadata)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#describe-dataset-check-available-variables-and-metadata" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h3><p>Before loading the full dataset, it‚Äôs helpful to <strong>inspect the metadata</strong> to understand its structure by using the command <code>describe_data</code>. This includes:</p><ul><li>Available variables (e.g., lst, uncertainty estimates)</li><li>Temporal and spatial coverage</li><li>Data format and structure</li></ul><p>This step ensures we know what the dataset contains and how to work with it. It also helps confirm that the variable we want to plot or analyze is actually included.</p><p>üõ†Ô∏è Tip: You can use the description to verify variable names, dimensions (e.g., <code>lat</code>, <code>lon</code>, <code>time</code>), and time coverage. Under <strong>data_vars</strong> you can find the data variables and the <strong>attrs</strong> within the <strong>data_vars</strong> section show you the data attributes, e.g. the long name of the variable or the unit.</p><p>üìò More on dataset structure:<br/>üîó <a target="_blank" rel="noreferrer" href="https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#accessing-data" class="">ESA Climate Toolbox ‚Äì Data Access</a></p></div><div id="mU6VJ8ShUC" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Inspect the data structure
cci_store.describe_data(data_id)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="EKNGnsRiMFXRqKCOKm66L" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="vHSVJ70dRh" class="relative group/block"><h3 id="load-the-dataset" class="relative group"><span class="heading-text">Load the Dataset</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#load-the-dataset" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h3><p>Now that we have an understanding of the data structure and have defined the data store and ID, we can open the dataset by using the command <code>open_data</code>.</p><p>We can then inspect the data structure and content by displaying the dataset. The displayed dataset is interactive in Jupyter Notebooks, thus you can use the arrows to see the content of the dataset, e.g. the Data variables or Coordinates and you can click on the container symbol ‚ò∞ to see what is inside.</p></div><div id="cCCN5oWTaQ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">lst_ds = cci_store.open_data(
    data_id=data_id,
)
display(lst_ds)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="DKuHOHjFCcRG6Y4Q9BdJT" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="QheLRP45Ek" class="relative group/block"><h3 id="create-a-spatial-subset-of-the-lst-data" class="relative group"><span class="heading-text">Create a spatial subset of the LST data:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#create-a-spatial-subset-of-the-lst-data" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h3><p>To focus our analysis on New Zealand, we now extract a <strong>spatial subset</strong> from the global LST dataset.</p><p>Using the <strong>bounding box (bbox)</strong> we define here, the function <code>subset_spatial</code> filters the dataset to include only the relevant area.</p><p>This helps <strong>reduce data volume</strong> and enables more <strong>targeted visualizations and calculations</strong> in the following steps.</p><p>Below are several longitudes and latitudes to choose from. In the comment above, you can read which area they cover.</p></div><div id="qKJ0TdJW7R" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Set bounding box to New Zealand 
#lat_min = -53.0
#lat_max = -33.0
#lon_min = 165.0
#lon_max = 180.0  # Chatham Islands cannot be included here, as it is behind the 180th meridian of the longitude</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="e0Ssc8hvtCOoNhSu0syla" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="GN06ZeFEth" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># # Set bounding box to Christchurch
lat_min = -44
lat_max = -43.2
lon_min = 172.3
lon_max = 173.8</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="gEZqOsj14xelqXcMEUZG8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="tTbwDkRwWh" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Set bounding box to South Island
lat_min = -47.78
lat_max = -39.23
lon_min = 166.1
lon_max = 174.9</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="IXO9xtZylBLGfMsd52tke" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ColwOGB0ip" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Set bounding box to North Island
lat_min = -42.0
lat_max = -34.0
lon_min = 172.0
lon_max = 180.0</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8yZcyBS0c5rEVoGN423oE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="o9QDgSu3AO" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">bbox = (lon_min, lat_min, lon_max, lat_max)  # Fixed order: (lon_min, lat_min, lon_max, lat_max)
# Display bounding box for reference
GeoJSON(shapely.geometry.box(*bbox).__geo_interface__)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FhqjLxSepQOmFQv5oUh9C" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="zhwRKkqeUu" class="relative group/block"><h3 id="choosing-an-operator" class="relative group"><span class="heading-text">Choosing an operator</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#choosing-an-operator" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h3><p>The toolbox offers a variety of operators to choose which we can apply on the dataset. For creating a spatial subset, we would use the <code>subset_spatial</code> operator, for the temporal subset, we would use the <code>subset_temporal</code> operator. In the following cells, you can see how we call the operators and how we apply them to the data.</p><p>The <a target="_blank" rel="noreferrer" href="https://esa-climate-toolbox.readthedocs.io/en/latest/notebooks/Using_Operations/1-ECT_Finding_Operations.html#Finding-Operations" class="">available operators</a> can be listed via <code>list_operations</code> as shown below.</p></div><div id="O0XdWloKo2" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#Toolbox operators
from esa_climate_toolbox.core import list_operations
list_operations()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="4f_CqbaUhIdnEy1_LQFP3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[&#x27;add_dataset_values_to_geodataframe&#x27;,
 &#x27;adjust_spatial_attrs&#x27;,
 &#x27;adjust_temporal_attrs&#x27;,
 &#x27;aggregate_statistics&#x27;,
 &#x27;animate_map&#x27;,
 &#x27;anomaly_external&#x27;,
 &#x27;anomaly_internal&#x27;,
 &#x27;arithmetics&#x27;,
 &#x27;as_geodataframe&#x27;,
 &#x27;climatology&#x27;,
 &#x27;coregister&#x27;,
 &#x27;data_frame_max&#x27;,
 &#x27;data_frame_min&#x27;,
 &#x27;data_frame_subset&#x27;,
 &#x27;detect_outliers&#x27;,
 &#x27;diff&#x27;,
 &#x27;find_closest&#x27;,
 &#x27;fourier_analysis&#x27;,
 &#x27;gapfill&#x27;,
 &#x27;merge&#x27;,
 &#x27;normalize&#x27;,
 &#x27;plot&#x27;,
 &#x27;plot_contour&#x27;,
 &#x27;plot_hist&#x27;,
 &#x27;plot_line&#x27;,
 &#x27;plot_map&#x27;,
 &#x27;plot_scatter&#x27;,
 &#x27;query&#x27;,
 &#x27;reduce&#x27;,
 &#x27;resample&#x27;,
 &#x27;select_features&#x27;,
 &#x27;select_var&#x27;,
 &#x27;statistics&#x27;,
 &#x27;subset_spatial&#x27;,
 &#x27;subset_temporal&#x27;,
 &#x27;subset_temporal_index&#x27;,
 &#x27;temporal_aggregation&#x27;,
 &#x27;to_dataframe&#x27;,
 &#x27;to_dataset&#x27;,
 &#x27;tseries_mean&#x27;,
 &#x27;tseries_point&#x27;]</span></code></div></div></div><div id="Ug8osNUH8O" class="relative group/block"><p>If you would like to read more about the different operations, e.g. what they are doing, what is needed as input and output, you can retrieve this information as shown below.</p></div><div id="v8F1ijeRR4" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from IPython.display import JSON
from esa_climate_toolbox.core import get_op_meta_info

JSON(get_op_meta_info(&#x27;subset_spatial&#x27;))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="jAMVR-LoHvRXlLRPxnMsF" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="DavAryV3d2" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create the spatial subset with the bbox defined above
subset_spatial_op = get_op(&#x27;subset_spatial&#x27;)
lst_ds_sub = subset_spatial_op(ds=lst_ds, region=bbox)
lst_ds_sub</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="51TD9kJTsCFc7IdICSqyS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="BFvGIMFNGE" class="relative group/block"><h4 id="climatology-operator" class="relative group"><span class="heading-text">Climatology operator</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#climatology-operator" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h4><p>To create a ‚Äúmean over years‚Äù dataset, the <a target="_blank" rel="noreferrer" href="https://esa-climate-toolbox.readthedocs.io/en/latest/api_reference.html#esa_climate_toolbox.ops.climatology" class="">climatology operator</a> averages the values of the given input data over all years. This is applied in the same time resolution as the given dataset, meaning - a daily dataset will calculate a daily average over all years, a monthly dataset will calculate a monthly average accross all years.</p><p>Note: the resulting monthly or daily data will be attributed to the first time array. In the case below, the dataset has a time array rom 1995 containing all averages from 1995-2020.</p></div><div id="wler0fjFld" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">climatology_op = get_op(&#x27;climatology&#x27;)
lst_ds_clim = climatology_op(ds=lst_ds_sub)
lst_ds_clim # use this to have a quick look into the metadata</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="fhd4Tm-tkFBTYJ19wR-VS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="sUgQzN0zTM" class="relative group/block"><h3 id="plot-a-spatial-map-using-the-toolbox" class="relative group"><span class="heading-text">Plot a spatial map using the toolbox</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#plot-a-spatial-map-using-the-toolbox" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h3><p>Let‚Äôs plot the climatology dataset using the toolbox. As index, we choose <code>&#x27;time&#x27; : &#x27;1995-01-01&#x27;</code>, meaning, we look at the mean LST in January from 1995-2020.</p></div><div id="SirT0nCgqM" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plot_op = get_op(&#x27;plot&#x27;)
# Create a plot of the LST data

plot_op(
    ds=lst_ds_clim,  # Dataset variable
    var=&#x27;lst&#x27;,       # Variable you want to plot  # Specify the date
    title=&quot;Average Land Surface Temperature in January (1995-2020)&quot;,
     indexers={&#x27;time&#x27;: &#x27;1995-01-01&#x27;},  # Specify the date
    properties=&quot;cmap=&#x27;hot_r&#x27;, vmin=275, vmax= 325&quot;, # Pass other properties here, such as color
)

#
#Latitude, 43¬∞ 31&#x27; 55.39&quot;S. Longitude, 172¬∞ 38&#x27; 10.41&quot;E
city_lat, city_lon = -43.353, 172.636
plt.plot(city_lon, city_lat, linestyle=&#x27;--&#x27;, marker=&#x27;o&#x27;, color=&#x27;k&#x27;, label=&#x27;≈åtautahi - Christchurch &#x27;)
plt.legend()
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="As_oe7NfdA72tx31bklas" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/d150170b8bd9cb98d5f0fdb1ce1862a6.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="PmHFreZQ17" class="relative group/block"><h4 id="temporal-subset" class="relative group"><span class="heading-text">Temporal subset</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#temporal-subset" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h4><p>Next, we do a temporal subset of the dataset and choose only 2019.</p></div><div id="dfvQoaUJsj" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">subset_temporal_op = get_op(&#x27;subset_temporal&#x27;)
lst_ds_sub = subset_temporal_op(ds=lst_ds_sub, time_range=[&#x27;2019-01-01&#x27;, &#x27;2019-12-01&#x27;])
lst_ds_sub </code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="TEVuv7OQT35GEVom4rs2k" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="Nnqec93ES1" class="relative group/block"><p>Now let‚Äôs look at a heatwave year: 2019, in particular we will focus on January to see how we can combine LST and population data</p></div><div id="qmqlxCakXO" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#January 2019 LST data selection
lst_19_j=lst_ds_sub.lst.sel(time=&#x27;2019-01-01&#x27;)-273.15</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MwgTZRKSXzl2aJHdRqmIc" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="JTXsodLOPu" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">extent=[lon_min,lon_max,lat_min,lat_max]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="yoaGw3c1JAclIFXuefcru" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="xnsorKmDH8" class="relative group/block"><h3 id="combine-the-land-surface-temperature-data-with-a-population-density-map" class="relative group"><span class="heading-text">Combine the land surface temperature data with a population density map</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#combine-the-land-surface-temperature-data-with-a-population-density-map" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h3><p>We can combine satellite data with socio-economic data, such as density population maps.
The data is retrieved from the <a target="_blank" rel="noreferrer" href="https://human-settlement.emergency.copernicus.eu/download.php" class=""><strong>Global Human Settlement Layer</strong></a> from 2020 (note, that 2019 is not available). The resolution is 30 arcsec and the coordination system is WGS84. The data can be downloaded as <strong>tif</strong> file for several grids and the grids covering New Zealand have already been merged and can be found inside the same folder, where the Jupyter Notebook is stored.
The <strong>tif</strong> format includes relevant metadata, such as latitude and longitude, which allows us to combine it with the satellite data.</p><p>The data is licensed under <a target="_blank" rel="noreferrer" href="https://creativecommons.org/licenses/by/4.0/" class="">CC BY 4.0</a>.</p><p>The data has been processed (merged and clipped) for visualisation purposes in this notebook.</p></div><div id="Du1pp1bpOZ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Load population density raster
with rasterio.open(&quot;merged_population_NewZealand2020_density.tif&quot;) as src:
    pop_density = src.read(1) 
    bounds = src.bounds  # get the geographical boundaries of the tif file (left, bottom, right, top)
    extent = [bounds.left, bounds.right, bounds.bottom, bounds.top] # define the extent of the tif file</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="uOqIZnbazMr4KgbUAe3YU" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="OoByMqmDV8" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">lst_da_crs = lst_19_j.rio.write_crs(&quot;EPSG:4326&quot;, inplace=True) #coordinates are in degrees: use EPSG:4326.
lst_da_crs</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tBa-IW6BIDVp1gY_LnNMP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="PlgnM3rQ98" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#Matching Population density data grid to the LST grid
import rioxarray

# Load population density  as xarray DataArray
pop_da = rioxarray.open_rasterio(&quot;merged_population_NewZealand2015_density.tif&quot;, masked=True).squeeze()

# Regrid to LST dataset grid
pop_da_matched = pop_da.rio.reproject_match(lst_da_crs)

extent = [float(pop_da_matched.x.min()), float(pop_da_matched.x.max()),
          float(pop_da_matched.y.min()), float(pop_da_matched.y.max())]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0an4XCXtm7eav7vCmGAq3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="zJ1LFZ1QBE" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">pop_da_matched</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5E69qrpJ6_oFiFMO5uRpY" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="gCoEjWUcFi" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#Creating an xarray for population density
pop_dens= xr.DataArray(pop_da_matched, coords=lst_19_j.coords, dims=lst_19_j.dims)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="mG9j7kisIpg6-lQVundNt" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="PuUB81XnVZ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create side-by-side subplots
fig, axes = plt.subplots(ncols=2, figsize=(12, 6), subplot_kw={&quot;projection&quot;: ccrs.PlateCarree()})

# Plotting LST
plot_lst= lst_19_j.plot(ax=axes[0], cmap=&#x27;hot_r&#x27;, vmin=0, vmax=50, transform=ccrs.PlateCarree(),
                       cbar_kwargs={&#x27;label&#x27;: &#x27;Land Surface Temperature (¬∞C)&#x27;, &#x27;orientation&#x27;: &#x27;vertical&#x27;, &#x27;shrink&#x27;: 0.7})

# Add coastlines and borders
axes[0].add_feature(cfeature.COASTLINE, linewidth=1)
axes[0].add_feature(cfeature.BORDERS, linestyle=&#x27;:&#x27;)
# Set map extent (adjust as needed)
axes[0].set_extent(extent)
#cbar0.set_label(&#x27;LST Risk Level&#x27;, fontsize=10)
gl0 = axes[0].gridlines(draw_labels=True, linewidth=0.5, color=&#x27;gray&#x27;, alpha=0.7, linestyle=&#x27;--&#x27;)
gl0.top_labels = False
gl0.right_labels = False

axes[0].set_title(&#x27;Hazard: LST Levels - January 2019&#x27;, fontsize=12)
axes[0].set_xlabel(&#x27;Longitude [¬∞E]&#x27;)
axes[0].set_ylabel(&#x27;Latitude [¬∞N]&#x27;)

#Plotting population density
plot_pop= pop_dens.plot(ax=axes[1],cmap=&#x27;Reds&#x27;, vmin=0, vmax=10000,  transform=ccrs.PlateCarree(),  
                        cbar_kwargs={&#x27;label&#x27;: &#x27;Population Density (people/km¬≤)&#x27;, &#x27;orientation&#x27;: &#x27;vertical&#x27;, &#x27;shrink&#x27;: 0.7})
axes[1].add_feature(cfeature.COASTLINE, linewidth=1)
axes[1].add_feature(cfeature.BORDERS, linestyle=&#x27;:&#x27;)
axes[1].set_extent(extent)
# Add colorbar
gl1 = axes[1].gridlines( draw_labels=True, linewidth=0.5, color=&#x27;gray&#x27;, alpha=0.7, linestyle=&#x27;--&#x27;)
gl1.top_labels = False
gl1.right_labels = False

axes[1].set_title(&#x27;Exposure:  Population Density Levels - 2019&#x27;, fontsize=12)
axes[1].set_xlabel(&#x27;Longitude [¬∞E]&#x27;)
axes[1].set_ylabel(&#x27;Latitude [¬∞N]&#x27;)

plt.suptitle(&#x27;New Zealand 2019 Heatwave&#x27;, fontsize=14, y=0.97)
plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="lg9s4DqMBmnSZ9lvgaC9T" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/a4feb1f6f364764c36a63eff05c0122b.png" alt="&lt;Figure size 1200x600 with 4 Axes&gt;"/></div></div><div id="NwYzyWL2ce" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#Reclassifying LST and population density for risk maps</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="cQNlB0hcuj0hIZOTXoR7A" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="lXySnwCTE1" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Define classes for grouping LST data
#low : , medium: , high: 
#LST levels 

#very low &lt; 20 value 1 
#low &lt; 20-30¬∞C value 2 
#Medium 30-35 ¬∞C value 3 
#High &lt;35¬∞ - 40¬∞C value 4  
#Very High 40‚Äì50	5
#Extreme &gt;50¬∞  value 6
lst_bins   = [20, 30, 35, 40, 50]
lst_values = [1, 2, 3, 4, 5]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9DoaNqq_WZOEoYFRIx9g8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Jspxvi1X5T" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Function to reclassify data to match each value ranges to a level of risk
def reclassify_with_numpy_ge(array, bins, new_values):
    reclassified_array = np.zeros_like(array)
    reclassified_array[array &lt; bins[0]] = new_values[0]  # below first bin
    for i in range(len(bins) - 1):
        reclassified_array[(array &gt;= bins[i]) &amp; (array &lt; bins[i + 1])] = new_values[i]
    reclassified_array[array &gt;= bins[-1]] = new_values[-1]  # above last bin
    return reclassified_array</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="62CwruFrgusKrAKa71cL-" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="q9EM8EnG2i" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Apply the reclassification function
lst_class = reclassify_with_numpy_ge(lst_19_j.values, bins=lst_bins, new_values=lst_values)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-c8HY7gnoaX9fGGkOwtmy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="EIbTuSIQ7U" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Convert the reclassified array back to xarray DataArray for plotting
lst_class_da = xr.DataArray(lst_class, coords=lst_19_j.coords, dims=lst_19_j.dims)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="w9yLyBz06oEDjIwXsL2i8" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="kpCmbOkMEA" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cmap = plt.get_cmap(&#x27;YlOrRd&#x27;, 5) 


fig, ax = plt.subplots(figsize=(8,6), subplot_kw={&quot;projection&quot;: ccrs.PlateCarree()})

# Plot the data
plot_lst= lst_class_da.plot(ax=ax, cmap=cmap, vmin=1, vmax=5, transform=ccrs.PlateCarree() , add_colorbar=False)

# Add New Zealand coastlines
ax.add_feature(cfeature.COASTLINE, linewidth=1)
ax.add_feature(cfeature.BORDERS, linestyle=&#x27;:&#x27;)
ax.set_ylim(lat_min,lat_max)
ax.set_xlim(lon_min,lon_max)

# Colorbar
cbar = fig.colorbar(plot_lst, ticks=[1.25, 3., 4.25])
cbar.ax.set_yticklabels([&#x27;Low&#x27;, &#x27;Medium&#x27;, &#x27;Very High&#x27;], size=10)

#very low &lt; 20 value 1 
#low &lt; 20-30¬∞C value 2 
#Medium 30-40 ¬∞C value 3 
#High &lt;40¬∞ - 50¬∞C value 4  
#Very High 50‚Äì55	5
#Extreme &gt;55¬∞  value 6

# Add gridlines with labels
grid = ax.gridlines(draw_labels=True, crs=ccrs.PlateCarree(), linewidth=0.5, color=&#x27;gray&#x27;, alpha=0.7, linestyle=&#x27;--&#x27;)
grid.top_labels = False
grid.right_labels = False

ax.set_xlabel(&#x27;lon [deg_east]&#x27;)
ax.set_ylabel(&#x27;lat [deg_north]&#x27;)
plt.title(&#x27;LST Levels during January 2019&#x27;, size=12)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="cg1FdhrXxXcVSH6JAs7px" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/fc3529ebe7d352271c45f058fb85f816.png" alt="&lt;Figure size 800x600 with 2 Axes&gt;"/></div></div><div id="FS2aVOjvVF" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#Reclassifying Population Density for risk maps</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FBa4IsnhYSfP2eqQ_gJU4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="npwxUgg1ZX" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#defining level ranges for population density 
pop_bins = [0, 50, 100, 1000, 10000]  # Effect on the human health
pop_values = [1, 2, 3, 4, 5]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-QnwZDiqFvAdCaCDahzgr" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="jLK2dlMIIm" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Apply the reclassification function
pop_class = reclassify_with_numpy_ge(pop_da_matched, bins=pop_bins, new_values=pop_values)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Ay9ZYvLj2FaUCBofUNPBL" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="UWzQCqx7tt" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#Creating an xarray for population density classified
pop_class_da = xr.DataArray(pop_class, coords=lst_19_j.coords, dims=lst_19_j.dims)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Ft1RIPGcLXkUPvQMTHwD2" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="uU2rXlPrWo" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cmap = plt.get_cmap(&#x27;YlOrBr&#x27;, 5) 
fig, ax = plt.subplots(figsize=(8,6), subplot_kw={&quot;projection&quot;: ccrs.PlateCarree()})
plot_pop= pop_class_da.plot(ax=ax, cmap=cmap, vmin=1, vmax=5, transform=ccrs.PlateCarree(),  add_colorbar=False,)

cbar = fig.colorbar(plot_pop, ticks=[1.25, 3., 4.25])
cbar.ax.set_yticklabels([&#x27;Low&#x27;, &#x27;Medium&#x27;, &#x27;Very High&#x27;], size=10)

# Add New Zealand coastlines
ax.add_feature(cfeature.COASTLINE, linewidth=1)
ax.add_feature(cfeature.BORDERS, linestyle=&#x27;:&#x27;)
ax.set_ylim(lat_min,lat_max)
ax.set_xlim(lon_min,lon_max)

# Add gridlines with labels
grid = ax.gridlines(draw_labels=True, crs=ccrs.PlateCarree(), linewidth=0.5, color=&#x27;gray&#x27;, alpha=0.7, linestyle=&#x27;--&#x27;)
grid.top_labels = False
grid.right_labels = False

plt.title(&quot;Population Density&quot;)
plt.tight_layout()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bdpk326FNJgqR1v3rzSZr" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/fde479484cdc741d59ab0d30974b6a98.png" alt="&lt;Figure size 800x600 with 2 Axes&gt;"/></div></div><div id="uzHyM5Dysr" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#Risk exposure to heat
risk_map = lst_class_da + pop_class
risk_map</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="1BZc95-zIH8TBvYaohfDo" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="ACNq7mniYN" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#Now let&#x27;s plot the risk exposure map showing where high heat coincides with high pop exposure
#Risk=LST¬†Level+Population¬†Density¬†Level
fig, ax = plt.subplots(figsize=(8, 6), subplot_kw={&quot;projection&quot;: ccrs.PlateCarree()})
risk_plot= risk_map.plot(ax=ax, vmin=0, vmax=10, cmap=cmap,  add_colorbar=False, transform=ccrs.PlateCarree())

cbar = fig.colorbar(risk_plot, ticks=[2, 5,  10], pad=0.09, shrink=0.8, fraction=0.03) #pad: reduce space between plot/colorbar
cbar.ax.set_yticklabels([ &#x27;Low&#x27;, &#x27;Medium&#x27;, &#x27;Very high&#x27;], size=10)
ax.set_title(&#x27;Heatwave Risk Exposure Map (Jan 2019)&#x27;)
ax.add_feature(cfeature.COASTLINE, linewidth=1)
ax.add_feature(cfeature.BORDERS, linestyle=&#x27;:&#x27;)
ax.set_extent(extent)
#PLot around Christchurch only:
#ax.set_extent([172.3, 173.8, -44, -43.2], crs=ccrs.PlateCarree())
ax.gridlines(draw_labels=True, linewidth=0.3, color=&#x27;gray&#x27;, alpha=0.5, linestyle=&#x27;--&#x27;)

plt.tight_layout()

plt.savefig(&#x27;risk_map.png&#x27;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="5bkffvh0SAM81z_Q7b92F" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/3a9ae3650431238f712acada62ed7e95.png" alt="&lt;Figure size 800x600 with 2 Axes&gt;"/></div></div><div id="DK8EZVgan5" class="relative group/block"><p>Zoom into Christchurch:</p></div><div id="KmoSn46HRu" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#Now let&#x27;s plot the risk exposure map showing where high heat coincides with high pop exposure
fig, ax = plt.subplots(figsize=(8, 6), subplot_kw={&quot;projection&quot;: ccrs.PlateCarree()})
risk_plot= risk_map.plot(ax=ax, vmin=0, vmax=10, cmap=cmap,  add_colorbar=False, transform=ccrs.PlateCarree())

cbar = fig.colorbar(risk_plot, ticks=[2, 5,  10], pad=0.09, shrink=0.8, fraction=0.03) #pad: reduce space between plot/colorbar
cbar.ax.set_yticklabels([ &#x27;Low&#x27;, &#x27;Medium&#x27;, &#x27;Very high&#x27;], size=10)
ax.set_title(&#x27;Heatwave Risk Exposure Map (Jan 2019)&#x27;)
ax.add_feature(cfeature.COASTLINE, linewidth=1)
ax.add_feature(cfeature.BORDERS, linestyle=&#x27;:&#x27;)
#ax.set_extent(extent)
#PLot around Christchurch only:
ax.set_extent([172.3, 173.8, -44, -43.2], crs=ccrs.PlateCarree())
ax.gridlines(draw_labels=True, linewidth=0.3, color=&#x27;gray&#x27;, alpha=0.5, linestyle=&#x27;--&#x27;)

plt.tight_layout()

plt.savefig(&#x27;risk_map_Christchurch.png&#x27;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="kjxO7ZLLZa5OQSAZgOADZ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/d457e6d584a759c646d9f3ecb3963a34.png" alt="&lt;Figure size 800x600 with 2 Axes&gt;"/></div></div><div id="Na4d16FtO9" class="relative group/block"><h3 id="id-how-to-save-the-dataset" class="relative group"><span class="heading-text"><span class="" style="color:blue">‚Üí How to save the dataset</span></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-how-to-save-the-dataset" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h3><p>We created a datarray file regridded on the LST grid from the population TIF dataset.
You can also save this dataset in your folder either as NetCDF or Zarr file like this:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-text" style="white-space:pre"># For NetCDF
pop_dens.to_netcdf(&quot;population_density_2020.nc&quot;)

# For Zarr
pop_dens.to_zarr(&quot;population_density_2020.zarr&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>‚Üí see next cell, where you can uncomment the command.</p><p><span class="" style="color:blue"><strong>PLEASE NOTE</strong> : The data is very large, please ensure you have enough space to save it.</span></p></div><div id="iIGkBxNexJ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># For NetCDF
#pop_dens.to_netcdf(&quot;population_density_2020.nc&quot;)

# For Zarr
#pop_dens.to_zarr(&quot;population_density_2020.zarr&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="zRXeRjyTiNFWEE5r8GFEJ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="o6ZNZYLpSn" class="relative group/block"><p>Let‚Äôs plot the time series of LST over Christchurch</p></div><div id="AvRnOBYD27" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#LST over CHristchurch
lat_min = -44
lat_max = -43.2
lon_min = 172.3
lon_max = 173.8
bbox = (lon_min, lat_min, lon_max, lat_max) 
subset_spatial_op = get_op(&#x27;subset_spatial&#x27;)
lst_ds_C = subset_spatial_op(ds=lst_ds, region=bbox)
lst_ds_C</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="y-XBRvyaUGh9JXedSh-oA" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="LObvIdGSmk" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#average LST around Christchurch area
lst_ds_C_mean=lst_ds_C.lst.mean(dim=(&#x27;lat&#x27;,&#x27;lon&#x27;))</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="dBbEpCpzVn3uO7dKP2jRQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="GnNp7INHe8" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">lst_ds_C_mean</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="0rrW9ESRDBh5zAVAdv0Wg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="MiQnVomga0" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">fig = plt.figure(figsize=(12,3))
# Define the axes
ax = fig.add_subplot(1,1,1) 

# plot the yearly mean
lst_ds_C_mean.plot(c=&#x27;crimson&#x27;,linewidth=1,label=&#x27;daily&#x27;,marker=&#x27;.&#x27;)

# add the labels for the axes and the title and the legend
plt.legend()
plt.grid()
plt.ylabel(&#x27;LST (¬∞C)&#x27;)
plt.xlabel(&#x27;Year&#x27;)
plt.title(&quot;Time series of the yearly LST mean around Christchurch (1995-2020)&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="tYB17s68jNk6Rt7M59NCT" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/65b501169713198347dc389cc0a8e4fd.png" alt="&lt;Figure size 1200x300 with 1 Axes&gt;"/></div></div><div id="JGTdkiJAAd" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">lst_ds_C_mean</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="3LHSKhFLoA9zY9VABNByl" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="OrOcXcMnB9" class="relative group/block"><h3 id="id-how-to-save-the-time-series-as-csv" class="relative group"><span class="heading-text"><span class="" style="color:blue">‚Üí How to save the time series as csv</span></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-how-to-save-the-time-series-as-csv" title="Link to this Section" aria-label="Link to this Section">¬∂</a></h3><p>You can save the time series as <strong>csv</strong> file like this:</p><p><code>lst_ds_C_mean.to_dataframe(name=&quot;lst&quot;).to_csv(&quot;lst_timeseries.csv&quot;)</code></p><p>‚Üí see next cell, where you can uncomment the command</p></div><div id="OpE76OrMHB" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">lst_ds_C_mean.to_dataframe(name=&quot;lst&quot;).to_csv(&quot;lst_timeseries.csv&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NDiB2-dr4TnzutRMCq9TE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div></div></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/cci-notebook-viewers/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-XWET6RJ7.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/root-ZJOPFBMV.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-NFM2H3KQ.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/routes/$-CQPS5IOR.js"/><script>window.__remixContext = {"url":"/external-notebooks/esa-cci/ect-training/adaptation-futures-nz-10-2025/adaptation-futures-climate-risk-exposure-10-2025","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.0","options":{"hide_toc":true,"hide_footer_links":true,"folders":true},"nav":[],"actions":[],"projects":[{"subject":"CCI Examples","title":"CCI Examples","description":"Collection of examples relevant to the CCI activity","github":"https://github.com/esa-cci/cci-notebook-viewers","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Esa Cci","level":2},{"title":"Cci Notebooks","level":3},{"slug":"external-notebooks.esa-cci.cci-notebooks.readme","title":"cci-notebooks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebooks","level":4},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.aerosol-cci","title":"Getting Started with Aerosol CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.biomass-cci","title":"Getting Started with Biomass CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.cloud-cci","title":"Getting Started with Cloud CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.fire-cci","title":"Getting Started with Fire CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ghg-cci","title":"Getting Started with Greenhouse Gases CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.icesheets-cci","title":"Getting Started with Ice Sheets CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lakes-cci","title":"Getting Started with Lakes CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.landcover-cci","title":"Getting Started with Land Cover CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lst-cci","title":"Getting Started with Land Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.oceancolour-cci","title":"Getting Started with Ocean Colour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ozone-cci","title":"Getting Started with Ozone CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.permafrost-cci","title":"Getting Started with Permafrost CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.seaice-cci","title":"Getting Started with Sea Ice CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sealevel-cci","title":"Getting Started with Sea Level CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.snow-cci","title":"Getting Started with Snow CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.soilmoisture-cci","title":"Getting Started with Soil Moisture CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sss-cci","title":"Getting Started with Sea Surface Salinity CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sst-cci","title":"Getting Started with Sea Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.vegetation-cci","title":"Getting Started with Vegetation CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.watervapour-cci","title":"Getting Started with Water Vapour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Ect Training","level":3},{"slug":"external-notebooks.esa-cci.ect-training.readme","title":"ect-training","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Adaptation Futures NZ 10 2025","level":4},{"slug":"external-notebooks.esa-cci.ect-training.adaptation-futures-nz-10-2025.adaptation-futures-climate-risk-exposure-10-2025","title":"Step 1. Setup \u0026 Imports","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.adaptation-futures-nz-10-2025.readme","title":"README","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"ESA Climate Change Competition","level":4},{"slug":"external-notebooks.esa-cci.ect-training.esa-climate-change-competition.competition-forests-in-a-changing-climate","title":"Explore forests in a changing climate with the ESA CCI datasets","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lps Vienna 06 2025","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-beginner","title":"Step 1. Setup \u0026 Imports","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-cloud-uncertainties","title":"1. Import Necessary Packages","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-intermediate-level-elnino","title":"Questions We Aim to Explore","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lst Leicester 12 2024","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lst-leicester-12-2024.lst-training","title":"Analyzing Land Surface Temperature and Uncertainties: Insights from ESA CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/cci-notebook-viewers"},"routes/$":{"config":{"version":2,"myst":"1.6.0","options":{"hide_toc":true,"hide_footer_links":true,"folders":true},"nav":[],"actions":[],"projects":[{"subject":"CCI Examples","title":"CCI Examples","description":"Collection of examples relevant to the CCI activity","github":"https://github.com/esa-cci/cci-notebook-viewers","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Esa Cci","level":2},{"title":"Cci Notebooks","level":3},{"slug":"external-notebooks.esa-cci.cci-notebooks.readme","title":"cci-notebooks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebooks","level":4},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.aerosol-cci","title":"Getting Started with Aerosol CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.biomass-cci","title":"Getting Started with Biomass CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.cloud-cci","title":"Getting Started with Cloud CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.fire-cci","title":"Getting Started with Fire CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ghg-cci","title":"Getting Started with Greenhouse Gases CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.icesheets-cci","title":"Getting Started with Ice Sheets CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lakes-cci","title":"Getting Started with Lakes CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.landcover-cci","title":"Getting Started with Land Cover CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lst-cci","title":"Getting Started with Land Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.oceancolour-cci","title":"Getting Started with Ocean Colour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ozone-cci","title":"Getting Started with Ozone CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.permafrost-cci","title":"Getting Started with Permafrost CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.seaice-cci","title":"Getting Started with Sea Ice CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sealevel-cci","title":"Getting Started with Sea Level CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.snow-cci","title":"Getting Started with Snow CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.soilmoisture-cci","title":"Getting Started with Soil Moisture CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sss-cci","title":"Getting Started with Sea Surface Salinity CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sst-cci","title":"Getting Started with Sea Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.vegetation-cci","title":"Getting Started with Vegetation CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.watervapour-cci","title":"Getting Started with Water Vapour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Ect Training","level":3},{"slug":"external-notebooks.esa-cci.ect-training.readme","title":"ect-training","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Adaptation Futures NZ 10 2025","level":4},{"slug":"external-notebooks.esa-cci.ect-training.adaptation-futures-nz-10-2025.adaptation-futures-climate-risk-exposure-10-2025","title":"Step 1. Setup \u0026 Imports","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.adaptation-futures-nz-10-2025.readme","title":"README","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"ESA Climate Change Competition","level":4},{"slug":"external-notebooks.esa-cci.ect-training.esa-climate-change-competition.competition-forests-in-a-changing-climate","title":"Explore forests in a changing climate with the ESA CCI datasets","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lps Vienna 06 2025","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-beginner","title":"Step 1. Setup \u0026 Imports","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-cloud-uncertainties","title":"1. Import Necessary Packages","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-intermediate-level-elnino","title":"Questions We Aim to Explore","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lst Leicester 12 2024","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lst-leicester-12-2024.lst-training","title":"Analyzing Land Surface Temperature and Uncertainties: Insights from ESA CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5}]}]},"page":{"version":2,"kind":"Notebook","sha256":"c9df204af21e0c19a99803a612715e570c184373825ec218f8dbf9e9f60c61d7","slug":"external-notebooks.esa-cci.ect-training.adaptation-futures-nz-10-2025.adaptation-futures-climate-risk-exposure-10-2025","location":"/external_notebooks/esa-cci/ect-training/adaptation-futures_NZ_10_2025/Adaptation-Futures_Climate-Risk-Exposure_10_2025.ipynb","dependencies":[],"frontmatter":{"title":"Step 1. Setup \u0026 Imports","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"github":"https://github.com/esa-cci/cci-notebook-viewers","subject":"CCI Examples","numbering":{"title":{"offset":4}},"edit_url":"https://github.com/esa-cci/cci-notebook-viewers/blob/main/external_notebooks/esa-cci/ect-training/adaptation-futures_NZ_10_2025/Adaptation-Futures_Climate-Risk-Exposure_10_2025.ipynb","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","exports":[{"format":"ipynb","filename":"Adaptation-Futures_Climate-Risk-Exposure_10_2025.ipynb","url":"/cci-notebook-viewers/build/Adaptation-Futures_C-b13d63f29121eccbac53c07b863494e2.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"textAlign":"center"},"children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"Adaptation Futures Conference (AF2025) Training - Illustrating Climate Risk Exposure with CCI Data","key":"SFpHt3LMQA"}],"identifier":"adaptation-futures-conference-af2025-training-illustrating-climate-risk-exposure-with-cci-data","label":"Adaptation Futures Conference (AF2025) Training - Illustrating Climate Risk Exposure with CCI Data","html_id":"adaptation-futures-conference-af2025-training-illustrating-climate-risk-exposure-with-cci-data","implicit":true,"key":"SE3MmoqoeU"}],"key":"oh8Nyfhkc4"},{"type":"paragraph","children":[{"type":"text","value":"#Adaptation Futures Conference (AF2025) Training - Illustrating Climate Risk Exposure with CCI Data","key":"ZFLQ1JtJa7"}],"key":"eZmxpES09Y"}],"key":"zCMRyN6jpa"},{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","alt":"cci_logo.png","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DcsspLsdx0","urlSource":"data:image/png;base64,iVBORw0KGg...ORK5CYII=\n"}],"key":"EVO69vQYeU"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[{"type":"heading","depth":2,"children":[{"type":"text","value":"1. Introduction:","key":"jcmuaYccVb"}],"identifier":"id-1-introduction","label":"1. Introduction:","html_id":"id-1-introduction","implicit":true,"key":"pf62jctkna"},{"type":"paragraph","children":[{"type":"text","value":"In this beginner-friendly notebook, we will use real satellite-based Essential Climate Variables (ECVs) data from the ","key":"hVX5Q8vfD9"},{"type":"link","url":"https://climate.esa.int/en/odp/#/dashboard","children":[{"type":"text","value":"ESA Climate Change Initiative (CCI)","key":"AJkunnDerv"}],"urlSource":"https://climate.esa.int/en/odp/#/dashboard","key":"HRbh4GPgT4"},{"type":"text","value":" to explore recent climate trends. We will also look at how to combine population dataset with ECVs to have a first-order estimation of risk exposure caused by extreme weather events.","key":"a1auD9uNvm"}],"key":"Ne154WhPbL"},{"type":"paragraph","children":[{"type":"text","value":"This notebook is designed for ","key":"BDsLxsPB2n"},{"type":"strong","children":[{"type":"text","value":"participants with no prior experience in Python or climate data analysis","key":"rSyYlszwuf"}],"key":"EgRsnO8JxD"},{"type":"text","value":". You will learn:","key":"XA5WLJzDZm"}],"key":"M6c2FQbW4f"},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"How to access CCI ECVs using the CCI Toolbox python Package","key":"r8No70f9ZX"}],"key":"QDf8eHeS0e"}],"key":"JOo8lzCm4n"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"How to navigate and subset climate data using Xarray","key":"tTksGEkbWk"}],"key":"vn9Bicofsv"}],"key":"IcWcdYwm0b"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"How to compute basic plots using Matplotlib","key":"jfSp5S8ktX"}],"key":"HPsGxGIaaY"}],"key":"R7Lr9L7GjZ"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"How to save a figure you generated","key":"XHBQxbPXOX"}],"key":"PxHRbEy6kG"}],"key":"tMQEvGOZba"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"How to map and interpret ECVs changes over time and space","key":"XCQmfaKvyu"}],"key":"r73RK5YVDe"}],"key":"oqeC6Mb9az"}],"key":"kJGf2wmnoC"}],"key":"aJ4ZoAcSWK"}],"key":"sLcYdJkYOH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 1. Setup \u0026 Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZBs4sEuM0v"}],"identifier":"step-1-setup-imports","label":"Step 1. Setup \u0026 Imports","html_id":"step-1-setup-imports","implicit":true,"key":"xK0T6RfTqr"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Before we start working with the data, we need to import a few Python libraries. These libraries provide useful tools for working with satellite data, performing simple calculations, and creating visualizations.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Sib6BCitk2"}],"key":"JYU5PiSXZW"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Don‚Äôt worry if you‚Äôre not familiar with these yet ‚Äî we will explain what you need as we go.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"E2OAK3xn3n"}],"key":"EeaBF34aWu"}],"key":"yFNSuNgwNk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# ESA Climate Toolbox imports for accessing and plotting ESA CCI data\nfrom esa_climate_toolbox.core import get_op              # Get predefined operations (e.g., time series, averages)\nfrom esa_climate_toolbox.core import list_ecv_datasets   # List available datasets per ECV (Essential Climate Variable)\nfrom esa_climate_toolbox.core import get_store           # Connect to an ESA data store\nfrom esa_climate_toolbox.core import list_datasets       # List all datasets in a store\nfrom esa_climate_toolbox.core import search\nfrom esa_climate_toolbox.ops import plot                 # High-level plotting functions for CCI data\n\n# Used for connecting to remote data sources (e.g., ESA CCI ODP)\nfrom xcube.core.store import new_data_store\n\n# For displaying geographic regions interactively (if desired)\nfrom IPython.display import GeoJSON\nimport shapely.geometry   # Handling geometric objects like bounding boxes\n\n# Core data science libraries\nimport pandas as pd       # For tabular data handling and time manipulation\nimport numpy as np        # For numerical operations\nimport xarray as xr       # For multi-dimensional climate data structures\n\n# Mapping and plotting\nimport matplotlib.pyplot as plt       # Plotting library\nfrom matplotlib.colors import TwoSlopeNorm\nimport cartopy.crs as ccrs            # Cartographic projections for spatial data\nimport cartopy.feature as cfeature\nimport rasterio                       # Used to read GeoTIFF files\n\n# Notebook settings\nimport warnings\nwarnings.filterwarnings(\"ignore\") # Suppressing warnings to keep notebook output clean\n%matplotlib inline","key":"vaTZTGbZ16"},{"type":"output","id":"_wGTT9tj3RD4pkJFZbTix","data":[],"key":"W7pC7rAlJJ"}],"key":"Is8lrSyMOd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Why we need those Python packages:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AvhpLQmwi6"}],"key":"ggjLnV4e3i"}],"identifier":"why-we-need-those-python-packages","label":"Why we need those Python packages:","html_id":"why-we-need-those-python-packages","implicit":true,"key":"ZATQLUIJRm"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"numpy","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DnPskz8KxU"},{"type":"text","value":": helps with numbers and arrays.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ew0UA7OkG7"}],"key":"L3rZ00gX1X"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bEdYiibijQ"},{"type":"text","value":": lets us create plots and maps.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"T6A5q5Xes5"}],"key":"W6b2BQYLFU"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"xarray","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"E6MItBO3ew"},{"type":"text","value":": makes it easy to work with climate datasets.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QovDGQextg"}],"key":"oXwQIOXaNA"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"inlineCode","value":"cartopy","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Qe6g6bynxc"},{"type":"text","value":": helps plot maps with geographic context.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"X0zQQX8CjO"}],"key":"yR9DRPDOuc"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"inlineCode","value":"Toolbox","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"s91iXuTq9H"},{"type":"text","value":": a package that facilitates access and computation of CCI data","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Vi05PUHWAJ"}],"key":"fxcYn4rJDn"}],"key":"GCC2GLrLdW"},{"type":"heading","depth":5,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Up next:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"MDCXu0vhXh"}],"key":"pNFpDTMA43"}],"key":"aYiFiyNLba"},{"type":"text","value":" We will learn how to ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"q8t0Czd4Wn"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"access ECVs","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"j3cEQxUnrG"}],"key":"Jf5Nh4qV3r"},{"type":"text","value":" from the CCI Toolbox.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"GxHmzQQN9j"}],"identifier":"up-next-we-will-learn-how-to-access-ecvs-from-the-cci-toolbox","label":"Up next: We will learn how to access ECVs from the CCI Toolbox.","html_id":"up-next-we-will-learn-how-to-access-ecvs-from-the-cci-toolbox","implicit":true,"key":"JDJAKe6bux"}],"key":"H46AfP49dX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#list_datasets(\"esa-cci-zarr\")","key":"WYUn41jwvY"},{"type":"output","id":"-c55YeAeMrVb6XzfIU7pe","data":[],"key":"e8jPoI9LPt"}],"key":"UQO5J3NbjY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 2: Load \u0026 Visualize Land Surface Temperature data (LST)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fRK3hBpkJS"}],"identifier":"step-2-load-visualize-land-surface-temperature-data-lst","label":"Step 2: Load \u0026 Visualize Land Surface Temperature data (LST)","html_id":"step-2-load-visualize-land-surface-temperature-data-lst","implicit":true,"key":"XOyy6FflX5"},{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Define the Dataset ID","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"caXirkp824"}],"identifier":"define-the-dataset-id","label":"Define the Dataset ID","html_id":"define-the-dataset-id","implicit":true,"key":"LAiUqTCh5C"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"To work with a specific ESA CCI dataset, we need to specify its ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"B0LmrTbl8z"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"dataset ID","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MdZvGVqeDB"}],"key":"nG3nc8QGsV"},{"type":"text","value":". This unique identifier tells the toolbox which variable and product we want to access.\nWhen using the command ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sZ2A975eIw"},{"type":"inlineCode","value":"list_ecv_datasets","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"W9yNK1CLgn"},{"type":"text","value":", you can see all available datasets for the chosen parameter (in this case ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bDpTLI6SFi"},{"type":"inlineCode","value":"\"LST\"","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Z4c7rlRwcB"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bkSOGan5WQ"}],"key":"pqbpZhxviO"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"First, we define the dataset ID and the store from which we retrieve the data (for the LST file it is ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"vURS5yf0SS"},{"type":"inlineCode","value":"esa-cci","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"EFMxQk42wP"},{"type":"text","value":").\nIn this section, we are using ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"DjPrlGbUXi"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"land surface temperature (LST)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"r8B9kbXRKA"}],"key":"G2dZzsG87k"},{"type":"text","value":" data from the esa-cci-zarr store. You can find the variables of the products under ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"YD9CWRJOXI"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"data_vars","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"pE5ULRXiwP"}],"key":"E5cNIp95AN"},{"type":"text","value":". For the LST, we will use the variable ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"BodgHGtjaN"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"lst","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"oqZrn6L1oG"}],"key":"YaxKJNnZJA"},{"type":"text","value":".","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"VeMANrhMVV"}],"key":"oL9tej6D1y"}],"key":"zhXLt6nVUA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Uncomment (-\u003e remove the \"# \") the next line, if you wish to see all available datafiles for the LST\n#list_ecv_datasets(\"LST\")","key":"mdgT2q8FLg"},{"type":"output","id":"bVjCdxKMhSWkWVjOCPQrN","data":[],"key":"iMDqsT2IFZ"}],"key":"haxJU0lxaE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Open the ESA CCI store\ncci_store = new_data_store(\"esa-cci-zarr\")\n# define the dataset ID\ndata_id = 'ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_DAY-1995-2020-fv3.00.zarr'","key":"jAS5hGuXLp"},{"type":"output","id":"VGQ2lF8e2ml8fS8yntpAq","data":[],"key":"vNCun1Dzu2"}],"key":"b3YurSIltt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Describe Dataset (Check Available Variables and Metadata)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r6vpG4CByd"}],"identifier":"describe-dataset-check-available-variables-and-metadata","label":"Describe Dataset (Check Available Variables and Metadata)","html_id":"describe-dataset-check-available-variables-and-metadata","implicit":true,"key":"FowxFjX2Fl"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Before loading the full dataset, it‚Äôs helpful to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cfD8DP33bv"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"inspect the metadata","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZuFBSQ72II"}],"key":"NbKEwUCJk9"},{"type":"text","value":" to understand its structure by using the command ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wTztlI6E2e"},{"type":"inlineCode","value":"describe_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gLl0gKO4MX"},{"type":"text","value":". This includes:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AVLZ5sTXnJ"}],"key":"Hy10ZTXypd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Available variables (e.g., lst, uncertainty estimates)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XtkLwHvee6"}],"key":"p9t4uV94TZ"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Temporal and spatial coverage","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"NDv9Nps0vE"}],"key":"aP8jTT2p9i"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Data format and structure","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yRM40K4cCy"}],"key":"wIcVDgzUI4"}],"key":"xHJ3a3BnxS"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"This step ensures we know what the dataset contains and how to work with it. It also helps confirm that the variable we want to plot or analyze is actually included.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"tG8hjnVyME"}],"key":"ec29fqrTk4"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"üõ†Ô∏è Tip: You can use the description to verify variable names, dimensions (e.g., ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ijlEiazYbd"},{"type":"inlineCode","value":"lat","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Z16INIQX48"},{"type":"text","value":", ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"BhNtzDZEbx"},{"type":"inlineCode","value":"lon","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"PUTExQ0GgW"},{"type":"text","value":", ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"zXD6nnVxQJ"},{"type":"inlineCode","value":"time","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"oyfAlKt9mk"},{"type":"text","value":"), and time coverage. Under ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"tEjwMjzwWh"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"data_vars","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"mZweHwC2bE"}],"key":"sfUOpXHkay"},{"type":"text","value":" you can find the data variables and the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"TpgWP76NnA"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"attrs","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ShlipUERdg"}],"key":"GMK5pcizgx"},{"type":"text","value":" within the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"PxOPzUGzeq"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"data_vars","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"kQK8C1P0d4"}],"key":"JHQ74Mlndp"},{"type":"text","value":" section show you the data attributes, e.g. the long name of the variable or the unit.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"epU7KfDNPG"}],"key":"qMNdn6Q2pP"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"üìò More on dataset structure:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"P4sFSgyciK"},{"type":"break","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"jXySJJeblw"},{"type":"text","value":"üîó ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"uUEqzvkFYb"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#accessing-data","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"ESA Climate Toolbox ‚Äì Data Access","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"HpYbvA3H5e"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#accessing-data","key":"TRuunEuTw6"}],"key":"u1u5zlnKMH"}],"key":"A4GX2nwQKM"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"# Inspect the data structure\ncci_store.describe_data(data_id)","key":"KdCK68apRL"},{"type":"output","id":"EKNGnsRiMFXRqKCOKm66L","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"application/json":{"content":"{\"attrs\":{\"Conventions\":\"CF-1.8\",\"catalogue_url\":\"https://catalogue.ceda.ac.uk/uuid/6babb8d9a8d247bcb3da6aed42f4b59a\",\"cdm_data_type\":\"grid\",\"comment\":\"These data were produced as part of the ESA LST CCI project.\",\"creator_email\":\"djg20@le.ac.uk\",\"creator_name\":\"University of Leicester Surface Temperature Group\",\"creator_url\":\"https://climate.esa.int/en/projects/land-surface-temperature\",\"date_created\":\"20220616T135239Z\",\"doi\":\"10.5285/785ef9d3965442669bff899540747e28\",\"format_version\":\"CCI Data Standards v2.2\",\"geospatial_lat_max\":89.99498748779297,\"geospatial_lat_min\":-89.99500274658203,\"geospatial_lat_resolution\":0.009999999776482582,\"geospatial_lat_units\":\"degrees_north\",\"geospatial_lon_max\":179.9949951171875,\"geospatial_lon_min\":-179.9949951171875,\"geospatial_lon_resolution\":0.009999999776482582,\"geospatial_lon_units\":\"degrees_east\",\"geospatial_vertical_max\":0,\"geospatial_vertical_min\":0,\"history\":\"Created using software developed at University of Leicester\",\"id\":\"ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_DAY-20201201000000-fv2.00.nc\",\"institution\":\"University of Leicester\",\"key_variables\":\"land_surface_temperature\",\"keywords\":\"Earth Science; Land Surface; Land Temperature; Land Surface Temperature\",\"keywords_vocabulary\":\"NASA Global change Master Directory (GCMD) Science Keywords\",\"license\":\"ESA CCI Data Policy: free and open access\",\"naming_authority\":\"le.ac.uk\",\"platform\":\"Sentinel-3A\",\"product_version\":\"2.00\",\"project\":\"Climate Change Initiative - European Space Agency\",\"references\":\"https://climate.esa.int/en/projects/land-surface-temperature\",\"sensor\":\"SLSTRA\",\"source\":\"ESA LST CCI IRCDR L3S V2.00\",\"spatial_resolution\":\"0.01 degree\",\"standard_name_vocabulary\":\"CF Standard Name Table v71\",\"summary\":\"This file contains level L3S global land surface temperatures from SLSTRA. L3S data are derived from more than one sensor combined on a space and/or time grid.\",\"time_coverage_duration\":\"P1M\",\"time_coverage_end\":\"19700101T000001Z\",\"time_coverage_resolution\":\"P1M\",\"time_coverage_start\":\"19700101T000001Z\",\"title\":\"ESA LST CCI land surface temperature time series from multiple IR sensors on LEO platforms.\"},\"bbox\":[-179.99999511705187,-90.00000274631076,179.99999511705187,89.9999874875217],\"coords\":{\"channel\":{\"attrs\":{\"long_name\":\"channel wavelength in microns\",\"units\":\"microns\",\"valid_max\":15000,\"valid_min\":0},\"dims\":[\"channel\"],\"dtype\":\"float64\",\"name\":\"channel\"},\"lat\":{\"attrs\":{\"long_name\":\"latitude_coordinates\",\"reference_datum\":\"geographical coordinates, WGS84 projection\",\"standard_name\":\"latitude\",\"units\":\"degrees_north\",\"valid_max\":90,\"valid_min\":-90},\"dims\":[\"lat\"],\"dtype\":\"float32\",\"name\":\"lat\"},\"lon\":{\"attrs\":{\"long_name\":\"longitude_coordinates\",\"reference_datum\":\"geographical coordinates, WGS84 projection\",\"standard_name\":\"longitude\",\"units\":\"degrees_east\",\"valid_max\":180,\"valid_min\":-180},\"dims\":[\"lon\"],\"dtype\":\"float32\",\"name\":\"lon\"},\"time\":{\"attrs\":{\"long_name\":\"reference time of file\",\"standard_name\":\"time\"},\"dims\":[\"time\"],\"dtype\":\"datetime64[ns]\",\"name\":\"time\"}},\"data_id\":\"ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_DAY-1995-2020-fv3.00.zarr\",\"data_type\":\"dataset\",\"data_vars\":{\"dtime\":{\"attrs\":{\"long_name\":\"time difference from reference time\",\"valid_max\":2678400,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"timedelta64[ns]\",\"name\":\"dtime\"},\"lcc\":{\"attrs\":{\"flag_meanings\":\"cropland_rainfed cropland_rainfed_herbaceous_cover cropland_rainfed_tree_or_shrub_cover cropland_irrigated mosaic_cropland mosaic_natural_vegetation tree_broadleaved_evergreen_closed_to_open tree_broadleaved_deciduous_closed_to_open tree_broadleaved_deciduous_closed tree_broadleaved_deciduous_open tree_needleleaved_evergreen_closed_to_open tree_needleleaved_evergreen_closed tree_needleleaved_evergreen_open tree_needleleaved_deciduous_closed_to_open tree_needleleaved_deciduous_closed tree_needleleaved_deciduous_open tree_mixed mosaic_tree_and_shrub mosaic_herbaceous shrubland shrubland_evergreen shrubland_deciduous grassland lichens_and_mosses sparse_vegetation sparse_tree sparse_shrub sparse_herbaceous tree_cover_flooded_fresh_or_brakish_water tree_cover_flooded_saline_water shrub_or_herbaceous_cover_flooded urban Bare_areas_of_soil_types_not_contained_in_biomes_203_to_207 Unconsolidated_bare_areas_of_soil_types_not_contained_in_biomes_203_to_207 Consolidated_bare_areas_of_soil_types_not_contained_in_biomes_203_to_207 Bare_areas_of_soil_type_Entisols_Orthents Bare_areas_of_soil_type_Shifting_sand Bare_areas_of_soil_type_Aridisols_Calcids Bare_areas_of_soil_type_Aridisols_Cambids Bare_areas_of_soil_type_Gelisols_Orthels water snow_and_ice Sea_ice\",\"flag_values\":[10,11,12,20,30,40,50,60,61,62,70,71,72,80,81,82,90,100,110,120,121,122,130,140,150,151,152,153,160,170,180,190,200,201,202,203,204,205,206,207,210,220,230],\"long_name\":\"land cover class\",\"units\":\"1\",\"valid_max\":230,\"valid_min\":10},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float32\",\"name\":\"lcc\"},\"lst\":{\"attrs\":{\"long_name\":\"land surface temperature\",\"units\":\"kelvin\",\"valid_max\":7685,\"valid_min\":-8315},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"lst\"},\"lst_unc_loc_atm\":{\"attrs\":{\"long_name\":\"uncertainty from locally correlated errors on atmospheric scales\",\"units\":\"kelvin\",\"valid_max\":10000,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"lst_unc_loc_atm\"},\"lst_unc_loc_cor\":{\"attrs\":{\"long_name\":\"uncertainty from locally correlated errors on LST corrections\",\"units\":\"kelvin\",\"valid_max\":10000,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"lst_unc_loc_cor\"},\"lst_unc_loc_sfc\":{\"attrs\":{\"long_name\":\"uncertainty from locally correlated errors on surface scales\",\"units\":\"kelvin\",\"valid_max\":10000,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"lst_unc_loc_sfc\"},\"lst_unc_ran\":{\"attrs\":{\"long_name\":\"uncertainty from uncorrelated errors\",\"units\":\"kelvin\",\"valid_max\":10000,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"lst_unc_ran\"},\"lst_unc_sys\":{\"attrs\":{\"long_name\":\"uncertainty from large-scale systematic errors\",\"units\":\"kelvin\",\"valid_max\":10000,\"valid_min\":0},\"chunks\":[1],\"dims\":[\"length_scale\"],\"dtype\":\"float64\",\"name\":\"lst_unc_sys\"},\"lst_uncertainty\":{\"attrs\":{\"long_name\":\"land surface temperature total uncertainty\",\"units\":\"kelvin\",\"valid_max\":10000,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"lst_uncertainty\"},\"n\":{\"attrs\":{\"long_name\":\"number of clear-sky pixels\",\"valid_max\":18750,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float32\",\"name\":\"n\"},\"sataz\":{\"attrs\":{\"long_name\":\"satellite azimuth angle\",\"units\":\"degrees\",\"valid_max\":18000,\"valid_min\":-18000},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"sataz\"},\"satze\":{\"attrs\":{\"long_name\":\"satellite zenith angle\",\"units\":\"degrees\",\"valid_max\":18000,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"satze\"},\"solaz\":{\"attrs\":{\"long_name\":\"solar azimuth angle\",\"units\":\"degrees\",\"valid_max\":18000,\"valid_min\":-18000},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"solaz\"},\"solze\":{\"attrs\":{\"long_name\":\"solar zenith angle\",\"units\":\"degrees\",\"valid_max\":18000,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"solze\"}},\"dims\":{\"channel\":2,\"lat\":18000,\"length_scale\":294,\"lon\":36000,\"time\":294},\"time_range\":[\"1995-08-01\",\"2020-12-01\"]}","content_type":"application/json"},"text/plain":{"content":"\u003cxcube.core.store.descriptor.DatasetDescriptor at 0x7fecd8f738c0\u003e","content_type":"text/plain"}}}],"key":"pkC6VxiglE"}],"key":"mU6VJ8ShUC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load the Dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jBJfzdZvE3"}],"identifier":"load-the-dataset","label":"Load the Dataset","html_id":"load-the-dataset","implicit":true,"key":"v4GMMeW189"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now that we have an understanding of the data structure and have defined the data store and ID, we can open the dataset by using the command ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RwdMGYR6mP"},{"type":"inlineCode","value":"open_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QdjNPAOiZ9"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RQEogKD9gj"}],"key":"PgIZQGKK3f"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We can then inspect the data structure and content by displaying the dataset. The displayed dataset is interactive in Jupyter Notebooks, thus you can use the arrows to see the content of the dataset, e.g. the Data variables or Coordinates and you can click on the container symbol ‚ò∞ to see what is inside.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"emF5YjboJp"}],"key":"nxFnJspBAQ"}],"key":"vHSVJ70dRh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lst_ds = cci_store.open_data(\n    data_id=data_id,\n)\ndisplay(lst_ds)","key":"vxUO1nua74"},{"type":"output","id":"DKuHOHjFCcRG6Y4Q9BdJT","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"9b9746ea92211e2752eb1a8d62b4dade","path":"/cci-notebook-viewers/build/9b9746ea92211e2752eb1a8d62b4dade.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 18TB\nDimensions:          (time: 294, lat: 18000, lon: 36000, length_scale: 294,\n                      channel: 2)\nCoordinates:\n  * channel          (channel) float64 16B 11.0 12.0\n  * lat              (lat) float32 72kB -90.0 -89.99 -89.98 ... 89.98 89.99\n  * lon              (lon) float32 144kB -180.0 -180.0 -180.0 ... 180.0 180.0\n  * time             (time) datetime64[ns] 2kB 1995-08-01 ... 2020-12-01\nDimensions without coordinates: length_scale\nData variables: (12/14)\n    dtime            (time, lat, lon) timedelta64[ns] 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    lcc              (time, lat, lon) float32 762GB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    lst              (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    lst_unc_loc_atm  (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    lst_unc_loc_cor  (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    lst_unc_loc_sfc  (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    ...               ...\n    lst_uncertainty  (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    n                (time, lat, lon) float32 762GB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    sataz            (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    satze            (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    solaz            (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    solze            (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\nAttributes: (12/42)\n    Conventions:                CF-1.8\n    catalogue_url:              https://catalogue.ceda.ac.uk/uuid/6babb8d9a8d...\n    cdm_data_type:              grid\n    comment:                    These data were produced as part of the ESA L...\n    creator_email:              djg20@le.ac.uk\n    creator_name:               University of Leicester Surface Temperature G...\n    ...                         ...\n    summary:                    This file contains level L3S global land surf...\n    time_coverage_duration:     P1M\n    time_coverage_end:          19700101T000001Z\n    time_coverage_resolution:   P1M\n    time_coverage_start:        19700101T000001Z\n    title:                      ESA LST CCI land surface temperature time ser...","content_type":"text/plain"}}}],"key":"H7oy1xhKFh"}],"key":"cCCN5oWTaQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a spatial subset of the LST data:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iVHZSeM8LH"}],"identifier":"create-a-spatial-subset-of-the-lst-data","label":"Create a spatial subset of the LST data:","html_id":"create-a-spatial-subset-of-the-lst-data","implicit":true,"key":"UJedTbywgM"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To focus our analysis on New Zealand, we now extract a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rrblBQsooz"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"spatial subset","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PyN88QJVFX"}],"key":"TDIgt1XN2U"},{"type":"text","value":" from the global LST dataset.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AAJZs5Kdnr"}],"key":"DWWraafdMX"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Using the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Fa5GgZb9x1"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"bounding box (bbox)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xs6PvLW33V"}],"key":"T1KJn8Y5vW"},{"type":"text","value":" we define here, the function ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wObmBCqIQm"},{"type":"inlineCode","value":"subset_spatial","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"raTNb3EG6D"},{"type":"text","value":" filters the dataset to include only the relevant area.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PJyAvV6bzr"}],"key":"lenIQoOBXS"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"This helps ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"BuwYCQ6v4y"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"reduce data volume","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"aaJ6yGH1iN"}],"key":"wehLv9R48e"},{"type":"text","value":" and enables more ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"aMPcqHdkl3"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"targeted visualizations and calculations","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"f4VX4q4VAK"}],"key":"GlSlrFcXYw"},{"type":"text","value":" in the following steps.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bwYaLlxfj8"}],"key":"prK3B3PyEc"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Below are several longitudes and latitudes to choose from. In the comment above, you can read which area they cover.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"koOm86TBdT"}],"key":"nGwmJOjCP8"}],"key":"QheLRP45Ek"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set bounding box to New Zealand \n#lat_min = -53.0\n#lat_max = -33.0\n#lon_min = 165.0\n#lon_max = 180.0  # Chatham Islands cannot be included here, as it is behind the 180th meridian of the longitude","key":"TDhwjXpwuC"},{"type":"output","id":"e0Ssc8hvtCOoNhSu0syla","data":[],"key":"PxNGGztF8A"}],"key":"qKJ0TdJW7R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# # Set bounding box to Christchurch\nlat_min = -44\nlat_max = -43.2\nlon_min = 172.3\nlon_max = 173.8","key":"L6HaIg8gHa"},{"type":"output","id":"gEZqOsj14xelqXcMEUZG8","data":[],"key":"CSlcTZe6Wh"}],"key":"GN06ZeFEth"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set bounding box to South Island\nlat_min = -47.78\nlat_max = -39.23\nlon_min = 166.1\nlon_max = 174.9","key":"e3slUFZ0Av"},{"type":"output","id":"IXO9xtZylBLGfMsd52tke","data":[],"key":"O7ixobK7j2"}],"key":"tTbwDkRwWh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set bounding box to North Island\nlat_min = -42.0\nlat_max = -34.0\nlon_min = 172.0\nlon_max = 180.0","key":"DenbhQMs38"},{"type":"output","id":"8yZcyBS0c5rEVoGN423oE","data":[],"key":"k8hTNKqzXY"}],"key":"ColwOGB0ip"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bbox = (lon_min, lat_min, lon_max, lat_max)  # Fixed order: (lon_min, lat_min, lon_max, lat_max)\n# Display bounding box for reference\nGeoJSON(shapely.geometry.box(*bbox).__geo_interface__)","key":"zrHbnZ7yJh"},{"type":"output","id":"FhqjLxSepQOmFQv5oUh9C","data":[{"output_type":"display_data","metadata":{"application/geo+json":{"expanded":false,"root":"root"}},"data":{"application/geo+json":{"content":"{\"coordinates\":[[[174.9,-47.78],[174.9,-39.23],[166.1,-39.23],[166.1,-47.78],[174.9,-47.78]]],\"type\":\"Polygon\"}","content_type":"application/geo+json"},"text/plain":{"content":"\u003cIPython.display.GeoJSON object\u003e","content_type":"text/plain"}}}],"key":"VzcGj8CYvt"}],"key":"o9QDgSu3AO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Choosing an operator","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cF8jyS0TUm"}],"identifier":"choosing-an-operator","label":"Choosing an operator","html_id":"choosing-an-operator","implicit":true,"key":"NRZ4lDcKwM"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The toolbox offers a variety of operators to choose which we can apply on the dataset. For creating a spatial subset, we would use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FOvWinvP7w"},{"type":"inlineCode","value":"subset_spatial","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ix3XlZOpfc"},{"type":"text","value":" operator, for the temporal subset, we would use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UHnjpUVouY"},{"type":"inlineCode","value":"subset_temporal","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eFo8KAhmrT"},{"type":"text","value":" operator. In the following cells, you can see how we call the operators and how we apply them to the data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oGdCNIZ2YZ"}],"key":"JARlxGk4Dt"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ZfGWBqrNov"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/notebooks/Using_Operations/1-ECT_Finding_Operations.html#Finding-Operations","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"available operators","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IwqT05RHMf"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/notebooks/Using_Operations/1-ECT_Finding_Operations.html#Finding-Operations","key":"uiczW9Wwe5"},{"type":"text","value":" can be listed via ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wvHs12FNUk"},{"type":"inlineCode","value":"list_operations","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"nVgdrGLMcK"},{"type":"text","value":" as shown below.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wCBlw5vdeG"}],"key":"XA1LCQe1sF"}],"key":"zhwRKkqeUu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Toolbox operators\nfrom esa_climate_toolbox.core import list_operations\nlist_operations()","key":"s1TuV780mw"},{"type":"output","id":"4f_CqbaUhIdnEy1_LQFP3","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"['add_dataset_values_to_geodataframe',\n 'adjust_spatial_attrs',\n 'adjust_temporal_attrs',\n 'aggregate_statistics',\n 'animate_map',\n 'anomaly_external',\n 'anomaly_internal',\n 'arithmetics',\n 'as_geodataframe',\n 'climatology',\n 'coregister',\n 'data_frame_max',\n 'data_frame_min',\n 'data_frame_subset',\n 'detect_outliers',\n 'diff',\n 'find_closest',\n 'fourier_analysis',\n 'gapfill',\n 'merge',\n 'normalize',\n 'plot',\n 'plot_contour',\n 'plot_hist',\n 'plot_line',\n 'plot_map',\n 'plot_scatter',\n 'query',\n 'reduce',\n 'resample',\n 'select_features',\n 'select_var',\n 'statistics',\n 'subset_spatial',\n 'subset_temporal',\n 'subset_temporal_index',\n 'temporal_aggregation',\n 'to_dataframe',\n 'to_dataset',\n 'tseries_mean',\n 'tseries_point']","content_type":"text/plain"}}}],"key":"C6XXmkq9uk"}],"key":"O0XdWloKo2"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If you would like to read more about the different operations, e.g. what they are doing, what is needed as input and output, you can retrieve this information as shown below.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QxuP5qsdU9"}],"key":"In0fvKjUf2"}],"key":"Ug8osNUH8O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import JSON\nfrom esa_climate_toolbox.core import get_op_meta_info\n\nJSON(get_op_meta_info('subset_spatial'))","key":"Sw3wqRgmko"},{"type":"output","id":"jAMVR-LoHvRXlLRPxnMsF","data":[{"output_type":"execute_result","execution_count":10,"metadata":{"application/json":{"expanded":false,"root":"root"}},"data":{"application/json":{"content":"{\"has_monitor\":true,\"header\":{\"description\":\"Do a spatial subset of the dataset\",\"tags\":[\"geometric\",\"spatial\",\"subset\"],\"version\":\"1.0\"},\"inputs\":{\"ds\":{\"data_type\":\"xarray.core.dataset.Dataset\",\"description\":\"Dataset to subset\",\"position\":0},\"mask\":{\"data_type\":\"bool\",\"default_value\":true,\"description\":\"Should values falling in the bounding box of the polygon but not the polygon itself be masked with NaN.\",\"position\":2},\"region\":{\"data_type\":\"esa_climate_toolbox.core.types.PolygonLike\",\"description\":\"Spatial region to subset\",\"position\":1}},\"outputs\":{\"return\":{\"add_history\":true,\"data_type\":\"xarray.core.dataset.Dataset\",\"description\":\"Subset dataset\"}},\"qualified_name\":\"esa_climate_toolbox.ops.subset.subset_spatial\"}","content_type":"application/json"},"text/plain":{"content":"\u003cIPython.core.display.JSON object\u003e","content_type":"text/plain"}}}],"key":"EM8CwfWvH1"}],"key":"v8F1ijeRR4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create the spatial subset with the bbox defined above\nsubset_spatial_op = get_op('subset_spatial')\nlst_ds_sub = subset_spatial_op(ds=lst_ds, region=bbox)\nlst_ds_sub","key":"JP2gkjJIEh"},{"type":"output","id":"51TD9kJTsCFc7IdICSqyS","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"240863c9288af966b51c799827973eff","path":"/cci-notebook-viewers/build/240863c9288af966b51c799827973eff.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 21GB\nDimensions:          (time: 294, lat: 857, lon: 882, length_scale: 294,\n                      channel: 2)\nCoordinates:\n  * channel          (channel) float64 16B 11.0 12.0\n  * lat              (lat) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.22\n  * lon              (lon) float32 4kB 166.1 166.1 166.1 ... 174.9 174.9 174.9\n  * time             (time) datetime64[ns] 2kB 1995-08-01 ... 2020-12-01\nDimensions without coordinates: length_scale\nData variables: (12/14)\n    dtime            (time, lat, lon) timedelta64[ns] 2GB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    lcc              (time, lat, lon) float32 889MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    lst              (time, lat, lon) float64 2GB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    lst_unc_loc_atm  (time, lat, lon) float64 2GB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    lst_unc_loc_cor  (time, lat, lon) float64 2GB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    lst_unc_loc_sfc  (time, lat, lon) float64 2GB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    ...               ...\n    lst_uncertainty  (time, lat, lon) float64 2GB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    n                (time, lat, lon) float32 889MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    sataz            (time, lat, lon) float64 2GB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    satze            (time, lat, lon) float64 2GB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    solaz            (time, lat, lon) float64 2GB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    solze            (time, lat, lon) float64 2GB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\nAttributes: (12/44)\n    Conventions:                CF-1.8\n    catalogue_url:              https://catalogue.ceda.ac.uk/uuid/6babb8d9a8d...\n    cdm_data_type:              grid\n    comment:                    These data were produced as part of the ESA L...\n    creator_email:              djg20@le.ac.uk\n    creator_name:               University of Leicester Surface Temperature G...\n    ...                         ...\n    time_coverage_end:          19700101T000001Z\n    time_coverage_resolution:   P1M\n    time_coverage_start:        19700101T000001Z\n    title:                      ESA LST CCI land surface temperature time ser...\n    geospatial_bounds_crs:      CRS84\n    geospatial_bounds:          POLYGON((166.08999633789062 -47.7900009155273...","content_type":"text/plain"}}}],"key":"KeuP7wHEvQ"}],"key":"DavAryV3d2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Climatology operator","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YLk832ccUC"}],"identifier":"climatology-operator","label":"Climatology operator","html_id":"climatology-operator","implicit":true,"key":"NcPo2imPt9"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To create a ‚Äúmean over years‚Äù dataset, the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Gcilcimvhj"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/api_reference.html#esa_climate_toolbox.ops.climatology","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"climatology operator","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Yiatl73AkZ"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/api_reference.html#esa_climate_toolbox.ops.climatology","key":"azIL5ZSaER"},{"type":"text","value":" averages the values of the given input data over all years. This is applied in the same time resolution as the given dataset, meaning - a daily dataset will calculate a daily average over all years, a monthly dataset will calculate a monthly average accross all years.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fBnxrNDRpW"}],"key":"evfYlzRCYG"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Note: the resulting monthly or daily data will be attributed to the first time array. In the case below, the dataset has a time array rom 1995 containing all averages from 1995-2020.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"f57rAsdPp8"}],"key":"p77qWJjBXT"}],"key":"BFvGIMFNGE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"climatology_op = get_op('climatology')\nlst_ds_clim = climatology_op(ds=lst_ds_sub)\nlst_ds_clim # use this to have a quick look into the metadata","key":"mTJXPT2tCq"},{"type":"output","id":"fhd4Tm-tkFBTYJ19wR-VS","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"34ac115c517c96e7e5452be94bf72c31","path":"/cci-notebook-viewers/build/34ac115c517c96e7e5452be94bf72c31.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 871MB\nDimensions:             (time: 12, lat: 857, lon: 882, length_scale: 294,\n                         channel: 2, nv: 2)\nCoordinates:\n  * channel             (channel) float64 16B 11.0 12.0\n  * lat                 (lat) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.22\n  * lon                 (lon) float32 4kB 166.1 166.1 166.1 ... 174.9 174.9\n  * time                (time) datetime64[ns] 96B 1995-01-01 ... 1995-12-01\nDimensions without coordinates: length_scale, nv\nData variables: (12/15)\n    dtime               (time, lat, lon) timedelta64[ns] 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    lcc                 (time, lat, lon) float32 36MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    lst                 (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    lst_unc_loc_atm     (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    lst_unc_loc_cor     (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    lst_unc_loc_sfc     (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    ...                  ...\n    n                   (time, lat, lon) float32 36MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    sataz               (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    satze               (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    solaz               (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    solze               (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    climatology_bounds  (time, nv) datetime64[us] 192B dask.array\u003cchunksize=(1, 2), meta=np.ndarray\u003e\nAttributes: (12/44)\n    Conventions:                CF-1.8\n    catalogue_url:              https://catalogue.ceda.ac.uk/uuid/6babb8d9a8d...\n    cdm_data_type:              grid\n    comment:                    These data were produced as part of the ESA L...\n    creator_email:              djg20@le.ac.uk\n    creator_name:               University of Leicester Surface Temperature G...\n    ...                         ...\n    time_coverage_end:          19700101T000001Z\n    time_coverage_resolution:   P1M\n    time_coverage_start:        19700101T000001Z\n    title:                      ESA LST CCI land surface temperature time ser...\n    geospatial_bounds_crs:      CRS84\n    geospatial_bounds:          POLYGON((166.08999633789062 -47.7900009155273...","content_type":"text/plain"}}}],"key":"ZcoY5n77KD"}],"key":"wler0fjFld"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot a spatial map using the toolbox","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hSrMhsgdyt"}],"identifier":"plot-a-spatial-map-using-the-toolbox","label":"Plot a spatial map using the toolbox","html_id":"plot-a-spatial-map-using-the-toolbox","implicit":true,"key":"occkPsP5u7"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Let‚Äôs plot the climatology dataset using the toolbox. As index, we choose ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"eMBYr7Uhcj"},{"type":"inlineCode","value":"'time' : '1995-01-01'","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"feaqheghlW"},{"type":"text","value":", meaning, we look at the mean LST in January from 1995-2020.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RU17GjdzVJ"}],"key":"FCyL4E2UcA"}],"key":"sUgQzN0zTM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_op = get_op('plot')\n# Create a plot of the LST data\n\nplot_op(\n    ds=lst_ds_clim,  # Dataset variable\n    var='lst',       # Variable you want to plot  # Specify the date\n    title=\"Average Land Surface Temperature in January (1995-2020)\",\n     indexers={'time': '1995-01-01'},  # Specify the date\n    properties=\"cmap='hot_r', vmin=275, vmax= 325\", # Pass other properties here, such as color\n)\n\n#\n#Latitude, 43¬∞ 31' 55.39\"S. Longitude, 172¬∞ 38' 10.41\"E\ncity_lat, city_lon = -43.353, 172.636\nplt.plot(city_lon, city_lat, linestyle='--', marker='o', color='k', label='≈åtautahi - Christchurch ')\nplt.legend()\n","key":"VoHY4ySCUG"},{"type":"output","id":"As_oe7NfdA72tx31bklas","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d150170b8bd9cb98d5f0fdb1ce1862a6","path":"/cci-notebook-viewers/build/d150170b8bd9cb98d5f0fdb1ce1862a6.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"RFhXNWjfXc"}],"key":"SirT0nCgqM"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Temporal subset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oi92ljiSak"}],"identifier":"temporal-subset","label":"Temporal subset","html_id":"temporal-subset","implicit":true,"key":"dovLgZEc4R"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Next, we do a temporal subset of the dataset and choose only 2019.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Nt025PVcNY"}],"key":"PcKmoLOJCa"}],"key":"PmHFreZQ17"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"subset_temporal_op = get_op('subset_temporal')\nlst_ds_sub = subset_temporal_op(ds=lst_ds_sub, time_range=['2019-01-01', '2019-12-01'])\nlst_ds_sub ","key":"LL9KoJI6O0"},{"type":"output","id":"TEVuv7OQT35GEVom4rs2k","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"ba202f97054ecc8a417b861ff462bac7","path":"/cci-notebook-viewers/build/ba202f97054ecc8a417b861ff462bac7.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 871MB\nDimensions:          (time: 12, lat: 857, lon: 882, length_scale: 294,\n                      channel: 2)\nCoordinates:\n  * channel          (channel) float64 16B 11.0 12.0\n  * lat              (lat) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.22\n  * lon              (lon) float32 4kB 166.1 166.1 166.1 ... 174.9 174.9 174.9\n  * time             (time) datetime64[ns] 96B 2019-01-01 ... 2019-12-01\nDimensions without coordinates: length_scale\nData variables: (12/14)\n    dtime            (time, lat, lon) timedelta64[ns] 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    lcc              (time, lat, lon) float32 36MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    lst              (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    lst_unc_loc_atm  (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    lst_unc_loc_cor  (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    lst_unc_loc_sfc  (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    ...               ...\n    lst_uncertainty  (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    n                (time, lat, lon) float32 36MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    sataz            (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    satze            (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    solaz            (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\n    solze            (time, lat, lon) float64 73MB dask.array\u003cchunksize=(1, 279, 882), meta=np.ndarray\u003e\nAttributes: (12/44)\n    Conventions:                CF-1.8\n    catalogue_url:              https://catalogue.ceda.ac.uk/uuid/6babb8d9a8d...\n    cdm_data_type:              grid\n    comment:                    These data were produced as part of the ESA L...\n    creator_email:              djg20@le.ac.uk\n    creator_name:               University of Leicester Surface Temperature G...\n    ...                         ...\n    time_coverage_end:          2019-12-01T00:00:00\n    time_coverage_resolution:   P1M\n    time_coverage_start:        2019-01-01T00:00:00\n    title:                      ESA LST CCI land surface temperature time ser...\n    geospatial_bounds_crs:      CRS84\n    geospatial_bounds:          POLYGON((166.08999633789062 -47.7900009155273...","content_type":"text/plain"}}}],"key":"QS0OUzhFxb"}],"key":"dfvQoaUJsj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let‚Äôs look at a heatwave year: 2019, in particular we will focus on January to see how we can combine LST and population data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pCOQ3KcsGm"}],"key":"WbECcoqKIp"}],"key":"Nnqec93ES1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#January 2019 LST data selection\nlst_19_j=lst_ds_sub.lst.sel(time='2019-01-01')-273.15","key":"QcJtCPIBgd"},{"type":"output","id":"MwgTZRKSXzl2aJHdRqmIc","data":[],"key":"q8fl0p52sx"}],"key":"qmqlxCakXO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"extent=[lon_min,lon_max,lat_min,lat_max]","key":"fdxz4d4gxw"},{"type":"output","id":"yoaGw3c1JAclIFXuefcru","data":[],"key":"iS0Ib5KAE5"}],"key":"JTXsodLOPu"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Combine the land surface temperature data with a population density map","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dmgBZSkAg7"}],"identifier":"combine-the-land-surface-temperature-data-with-a-population-density-map","label":"Combine the land surface temperature data with a population density map","html_id":"combine-the-land-surface-temperature-data-with-a-population-density-map","implicit":true,"key":"ohVaSBjOVA"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We can combine satellite data with socio-economic data, such as density population maps.\nThe data is retrieved from the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"X2nHi7RO4k"},{"type":"link","url":"https://human-settlement.emergency.copernicus.eu/download.php","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Global Human Settlement Layer","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"AxKUXGAQoj"}],"key":"g5gsuEZM9Z"}],"urlSource":"https://human-settlement.emergency.copernicus.eu/download.php","key":"eHxAYMPMQg"},{"type":"text","value":" from 2020 (note, that 2019 is not available). The resolution is 30 arcsec and the coordination system is WGS84. The data can be downloaded as ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dg4eO9ZGpF"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"tif","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"oUAlnH8N5q"}],"key":"riMIEltGh0"},{"type":"text","value":" file for several grids and the grids covering New Zealand have already been merged and can be found inside the same folder, where the Jupyter Notebook is stored.\nThe ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bVPN3smpsl"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"tif","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"IjR9D3JePl"}],"key":"HBZ3NGQR4p"},{"type":"text","value":" format includes relevant metadata, such as latitude and longitude, which allows us to combine it with the satellite data.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"OqfbuekExe"}],"key":"sK2NCPduZ9"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The data is licensed under ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"s0ZUDWxm6R"},{"type":"link","url":"https://creativecommons.org/licenses/by/4.0/","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"CC BY 4.0","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"OMc5SblNJF"}],"urlSource":"https://creativecommons.org/licenses/by/4.0/","key":"Ng3AZ98k99"},{"type":"text","value":".","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"vx5KKeIAAx"}],"key":"PxUht3E7xR"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The data has been processed (merged and clipped) for visualisation purposes in this notebook.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"WO55YFVp73"}],"key":"DMhhU1L5zd"}],"key":"xnsorKmDH8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Load population density raster\nwith rasterio.open(\"merged_population_NewZealand2020_density.tif\") as src:\n    pop_density = src.read(1) \n    bounds = src.bounds  # get the geographical boundaries of the tif file (left, bottom, right, top)\n    extent = [bounds.left, bounds.right, bounds.bottom, bounds.top] # define the extent of the tif file","key":"wTbYU5NacT"},{"type":"output","id":"uOqIZnbazMr4KgbUAe3YU","data":[],"key":"gpCt411YWy"}],"key":"Du1pp1bpOZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lst_da_crs = lst_19_j.rio.write_crs(\"EPSG:4326\", inplace=True) #coordinates are in degrees: use EPSG:4326.\nlst_da_crs","key":"wDB6HaQsVK"},{"type":"output","id":"tBa-IW6BIDVp1gY_LnNMP","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\u003csvg style=\"position: absolute; width: 0; height: 0; overflow: hidden\"\u003e\n\u003cdefs\u003e\n\u003csymbol id=\"icon-database\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003csymbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003c/defs\u003e\n\u003c/svg\u003e\n\u003cstyle\u003e/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header \u003e div,\n.xr-header \u003e ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary \u003e span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"‚ñ∫\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"‚ñº\";\n}\n\n.xr-section-summary-in:checked + label \u003e span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap \u003e label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item \u003e div,\n.xr-var-item label,\n.xr-var-item \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item \u003e .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list \u003e li:nth-child(odd) \u003e div,\n.xr-var-list \u003e li:nth-child(odd) \u003e label,\n.xr-var-list \u003e li:nth-child(odd) \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data \u003e table {\n  float: right;\n}\n\n.xr-var-data \u003e pre,\n.xr-index-data \u003e pre,\n.xr-var-data \u003e table \u003e tbody \u003e tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label \u003e .xr-icon-file-text2,\n.xr-var-data-in:checked + label \u003e .xr-icon-database,\n.xr-index-data-in:checked + label \u003e .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n\u003c/style\u003e\u003cpre class='xr-text-repr-fallback'\u003e\u0026lt;xarray.DataArray \u0026#x27;lst\u0026#x27; (lat: 857, lon: 882)\u0026gt; Size: 6MB\ndask.array\u0026lt;sub, shape=(857, 882), dtype=float64, chunksize=(578, 882), chunktype=numpy.ndarray\u0026gt;\nCoordinates:\n  * lat          (lat) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.24 -39.22\n  * lon          (lon) float32 4kB 166.1 166.1 166.1 166.1 ... 174.9 174.9 174.9\n    time         datetime64[ns] 8B 2019-01-01\n    spatial_ref  int64 8B 0\u003c/pre\u003e\u003cdiv class='xr-wrap' style='display:none'\u003e\u003cdiv class='xr-header'\u003e\u003cdiv class='xr-obj-type'\u003exarray.DataArray\u003c/div\u003e\u003cdiv class='xr-array-name'\u003e'lst'\u003c/div\u003e\u003cul class='xr-dim-list'\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003elat\u003c/span\u003e: 857\u003c/li\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003elon\u003c/span\u003e: 882\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003cul class='xr-sections'\u003e\u003cli class='xr-section-item'\u003e\u003cdiv class='xr-array-wrap'\u003e\u003cinput id='section-3d705b8b-6e40-4832-b6db-b02117d340fc' class='xr-array-in' type='checkbox' checked\u003e\u003clabel for='section-3d705b8b-6e40-4832-b6db-b02117d340fc' title='Show/hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-array-preview xr-preview'\u003e\u003cspan\u003edask.array\u0026lt;chunksize=(279, 882), meta=np.ndarray\u0026gt;\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-array-data'\u003e\u003ctable\u003e\n    \u003ctr\u003e\n        \u003ctd\u003e\n            \u003ctable style=\"border-collapse: collapse;\"\u003e\n                \u003cthead\u003e\n                    \u003ctr\u003e\n                        \u003ctd\u003e \u003c/td\u003e\n                        \u003cth\u003e Array \u003c/th\u003e\n                        \u003cth\u003e Chunk \u003c/th\u003e\n                    \u003c/tr\u003e\n                \u003c/thead\u003e\n                \u003ctbody\u003e\n                    \n                    \u003ctr\u003e\n                        \u003cth\u003e Bytes \u003c/th\u003e\n                        \u003ctd\u003e 5.77 MiB \u003c/td\u003e\n                        \u003ctd\u003e 3.89 MiB \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \n                    \u003ctr\u003e\n                        \u003cth\u003e Shape \u003c/th\u003e\n                        \u003ctd\u003e (857, 882) \u003c/td\u003e\n                        \u003ctd\u003e (578, 882) \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003e Dask graph \u003c/th\u003e\n                        \u003ctd colspan=\"2\"\u003e 2 chunks in 6 graph layers \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003e Data type \u003c/th\u003e\n                        \u003ctd colspan=\"2\"\u003e float64 numpy.ndarray \u003c/td\u003e\n                    \u003c/tr\u003e\n                \u003c/tbody\u003e\n            \u003c/table\u003e\n        \u003c/td\u003e\n        \u003ctd\u003e\n        \u003csvg width=\"170\" height=\"166\" style=\"stroke:rgb(0,0,0);stroke-width:1\" \u003e\n\n  \u003c!-- Horizontal lines --\u003e\n  \u003cline x1=\"0\" y1=\"0\" x2=\"120\" y2=\"0\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"0\" y1=\"37\" x2=\"120\" y2=\"37\" /\u003e\n  \u003cline x1=\"0\" y1=\"116\" x2=\"120\" y2=\"116\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Vertical lines --\u003e\n  \u003cline x1=\"0\" y1=\"0\" x2=\"0\" y2=\"116\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"120\" y1=\"0\" x2=\"120\" y2=\"116\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Colored Rectangle --\u003e\n  \u003cpolygon points=\"0.0,0.0 120.0,0.0 120.0,116.59863945578232 0.0,116.59863945578232\" style=\"fill:#ECB172A0;stroke-width:0\"/\u003e\n\n  \u003c!-- Text --\u003e\n  \u003ctext x=\"60.000000\" y=\"136.598639\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" \u003e882\u003c/text\u003e\n  \u003ctext x=\"140.000000\" y=\"58.299320\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,140.000000,58.299320)\"\u003e857\u003c/text\u003e\n\u003c/svg\u003e\n        \u003c/td\u003e\n    \u003c/tr\u003e\n\u003c/table\u003e\u003c/div\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-f61d52a3-ee43-4f9d-9f84-5a97d412d28d' class='xr-section-summary-in' type='checkbox'  checked\u003e\u003clabel for='section-f61d52a3-ee43-4f9d-9f84-5a97d412d28d' class='xr-section-summary' \u003eCoordinates: \u003cspan\u003e(4)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003elat\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(lat)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003efloat32\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e-47.78 -47.78 ... -39.24 -39.22\u003c/div\u003e\u003cinput id='attrs-031ea43a-0cb0-456d-920f-20d24688aef1' class='xr-var-attrs-in' type='checkbox' \u003e\u003clabel for='attrs-031ea43a-0cb0-456d-920f-20d24688aef1' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-da79673d-e336-4dc2-a15d-6ac1586216f1' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-da79673d-e336-4dc2-a15d-6ac1586216f1' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003cdt\u003e\u003cspan\u003elong_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003elatitude_coordinates\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003ereference_datum :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003egeographical coordinates, WGS84 projection\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003estandard_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003elatitude\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003eunits :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003edegrees_north\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003evalid_max :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e90.0\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003evalid_min :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e-90.0\u003c/dd\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([-47.785, -47.775, -47.765, ..., -39.245, -39.235, -39.225],\n      shape=(857,), dtype=float32)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003elon\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(lon)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003efloat32\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e166.1 166.1 166.1 ... 174.9 174.9\u003c/div\u003e\u003cinput id='attrs-7139dac6-94ec-4a2e-ae8b-22077357f359' class='xr-var-attrs-in' type='checkbox' \u003e\u003clabel for='attrs-7139dac6-94ec-4a2e-ae8b-22077357f359' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-eb916846-9bd0-4d1b-9478-ce0209157936' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-eb916846-9bd0-4d1b-9478-ce0209157936' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003cdt\u003e\u003cspan\u003elong_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003elongitude_coordinates\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003ereference_datum :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003egeographical coordinates, WGS84 projection\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003estandard_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003elongitude\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003eunits :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003edegrees_east\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003evalid_max :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e180.0\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003evalid_min :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e-180.0\u003c/dd\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([166.095  , 166.10501, 166.11499, ..., 174.88501, 174.89499, 174.905  ],\n      shape=(882,), dtype=float32)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan\u003etime\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e()\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003edatetime64[ns]\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e2019-01-01\u003c/div\u003e\u003cinput id='attrs-b3abb15f-e345-4a4d-bb8c-db5155392098' class='xr-var-attrs-in' type='checkbox' \u003e\u003clabel for='attrs-b3abb15f-e345-4a4d-bb8c-db5155392098' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-eb3f3800-35a9-4a1c-827b-d82a619b669d' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-eb3f3800-35a9-4a1c-827b-d82a619b669d' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003cdt\u003e\u003cspan\u003elong_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003ereference time of file\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003estandard_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003etime\u003c/dd\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray(\u0026#x27;2019-01-01T00:00:00.000000000\u0026#x27;, dtype=\u0026#x27;datetime64[ns]\u0026#x27;)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan\u003espatial_ref\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e()\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003eint64\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e0\u003c/div\u003e\u003cinput id='attrs-ad183140-287e-44c1-9334-d5c9647f01d8' class='xr-var-attrs-in' type='checkbox' \u003e\u003clabel for='attrs-ad183140-287e-44c1-9334-d5c9647f01d8' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-2a95cb70-b9a9-49d7-a0fd-d5cef77c699e' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-2a95cb70-b9a9-49d7-a0fd-d5cef77c699e' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003cdt\u003e\u003cspan\u003ecrs_wkt :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eGEOGCS[\u0026quot;WGS 84\u0026quot;,DATUM[\u0026quot;WGS_1984\u0026quot;,SPHEROID[\u0026quot;WGS 84\u0026quot;,6378137,298.257223563,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;7030\u0026quot;]],AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;6326\u0026quot;]],PRIMEM[\u0026quot;Greenwich\u0026quot;,0,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;8901\u0026quot;]],UNIT[\u0026quot;degree\u0026quot;,0.0174532925199433,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;9122\u0026quot;]],AXIS[\u0026quot;Latitude\u0026quot;,NORTH],AXIS[\u0026quot;Longitude\u0026quot;,EAST],AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;4326\u0026quot;]]\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003esemi_major_axis :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e6378137.0\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003esemi_minor_axis :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e6356752.314245179\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003einverse_flattening :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e298.257223563\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003ereference_ellipsoid_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eWGS 84\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003elongitude_of_prime_meridian :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e0.0\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003eprime_meridian_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eGreenwich\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003egeographic_crs_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eWGS 84\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003ehorizontal_datum_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eWorld Geodetic System 1984\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003egrid_mapping_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003elatitude_longitude\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003espatial_ref :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eGEOGCS[\u0026quot;WGS 84\u0026quot;,DATUM[\u0026quot;WGS_1984\u0026quot;,SPHEROID[\u0026quot;WGS 84\u0026quot;,6378137,298.257223563,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;7030\u0026quot;]],AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;6326\u0026quot;]],PRIMEM[\u0026quot;Greenwich\u0026quot;,0,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;8901\u0026quot;]],UNIT[\u0026quot;degree\u0026quot;,0.0174532925199433,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;9122\u0026quot;]],AXIS[\u0026quot;Latitude\u0026quot;,NORTH],AXIS[\u0026quot;Longitude\u0026quot;,EAST],AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;4326\u0026quot;]]\u003c/dd\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray(0)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-49c544a3-63bc-41ef-a938-3500c57a4004' class='xr-section-summary-in' type='checkbox'  \u003e\u003clabel for='section-49c544a3-63bc-41ef-a938-3500c57a4004' class='xr-section-summary' \u003eIndexes: \u003cspan\u003e(2)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003elat\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-e2237d94-8da6-4589-9c02-dba19aec6c45' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-e2237d94-8da6-4589-9c02-dba19aec6c45' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(Index([ -47.78499984741211, -47.775001525878906,  -47.76499938964844,\n       -47.755001068115234, -47.744998931884766,  -47.73500061035156,\n       -47.724998474121094,  -47.71500015258789,  -47.70499801635742,\n        -47.69499969482422,\n       ...\n       -39.314998626708984,  -39.30500030517578,  -39.29499816894531,\n        -39.28499984741211, -39.275001525878906,  -39.26499938964844,\n       -39.255001068115234, -39.244998931884766,  -39.23500061035156,\n       -39.224998474121094],\n      dtype=\u0026#x27;float32\u0026#x27;, name=\u0026#x27;lat\u0026#x27;, length=857))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003elon\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-967fc68d-7379-481e-b3fe-36d7916f4071' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-967fc68d-7379-481e-b3fe-36d7916f4071' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(Index([166.09500122070312, 166.10501098632812,   166.114990234375,\n                  166.125,   166.135009765625, 166.14498901367188,\n       166.15499877929688, 166.16500854492188, 166.17498779296875,\n       166.18499755859375,\n       ...\n       174.81500244140625, 174.82501220703125, 174.83499145507812,\n       174.84500122070312, 174.85501098632812,   174.864990234375,\n                  174.875,   174.885009765625, 174.89498901367188,\n       174.90499877929688],\n      dtype=\u0026#x27;float32\u0026#x27;, name=\u0026#x27;lon\u0026#x27;, length=882))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-f407cebc-fc64-4860-927c-b43e6ee538a4' class='xr-section-summary-in' type='checkbox' disabled \u003e\u003clabel for='section-f407cebc-fc64-4860-927c-b43e6ee538a4' class='xr-section-summary'  title='Expand/collapse section'\u003eAttributes: \u003cspan\u003e(0)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"\u003cxarray.DataArray 'lst' (lat: 857, lon: 882)\u003e Size: 6MB\ndask.array\u003csub, shape=(857, 882), dtype=float64, chunksize=(578, 882), chunktype=numpy.ndarray\u003e\nCoordinates:\n  * lat          (lat) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.24 -39.22\n  * lon          (lon) float32 4kB 166.1 166.1 166.1 166.1 ... 174.9 174.9 174.9\n    time         datetime64[ns] 8B 2019-01-01\n    spatial_ref  int64 8B 0","content_type":"text/plain"}}}],"key":"dVHMYPJceX"}],"key":"OoByMqmDV8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Matching Population density data grid to the LST grid\nimport rioxarray\n\n# Load population density  as xarray DataArray\npop_da = rioxarray.open_rasterio(\"merged_population_NewZealand2015_density.tif\", masked=True).squeeze()\n\n# Regrid to LST dataset grid\npop_da_matched = pop_da.rio.reproject_match(lst_da_crs)\n\nextent = [float(pop_da_matched.x.min()), float(pop_da_matched.x.max()),\n          float(pop_da_matched.y.min()), float(pop_da_matched.y.max())]","key":"YMfZ9FaZEz"},{"type":"output","id":"0an4XCXtm7eav7vCmGAq3","data":[],"key":"wF4rXiwWYp"}],"key":"PlgnM3rQ98"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pop_da_matched","key":"VWhffifzoL"},{"type":"output","id":"5E69qrpJ6_oFiFMO5uRpY","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\u003csvg style=\"position: absolute; width: 0; height: 0; overflow: hidden\"\u003e\n\u003cdefs\u003e\n\u003csymbol id=\"icon-database\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003csymbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003c/defs\u003e\n\u003c/svg\u003e\n\u003cstyle\u003e/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header \u003e div,\n.xr-header \u003e ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary \u003e span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"‚ñ∫\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"‚ñº\";\n}\n\n.xr-section-summary-in:checked + label \u003e span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap \u003e label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item \u003e div,\n.xr-var-item label,\n.xr-var-item \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item \u003e .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list \u003e li:nth-child(odd) \u003e div,\n.xr-var-list \u003e li:nth-child(odd) \u003e label,\n.xr-var-list \u003e li:nth-child(odd) \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data \u003e table {\n  float: right;\n}\n\n.xr-var-data \u003e pre,\n.xr-index-data \u003e pre,\n.xr-var-data \u003e table \u003e tbody \u003e tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label \u003e .xr-icon-file-text2,\n.xr-var-data-in:checked + label \u003e .xr-icon-database,\n.xr-index-data-in:checked + label \u003e .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n\u003c/style\u003e\u003cpre class='xr-text-repr-fallback'\u003e\u0026lt;xarray.DataArray (y: 857, x: 882)\u0026gt; Size: 6MB\narray([[0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       ...,\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.]], shape=(857, 882))\nCoordinates:\n    band         int64 8B 1\n    spatial_ref  int64 8B 0\n  * x            (x) float32 4kB 166.1 166.1 166.1 166.1 ... 174.9 174.9 174.9\n  * y            (y) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.24 -39.22\nAttributes:\n    AREA_OR_POINT:  Area\n    scale_factor:   1.0\n    add_offset:     0.0\n    _FillValue:     nan\u003c/pre\u003e\u003cdiv class='xr-wrap' style='display:none'\u003e\u003cdiv class='xr-header'\u003e\u003cdiv class='xr-obj-type'\u003exarray.DataArray\u003c/div\u003e\u003cdiv class='xr-array-name'\u003e\u003c/div\u003e\u003cul class='xr-dim-list'\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003ey\u003c/span\u003e: 857\u003c/li\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003ex\u003c/span\u003e: 882\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003cul class='xr-sections'\u003e\u003cli class='xr-section-item'\u003e\u003cdiv class='xr-array-wrap'\u003e\u003cinput id='section-bb354066-e1db-40a5-861d-e093150f6abf' class='xr-array-in' type='checkbox' checked\u003e\u003clabel for='section-bb354066-e1db-40a5-861d-e093150f6abf' title='Show/hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-array-preview xr-preview'\u003e\u003cspan\u003e0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-array-data'\u003e\u003cpre\u003earray([[0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       ...,\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.]], shape=(857, 882))\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-34d86aa3-417b-412f-8095-f4cb885f3e73' class='xr-section-summary-in' type='checkbox'  checked\u003e\u003clabel for='section-34d86aa3-417b-412f-8095-f4cb885f3e73' class='xr-section-summary' \u003eCoordinates: \u003cspan\u003e(4)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan\u003eband\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e()\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003eint64\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e1\u003c/div\u003e\u003cinput id='attrs-78f38f93-fa06-4755-86c4-a8f5b7d02351' class='xr-var-attrs-in' type='checkbox' disabled\u003e\u003clabel for='attrs-78f38f93-fa06-4755-86c4-a8f5b7d02351' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-903b624e-1d1f-450d-afb3-2c1404c171fe' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-903b624e-1d1f-450d-afb3-2c1404c171fe' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray(1)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan\u003espatial_ref\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e()\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003eint64\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e0\u003c/div\u003e\u003cinput id='attrs-d9486e0a-429c-4dbd-acaa-a378d78fc2d6' class='xr-var-attrs-in' type='checkbox' \u003e\u003clabel for='attrs-d9486e0a-429c-4dbd-acaa-a378d78fc2d6' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-809b2219-aa67-4e09-89ac-cd29a701fadb' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-809b2219-aa67-4e09-89ac-cd29a701fadb' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003cdt\u003e\u003cspan\u003ecrs_wkt :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eGEOGCS[\u0026quot;WGS 84\u0026quot;,DATUM[\u0026quot;WGS_1984\u0026quot;,SPHEROID[\u0026quot;WGS 84\u0026quot;,6378137,298.257223563,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;7030\u0026quot;]],AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;6326\u0026quot;]],PRIMEM[\u0026quot;Greenwich\u0026quot;,0,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;8901\u0026quot;]],UNIT[\u0026quot;degree\u0026quot;,0.0174532925199433,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;9122\u0026quot;]],AXIS[\u0026quot;Latitude\u0026quot;,NORTH],AXIS[\u0026quot;Longitude\u0026quot;,EAST],AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;4326\u0026quot;]]\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003esemi_major_axis :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e6378137.0\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003esemi_minor_axis :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e6356752.314245179\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003einverse_flattening :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e298.257223563\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003ereference_ellipsoid_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eWGS 84\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003elongitude_of_prime_meridian :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e0.0\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003eprime_meridian_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eGreenwich\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003egeographic_crs_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eWGS 84\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003ehorizontal_datum_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eWorld Geodetic System 1984\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003egrid_mapping_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003elatitude_longitude\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003espatial_ref :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eGEOGCS[\u0026quot;WGS 84\u0026quot;,DATUM[\u0026quot;WGS_1984\u0026quot;,SPHEROID[\u0026quot;WGS 84\u0026quot;,6378137,298.257223563,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;7030\u0026quot;]],AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;6326\u0026quot;]],PRIMEM[\u0026quot;Greenwich\u0026quot;,0,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;8901\u0026quot;]],UNIT[\u0026quot;degree\u0026quot;,0.0174532925199433,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;9122\u0026quot;]],AXIS[\u0026quot;Latitude\u0026quot;,NORTH],AXIS[\u0026quot;Longitude\u0026quot;,EAST],AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;4326\u0026quot;]]\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003eGeoTransform :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e166.09000122208872 0.00999999722882378 0.0 -47.789999848214265 0.0 0.010000001604311934\u003c/dd\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray(0)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003ex\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(x)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003efloat32\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e166.1 166.1 166.1 ... 174.9 174.9\u003c/div\u003e\u003cinput id='attrs-c601fd10-3e35-4c5f-bb02-6ecbbae6cbaa' class='xr-var-attrs-in' type='checkbox' \u003e\u003clabel for='attrs-c601fd10-3e35-4c5f-bb02-6ecbbae6cbaa' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-9c131999-266f-48d5-b52e-da77f983703a' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-9c131999-266f-48d5-b52e-da77f983703a' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003cdt\u003e\u003cspan\u003eaxis :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eX\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003elong_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003elongitude\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003estandard_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003elongitude\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003eunits :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003edegrees_east\u003c/dd\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([166.095  , 166.10501, 166.11499, ..., 174.88501, 174.89499, 174.905  ],\n      shape=(882,), dtype=float32)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003ey\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(y)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003efloat32\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e-47.78 -47.78 ... -39.24 -39.22\u003c/div\u003e\u003cinput id='attrs-acb6bb6c-967c-49b7-8de2-4a319e0347af' class='xr-var-attrs-in' type='checkbox' \u003e\u003clabel for='attrs-acb6bb6c-967c-49b7-8de2-4a319e0347af' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-00a7a584-46fe-49f9-9064-30e149fafdfc' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-00a7a584-46fe-49f9-9064-30e149fafdfc' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003cdt\u003e\u003cspan\u003eaxis :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eY\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003elong_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003elatitude\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003estandard_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003elatitude\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003eunits :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003edegrees_north\u003c/dd\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([-47.785, -47.775, -47.765, ..., -39.245, -39.235, -39.225],\n      shape=(857,), dtype=float32)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-1b09b199-373d-4153-83fd-40e0361c6a56' class='xr-section-summary-in' type='checkbox'  \u003e\u003clabel for='section-1b09b199-373d-4153-83fd-40e0361c6a56' class='xr-section-summary' \u003eIndexes: \u003cspan\u003e(2)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003ex\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-5791f263-55b5-4cae-8c01-2fd4033b206f' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-5791f263-55b5-4cae-8c01-2fd4033b206f' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(Index([166.09500122070312, 166.10501098632812,   166.114990234375,\n                  166.125,   166.135009765625, 166.14498901367188,\n       166.15499877929688, 166.16500854492188, 166.17498779296875,\n       166.18499755859375,\n       ...\n       174.81500244140625, 174.82501220703125, 174.83499145507812,\n       174.84500122070312, 174.85501098632812,   174.864990234375,\n                  174.875,   174.885009765625, 174.89498901367188,\n       174.90499877929688],\n      dtype=\u0026#x27;float32\u0026#x27;, name=\u0026#x27;x\u0026#x27;, length=882))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003ey\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-d37c4151-1821-447b-8452-02659ffef015' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-d37c4151-1821-447b-8452-02659ffef015' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(Index([ -47.78499984741211, -47.775001525878906,  -47.76499938964844,\n       -47.755001068115234, -47.744998931884766,  -47.73500061035156,\n       -47.724998474121094,  -47.71500015258789,  -47.70499801635742,\n        -47.69499969482422,\n       ...\n       -39.314998626708984,  -39.30500030517578,  -39.29499816894531,\n        -39.28499984741211, -39.275001525878906,  -39.26499938964844,\n       -39.255001068115234, -39.244998931884766,  -39.23500061035156,\n       -39.224998474121094],\n      dtype=\u0026#x27;float32\u0026#x27;, name=\u0026#x27;y\u0026#x27;, length=857))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-57ec5806-7b2d-4372-8fec-1ba6bd3ba19e' class='xr-section-summary-in' type='checkbox'  checked\u003e\u003clabel for='section-57ec5806-7b2d-4372-8fec-1ba6bd3ba19e' class='xr-section-summary' \u003eAttributes: \u003cspan\u003e(4)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cdl class='xr-attrs'\u003e\u003cdt\u003e\u003cspan\u003eAREA_OR_POINT :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eArea\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003escale_factor :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e1.0\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003eadd_offset :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e0.0\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003e_FillValue :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003enan\u003c/dd\u003e\u003c/dl\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"\u003cxarray.DataArray (y: 857, x: 882)\u003e Size: 6MB\narray([[0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       ...,\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.]], shape=(857, 882))\nCoordinates:\n    band         int64 8B 1\n    spatial_ref  int64 8B 0\n  * x            (x) float32 4kB 166.1 166.1 166.1 166.1 ... 174.9 174.9 174.9\n  * y            (y) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.24 -39.22\nAttributes:\n    AREA_OR_POINT:  Area\n    scale_factor:   1.0\n    add_offset:     0.0\n    _FillValue:     nan","content_type":"text/plain"}}}],"key":"odBRYcU5fW"}],"key":"zJ1LFZ1QBE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Creating an xarray for population density\npop_dens= xr.DataArray(pop_da_matched, coords=lst_19_j.coords, dims=lst_19_j.dims)","key":"Jn3b34n5wP"},{"type":"output","id":"mG9j7kisIpg6-lQVundNt","data":[],"key":"Ur4bJt4Y4H"}],"key":"gCoEjWUcFi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create side-by-side subplots\nfig, axes = plt.subplots(ncols=2, figsize=(12, 6), subplot_kw={\"projection\": ccrs.PlateCarree()})\n\n# Plotting LST\nplot_lst= lst_19_j.plot(ax=axes[0], cmap='hot_r', vmin=0, vmax=50, transform=ccrs.PlateCarree(),\n                       cbar_kwargs={'label': 'Land Surface Temperature (¬∞C)', 'orientation': 'vertical', 'shrink': 0.7})\n\n# Add coastlines and borders\naxes[0].add_feature(cfeature.COASTLINE, linewidth=1)\naxes[0].add_feature(cfeature.BORDERS, linestyle=':')\n# Set map extent (adjust as needed)\naxes[0].set_extent(extent)\n#cbar0.set_label('LST Risk Level', fontsize=10)\ngl0 = axes[0].gridlines(draw_labels=True, linewidth=0.5, color='gray', alpha=0.7, linestyle='--')\ngl0.top_labels = False\ngl0.right_labels = False\n\naxes[0].set_title('Hazard: LST Levels - January 2019', fontsize=12)\naxes[0].set_xlabel('Longitude [¬∞E]')\naxes[0].set_ylabel('Latitude [¬∞N]')\n\n#Plotting population density\nplot_pop= pop_dens.plot(ax=axes[1],cmap='Reds', vmin=0, vmax=10000,  transform=ccrs.PlateCarree(),  \n                        cbar_kwargs={'label': 'Population Density (people/km¬≤)', 'orientation': 'vertical', 'shrink': 0.7})\naxes[1].add_feature(cfeature.COASTLINE, linewidth=1)\naxes[1].add_feature(cfeature.BORDERS, linestyle=':')\naxes[1].set_extent(extent)\n# Add colorbar\ngl1 = axes[1].gridlines( draw_labels=True, linewidth=0.5, color='gray', alpha=0.7, linestyle='--')\ngl1.top_labels = False\ngl1.right_labels = False\n\naxes[1].set_title('Exposure:  Population Density Levels - 2019', fontsize=12)\naxes[1].set_xlabel('Longitude [¬∞E]')\naxes[1].set_ylabel('Latitude [¬∞N]')\n\nplt.suptitle('New Zealand 2019 Heatwave', fontsize=14, y=0.97)\nplt.tight_layout()\nplt.show()","key":"IQcrZaiOen"},{"type":"output","id":"lg9s4DqMBmnSZ9lvgaC9T","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a4feb1f6f364764c36a63eff05c0122b","path":"/cci-notebook-viewers/build/a4feb1f6f364764c36a63eff05c0122b.png"},"text/plain":{"content":"\u003cFigure size 1200x600 with 4 Axes\u003e","content_type":"text/plain"}}}],"key":"HdW22DXBxr"}],"key":"PuUB81XnVZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Reclassifying LST and population density for risk maps","key":"xbiZgoIskg"},{"type":"output","id":"cQNlB0hcuj0hIZOTXoR7A","data":[],"key":"JnEWmCpqX1"}],"key":"NwYzyWL2ce"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Define classes for grouping LST data\n#low : , medium: , high: \n#LST levels \n\n#very low \u003c 20 value 1 \n#low \u003c 20-30¬∞C value 2 \n#Medium 30-35 ¬∞C value 3 \n#High \u003c35¬∞ - 40¬∞C value 4  \n#Very High 40‚Äì50\t5\n#Extreme \u003e50¬∞  value 6\nlst_bins   = [20, 30, 35, 40, 50]\nlst_values = [1, 2, 3, 4, 5]","key":"oLfx1bIO9O"},{"type":"output","id":"9DoaNqq_WZOEoYFRIx9g8","data":[],"key":"yTwFhwCR6o"}],"key":"lXySnwCTE1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Function to reclassify data to match each value ranges to a level of risk\ndef reclassify_with_numpy_ge(array, bins, new_values):\n    reclassified_array = np.zeros_like(array)\n    reclassified_array[array \u003c bins[0]] = new_values[0]  # below first bin\n    for i in range(len(bins) - 1):\n        reclassified_array[(array \u003e= bins[i]) \u0026 (array \u003c bins[i + 1])] = new_values[i]\n    reclassified_array[array \u003e= bins[-1]] = new_values[-1]  # above last bin\n    return reclassified_array","key":"fDzRD5GS3d"},{"type":"output","id":"62CwruFrgusKrAKa71cL-","data":[],"key":"t9GRlQojTq"}],"key":"Jspxvi1X5T"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Apply the reclassification function\nlst_class = reclassify_with_numpy_ge(lst_19_j.values, bins=lst_bins, new_values=lst_values)","key":"VlYFvK8VKw"},{"type":"output","id":"-c8HY7gnoaX9fGGkOwtmy","data":[],"key":"M2nyzMrmMS"}],"key":"q9EM8EnG2i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Convert the reclassified array back to xarray DataArray for plotting\nlst_class_da = xr.DataArray(lst_class, coords=lst_19_j.coords, dims=lst_19_j.dims)","key":"YmiiqfLNZD"},{"type":"output","id":"w9yLyBz06oEDjIwXsL2i8","data":[],"key":"Wn2Z9wqZF2"}],"key":"EIbTuSIQ7U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cmap = plt.get_cmap('YlOrRd', 5) \n\n\nfig, ax = plt.subplots(figsize=(8,6), subplot_kw={\"projection\": ccrs.PlateCarree()})\n\n# Plot the data\nplot_lst= lst_class_da.plot(ax=ax, cmap=cmap, vmin=1, vmax=5, transform=ccrs.PlateCarree() , add_colorbar=False)\n\n# Add New Zealand coastlines\nax.add_feature(cfeature.COASTLINE, linewidth=1)\nax.add_feature(cfeature.BORDERS, linestyle=':')\nax.set_ylim(lat_min,lat_max)\nax.set_xlim(lon_min,lon_max)\n\n# Colorbar\ncbar = fig.colorbar(plot_lst, ticks=[1.25, 3., 4.25])\ncbar.ax.set_yticklabels(['Low', 'Medium', 'Very High'], size=10)\n\n#very low \u003c 20 value 1 \n#low \u003c 20-30¬∞C value 2 \n#Medium 30-40 ¬∞C value 3 \n#High \u003c40¬∞ - 50¬∞C value 4  \n#Very High 50‚Äì55\t5\n#Extreme \u003e55¬∞  value 6\n\n# Add gridlines with labels\ngrid = ax.gridlines(draw_labels=True, crs=ccrs.PlateCarree(), linewidth=0.5, color='gray', alpha=0.7, linestyle='--')\ngrid.top_labels = False\ngrid.right_labels = False\n\nax.set_xlabel('lon [deg_east]')\nax.set_ylabel('lat [deg_north]')\nplt.title('LST Levels during January 2019', size=12)\nplt.show()","key":"a7bhXhxjvY"},{"type":"output","id":"cg1FdhrXxXcVSH6JAs7px","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fc3529ebe7d352271c45f058fb85f816","path":"/cci-notebook-viewers/build/fc3529ebe7d352271c45f058fb85f816.png"},"text/plain":{"content":"\u003cFigure size 800x600 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"sTY3BErzmv"}],"key":"kpCmbOkMEA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Reclassifying Population Density for risk maps","key":"PfH4iTZcyZ"},{"type":"output","id":"FBa4IsnhYSfP2eqQ_gJU4","data":[],"key":"NBaMnz0hcM"}],"key":"FS2aVOjvVF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#defining level ranges for population density \npop_bins = [0, 50, 100, 1000, 10000]  # Effect on the human health\npop_values = [1, 2, 3, 4, 5]","key":"ixFD63NM0F"},{"type":"output","id":"-QnwZDiqFvAdCaCDahzgr","data":[],"key":"Jcr5Sq5QiZ"}],"key":"npwxUgg1ZX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Apply the reclassification function\npop_class = reclassify_with_numpy_ge(pop_da_matched, bins=pop_bins, new_values=pop_values)","key":"o0MB9isku6"},{"type":"output","id":"Ay9ZYvLj2FaUCBofUNPBL","data":[],"key":"AdbHdkbMcl"}],"key":"jLK2dlMIIm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Creating an xarray for population density classified\npop_class_da = xr.DataArray(pop_class, coords=lst_19_j.coords, dims=lst_19_j.dims)","key":"eziNx1wm0w"},{"type":"output","id":"Ft1RIPGcLXkUPvQMTHwD2","data":[],"key":"HUCScl90qt"}],"key":"UWzQCqx7tt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cmap = plt.get_cmap('YlOrBr', 5) \nfig, ax = plt.subplots(figsize=(8,6), subplot_kw={\"projection\": ccrs.PlateCarree()})\nplot_pop= pop_class_da.plot(ax=ax, cmap=cmap, vmin=1, vmax=5, transform=ccrs.PlateCarree(),  add_colorbar=False,)\n\ncbar = fig.colorbar(plot_pop, ticks=[1.25, 3., 4.25])\ncbar.ax.set_yticklabels(['Low', 'Medium', 'Very High'], size=10)\n\n# Add New Zealand coastlines\nax.add_feature(cfeature.COASTLINE, linewidth=1)\nax.add_feature(cfeature.BORDERS, linestyle=':')\nax.set_ylim(lat_min,lat_max)\nax.set_xlim(lon_min,lon_max)\n\n# Add gridlines with labels\ngrid = ax.gridlines(draw_labels=True, crs=ccrs.PlateCarree(), linewidth=0.5, color='gray', alpha=0.7, linestyle='--')\ngrid.top_labels = False\ngrid.right_labels = False\n\nplt.title(\"Population Density\")\nplt.tight_layout()\nplt.show()","key":"XAY90jLANR"},{"type":"output","id":"bdpk326FNJgqR1v3rzSZr","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fde479484cdc741d59ab0d30974b6a98","path":"/cci-notebook-viewers/build/fde479484cdc741d59ab0d30974b6a98.png"},"text/plain":{"content":"\u003cFigure size 800x600 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"sQCkQyyhFh"}],"key":"uU2rXlPrWo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Risk exposure to heat\nrisk_map = lst_class_da + pop_class\nrisk_map","key":"J6IUgjgQmg"},{"type":"output","id":"1BZc95-zIH8TBvYaohfDo","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\u003csvg style=\"position: absolute; width: 0; height: 0; overflow: hidden\"\u003e\n\u003cdefs\u003e\n\u003csymbol id=\"icon-database\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003csymbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003c/defs\u003e\n\u003c/svg\u003e\n\u003cstyle\u003e/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header \u003e div,\n.xr-header \u003e ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary \u003e span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"‚ñ∫\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"‚ñº\";\n}\n\n.xr-section-summary-in:checked + label \u003e span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap \u003e label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item \u003e div,\n.xr-var-item label,\n.xr-var-item \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item \u003e .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list \u003e li:nth-child(odd) \u003e div,\n.xr-var-list \u003e li:nth-child(odd) \u003e label,\n.xr-var-list \u003e li:nth-child(odd) \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data \u003e table {\n  float: right;\n}\n\n.xr-var-data \u003e pre,\n.xr-index-data \u003e pre,\n.xr-var-data \u003e table \u003e tbody \u003e tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label \u003e .xr-icon-file-text2,\n.xr-var-data-in:checked + label \u003e .xr-icon-database,\n.xr-index-data-in:checked + label \u003e .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n\u003c/style\u003e\u003cpre class='xr-text-repr-fallback'\u003e\u0026lt;xarray.DataArray (lat: 857, lon: 882)\u0026gt; Size: 6MB\narray([[1., 1., 1., ..., 1., 1., 1.],\n       [1., 1., 1., ..., 1., 1., 1.],\n       [1., 1., 1., ..., 1., 1., 1.],\n       ...,\n       [1., 1., 1., ..., 2., 2., 2.],\n       [1., 1., 1., ..., 2., 2., 2.],\n       [1., 1., 1., ..., 2., 2., 2.]], shape=(857, 882))\nCoordinates:\n  * lat          (lat) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.24 -39.22\n  * lon          (lon) float32 4kB 166.1 166.1 166.1 166.1 ... 174.9 174.9 174.9\n    time         datetime64[ns] 8B 2019-01-01\n    spatial_ref  int64 8B 0\u003c/pre\u003e\u003cdiv class='xr-wrap' style='display:none'\u003e\u003cdiv class='xr-header'\u003e\u003cdiv class='xr-obj-type'\u003exarray.DataArray\u003c/div\u003e\u003cdiv class='xr-array-name'\u003e\u003c/div\u003e\u003cul class='xr-dim-list'\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003elat\u003c/span\u003e: 857\u003c/li\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003elon\u003c/span\u003e: 882\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003cul class='xr-sections'\u003e\u003cli class='xr-section-item'\u003e\u003cdiv class='xr-array-wrap'\u003e\u003cinput id='section-7e0ef64f-c206-451f-b499-0510bb034ba0' class='xr-array-in' type='checkbox' checked\u003e\u003clabel for='section-7e0ef64f-c206-451f-b499-0510bb034ba0' title='Show/hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-array-preview xr-preview'\u003e\u003cspan\u003e1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 ... 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-array-data'\u003e\u003cpre\u003earray([[1., 1., 1., ..., 1., 1., 1.],\n       [1., 1., 1., ..., 1., 1., 1.],\n       [1., 1., 1., ..., 1., 1., 1.],\n       ...,\n       [1., 1., 1., ..., 2., 2., 2.],\n       [1., 1., 1., ..., 2., 2., 2.],\n       [1., 1., 1., ..., 2., 2., 2.]], shape=(857, 882))\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-733ae89e-037c-46e9-834a-b3c4553e1b1e' class='xr-section-summary-in' type='checkbox'  checked\u003e\u003clabel for='section-733ae89e-037c-46e9-834a-b3c4553e1b1e' class='xr-section-summary' \u003eCoordinates: \u003cspan\u003e(4)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003elat\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(lat)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003efloat32\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e-47.78 -47.78 ... -39.24 -39.22\u003c/div\u003e\u003cinput id='attrs-8084ad83-ee71-4ef7-8c26-a76f2a70f810' class='xr-var-attrs-in' type='checkbox' \u003e\u003clabel for='attrs-8084ad83-ee71-4ef7-8c26-a76f2a70f810' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-e8d7418d-cc61-4b5f-ba93-aea35163f39e' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-e8d7418d-cc61-4b5f-ba93-aea35163f39e' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003cdt\u003e\u003cspan\u003elong_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003elatitude_coordinates\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003ereference_datum :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003egeographical coordinates, WGS84 projection\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003estandard_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003elatitude\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003eunits :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003edegrees_north\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003evalid_max :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e90.0\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003evalid_min :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e-90.0\u003c/dd\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([-47.785, -47.775, -47.765, ..., -39.245, -39.235, -39.225],\n      shape=(857,), dtype=float32)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003elon\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(lon)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003efloat32\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e166.1 166.1 166.1 ... 174.9 174.9\u003c/div\u003e\u003cinput id='attrs-e375e461-c75c-42e8-ba05-b3c927cbb9a7' class='xr-var-attrs-in' type='checkbox' \u003e\u003clabel for='attrs-e375e461-c75c-42e8-ba05-b3c927cbb9a7' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-3c618ec0-0e84-493e-ab6e-ba4bd9cba4a9' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-3c618ec0-0e84-493e-ab6e-ba4bd9cba4a9' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003cdt\u003e\u003cspan\u003elong_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003elongitude_coordinates\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003ereference_datum :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003egeographical coordinates, WGS84 projection\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003estandard_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003elongitude\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003eunits :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003edegrees_east\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003evalid_max :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e180.0\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003evalid_min :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e-180.0\u003c/dd\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([166.095  , 166.10501, 166.11499, ..., 174.88501, 174.89499, 174.905  ],\n      shape=(882,), dtype=float32)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan\u003etime\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e()\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003edatetime64[ns]\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e2019-01-01\u003c/div\u003e\u003cinput id='attrs-4b2ff06f-4ba5-48b5-9f85-d9570ac9825e' class='xr-var-attrs-in' type='checkbox' \u003e\u003clabel for='attrs-4b2ff06f-4ba5-48b5-9f85-d9570ac9825e' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-21ca9135-0d8c-4b43-b724-78e062c92597' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-21ca9135-0d8c-4b43-b724-78e062c92597' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003cdt\u003e\u003cspan\u003elong_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003ereference time of file\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003estandard_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003etime\u003c/dd\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray(\u0026#x27;2019-01-01T00:00:00.000000000\u0026#x27;, dtype=\u0026#x27;datetime64[ns]\u0026#x27;)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan\u003espatial_ref\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e()\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003eint64\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e0\u003c/div\u003e\u003cinput id='attrs-d41ba0b3-abd1-492f-bf06-a30cd5f4c4f6' class='xr-var-attrs-in' type='checkbox' \u003e\u003clabel for='attrs-d41ba0b3-abd1-492f-bf06-a30cd5f4c4f6' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-1e7ec7f6-2c23-45c4-bec3-c3d0f6b1e6ce' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-1e7ec7f6-2c23-45c4-bec3-c3d0f6b1e6ce' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003cdt\u003e\u003cspan\u003ecrs_wkt :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eGEOGCS[\u0026quot;WGS 84\u0026quot;,DATUM[\u0026quot;WGS_1984\u0026quot;,SPHEROID[\u0026quot;WGS 84\u0026quot;,6378137,298.257223563,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;7030\u0026quot;]],AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;6326\u0026quot;]],PRIMEM[\u0026quot;Greenwich\u0026quot;,0,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;8901\u0026quot;]],UNIT[\u0026quot;degree\u0026quot;,0.0174532925199433,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;9122\u0026quot;]],AXIS[\u0026quot;Latitude\u0026quot;,NORTH],AXIS[\u0026quot;Longitude\u0026quot;,EAST],AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;4326\u0026quot;]]\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003esemi_major_axis :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e6378137.0\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003esemi_minor_axis :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e6356752.314245179\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003einverse_flattening :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e298.257223563\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003ereference_ellipsoid_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eWGS 84\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003elongitude_of_prime_meridian :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003e0.0\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003eprime_meridian_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eGreenwich\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003egeographic_crs_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eWGS 84\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003ehorizontal_datum_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eWorld Geodetic System 1984\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003egrid_mapping_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003elatitude_longitude\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003espatial_ref :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003eGEOGCS[\u0026quot;WGS 84\u0026quot;,DATUM[\u0026quot;WGS_1984\u0026quot;,SPHEROID[\u0026quot;WGS 84\u0026quot;,6378137,298.257223563,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;7030\u0026quot;]],AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;6326\u0026quot;]],PRIMEM[\u0026quot;Greenwich\u0026quot;,0,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;8901\u0026quot;]],UNIT[\u0026quot;degree\u0026quot;,0.0174532925199433,AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;9122\u0026quot;]],AXIS[\u0026quot;Latitude\u0026quot;,NORTH],AXIS[\u0026quot;Longitude\u0026quot;,EAST],AUTHORITY[\u0026quot;EPSG\u0026quot;,\u0026quot;4326\u0026quot;]]\u003c/dd\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray(0)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-b87a4a1b-5779-4e3a-86b3-4526f7b38d3d' class='xr-section-summary-in' type='checkbox'  \u003e\u003clabel for='section-b87a4a1b-5779-4e3a-86b3-4526f7b38d3d' class='xr-section-summary' \u003eIndexes: \u003cspan\u003e(2)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003elat\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-70c4be6b-2cc3-4efb-b4ba-f5f6b30aac0e' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-70c4be6b-2cc3-4efb-b4ba-f5f6b30aac0e' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(Index([ -47.78499984741211, -47.775001525878906,  -47.76499938964844,\n       -47.755001068115234, -47.744998931884766,  -47.73500061035156,\n       -47.724998474121094,  -47.71500015258789,  -47.70499801635742,\n        -47.69499969482422,\n       ...\n       -39.314998626708984,  -39.30500030517578,  -39.29499816894531,\n        -39.28499984741211, -39.275001525878906,  -39.26499938964844,\n       -39.255001068115234, -39.244998931884766,  -39.23500061035156,\n       -39.224998474121094],\n      dtype=\u0026#x27;float32\u0026#x27;, name=\u0026#x27;lat\u0026#x27;, length=857))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003elon\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-0df50217-7eaf-4139-bfee-4bdcd0af366b' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-0df50217-7eaf-4139-bfee-4bdcd0af366b' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(Index([166.09500122070312, 166.10501098632812,   166.114990234375,\n                  166.125,   166.135009765625, 166.14498901367188,\n       166.15499877929688, 166.16500854492188, 166.17498779296875,\n       166.18499755859375,\n       ...\n       174.81500244140625, 174.82501220703125, 174.83499145507812,\n       174.84500122070312, 174.85501098632812,   174.864990234375,\n                  174.875,   174.885009765625, 174.89498901367188,\n       174.90499877929688],\n      dtype=\u0026#x27;float32\u0026#x27;, name=\u0026#x27;lon\u0026#x27;, length=882))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-dc27300d-7b70-4b03-8a7b-cfaedf6bce72' class='xr-section-summary-in' type='checkbox' disabled \u003e\u003clabel for='section-dc27300d-7b70-4b03-8a7b-cfaedf6bce72' class='xr-section-summary'  title='Expand/collapse section'\u003eAttributes: \u003cspan\u003e(0)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"\u003cxarray.DataArray (lat: 857, lon: 882)\u003e Size: 6MB\narray([[1., 1., 1., ..., 1., 1., 1.],\n       [1., 1., 1., ..., 1., 1., 1.],\n       [1., 1., 1., ..., 1., 1., 1.],\n       ...,\n       [1., 1., 1., ..., 2., 2., 2.],\n       [1., 1., 1., ..., 2., 2., 2.],\n       [1., 1., 1., ..., 2., 2., 2.]], shape=(857, 882))\nCoordinates:\n  * lat          (lat) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.24 -39.22\n  * lon          (lon) float32 4kB 166.1 166.1 166.1 166.1 ... 174.9 174.9 174.9\n    time         datetime64[ns] 8B 2019-01-01\n    spatial_ref  int64 8B 0","content_type":"text/plain"}}}],"key":"Ju7sHtyMAK"}],"key":"uzHyM5Dysr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Now let's plot the risk exposure map showing where high heat coincides with high pop exposure\n#Risk=LST¬†Level+Population¬†Density¬†Level\nfig, ax = plt.subplots(figsize=(8, 6), subplot_kw={\"projection\": ccrs.PlateCarree()})\nrisk_plot= risk_map.plot(ax=ax, vmin=0, vmax=10, cmap=cmap,  add_colorbar=False, transform=ccrs.PlateCarree())\n\ncbar = fig.colorbar(risk_plot, ticks=[2, 5,  10], pad=0.09, shrink=0.8, fraction=0.03) #pad: reduce space between plot/colorbar\ncbar.ax.set_yticklabels([ 'Low', 'Medium', 'Very high'], size=10)\nax.set_title('Heatwave Risk Exposure Map (Jan 2019)')\nax.add_feature(cfeature.COASTLINE, linewidth=1)\nax.add_feature(cfeature.BORDERS, linestyle=':')\nax.set_extent(extent)\n#PLot around Christchurch only:\n#ax.set_extent([172.3, 173.8, -44, -43.2], crs=ccrs.PlateCarree())\nax.gridlines(draw_labels=True, linewidth=0.3, color='gray', alpha=0.5, linestyle='--')\n\nplt.tight_layout()\n\nplt.savefig('risk_map.png')\nplt.show()","key":"AGhrHSRL7A"},{"type":"output","id":"5bkffvh0SAM81z_Q7b92F","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3a9ae3650431238f712acada62ed7e95","path":"/cci-notebook-viewers/build/3a9ae3650431238f712acada62ed7e95.png"},"text/plain":{"content":"\u003cFigure size 800x600 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"OiYP4iAq4N"}],"key":"ACNq7mniYN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Zoom into Christchurch:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vhf9EI0wYc"}],"key":"nAvfiN38DN"}],"key":"DK8EZVgan5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Now let's plot the risk exposure map showing where high heat coincides with high pop exposure\nfig, ax = plt.subplots(figsize=(8, 6), subplot_kw={\"projection\": ccrs.PlateCarree()})\nrisk_plot= risk_map.plot(ax=ax, vmin=0, vmax=10, cmap=cmap,  add_colorbar=False, transform=ccrs.PlateCarree())\n\ncbar = fig.colorbar(risk_plot, ticks=[2, 5,  10], pad=0.09, shrink=0.8, fraction=0.03) #pad: reduce space between plot/colorbar\ncbar.ax.set_yticklabels([ 'Low', 'Medium', 'Very high'], size=10)\nax.set_title('Heatwave Risk Exposure Map (Jan 2019)')\nax.add_feature(cfeature.COASTLINE, linewidth=1)\nax.add_feature(cfeature.BORDERS, linestyle=':')\n#ax.set_extent(extent)\n#PLot around Christchurch only:\nax.set_extent([172.3, 173.8, -44, -43.2], crs=ccrs.PlateCarree())\nax.gridlines(draw_labels=True, linewidth=0.3, color='gray', alpha=0.5, linestyle='--')\n\nplt.tight_layout()\n\nplt.savefig('risk_map_Christchurch.png')\nplt.show()","key":"XvJUzXSrzJ"},{"type":"output","id":"kjxO7ZLLZa5OQSAZgOADZ","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d457e6d584a759c646d9f3ecb3963a34","path":"/cci-notebook-viewers/build/d457e6d584a759c646d9f3ecb3963a34.png"},"text/plain":{"content":"\u003cFigure size 800x600 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"BRe5V2zg0t"}],"key":"KmoSn46HRu"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"span","style":{"color":"blue"},"children":[{"type":"text","value":"‚Üí How to save the dataset","key":"XsB7tnD4so"}],"key":"wzjjNOsGqy"}],"identifier":"id-how-to-save-the-dataset","label":"‚Üí How to save the dataset","html_id":"id-how-to-save-the-dataset","implicit":true,"key":"EvXKUiynvj"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We created a datarray file regridded on the LST grid from the population TIF dataset.\nYou can also save this dataset in your folder either as NetCDF or Zarr file like this:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xnyrMx7GHi"}],"key":"DCY1STSAnY"},{"type":"code","lang":"","value":"# For NetCDF\npop_dens.to_netcdf(\"population_density_2020.nc\")\n\n# For Zarr\npop_dens.to_zarr(\"population_density_2020.zarr\")","position":{"start":{"line":6,"column":1},"end":{"line":12,"column":1}},"key":"ZwMEsk3p7j"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"‚Üí see next cell, where you can uncomment the command.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"X455BLjpOF"}],"key":"wSqf3S7vkX"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"span","style":{"color":"blue"},"children":[{"type":"strong","children":[{"type":"text","value":"PLEASE NOTE","key":"PpNVKQ57Ts"}],"key":"EcsRCtCpXM"},{"type":"text","value":" : The data is very large, please ensure you have enough space to save it.","key":"EJ6FNCkFrA"}],"key":"EqZu0ritsi"}],"key":"DyNr3JRBQZ"}],"key":"Na4d16FtO9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# For NetCDF\n#pop_dens.to_netcdf(\"population_density_2020.nc\")\n\n# For Zarr\n#pop_dens.to_zarr(\"population_density_2020.zarr\")","key":"PsVsA3Gr5n"},{"type":"output","id":"zRXeRjyTiNFWEE5r8GFEJ","data":[],"key":"VB4h4eZW51"}],"key":"iIGkBxNexJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let‚Äôs plot the time series of LST over Christchurch","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f9zVfIz68U"}],"key":"vKlFRlKn3k"}],"key":"o6ZNZYLpSn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#LST over CHristchurch\nlat_min = -44\nlat_max = -43.2\nlon_min = 172.3\nlon_max = 173.8\nbbox = (lon_min, lat_min, lon_max, lat_max) \nsubset_spatial_op = get_op('subset_spatial')\nlst_ds_C = subset_spatial_op(ds=lst_ds, region=bbox)\nlst_ds_C","key":"I3zSUP9Ies"},{"type":"output","id":"y-XBRvyaUGh9JXedSh-oA","data":[{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"9997be65499699b34e5292227f2625de","path":"/cci-notebook-viewers/build/9997be65499699b34e5292227f2625de.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 349MB\nDimensions:          (time: 294, lat: 82, lon: 151, length_scale: 294,\n                      channel: 2)\nCoordinates:\n  * channel          (channel) float64 16B 11.0 12.0\n  * lat              (lat) float32 328B -44.01 -43.99 -43.99 ... -43.21 -43.19\n  * lon              (lon) float32 604B 172.3 172.3 172.3 ... 173.8 173.8 173.8\n  * time             (time) datetime64[ns] 2kB 1995-08-01 ... 2020-12-01\nDimensions without coordinates: length_scale\nData variables: (12/14)\n    dtime            (time, lat, lon) timedelta64[ns] 29MB dask.array\u003cchunksize=(1, 82, 151), meta=np.ndarray\u003e\n    lcc              (time, lat, lon) float32 15MB dask.array\u003cchunksize=(1, 82, 151), meta=np.ndarray\u003e\n    lst              (time, lat, lon) float64 29MB dask.array\u003cchunksize=(1, 82, 151), meta=np.ndarray\u003e\n    lst_unc_loc_atm  (time, lat, lon) float64 29MB dask.array\u003cchunksize=(1, 82, 151), meta=np.ndarray\u003e\n    lst_unc_loc_cor  (time, lat, lon) float64 29MB dask.array\u003cchunksize=(1, 82, 151), meta=np.ndarray\u003e\n    lst_unc_loc_sfc  (time, lat, lon) float64 29MB dask.array\u003cchunksize=(1, 82, 151), meta=np.ndarray\u003e\n    ...               ...\n    lst_uncertainty  (time, lat, lon) float64 29MB dask.array\u003cchunksize=(1, 82, 151), meta=np.ndarray\u003e\n    n                (time, lat, lon) float32 15MB dask.array\u003cchunksize=(1, 82, 151), meta=np.ndarray\u003e\n    sataz            (time, lat, lon) float64 29MB dask.array\u003cchunksize=(1, 82, 151), meta=np.ndarray\u003e\n    satze            (time, lat, lon) float64 29MB dask.array\u003cchunksize=(1, 82, 151), meta=np.ndarray\u003e\n    solaz            (time, lat, lon) float64 29MB dask.array\u003cchunksize=(1, 82, 151), meta=np.ndarray\u003e\n    solze            (time, lat, lon) float64 29MB dask.array\u003cchunksize=(1, 82, 151), meta=np.ndarray\u003e\nAttributes: (12/44)\n    Conventions:                CF-1.8\n    catalogue_url:              https://catalogue.ceda.ac.uk/uuid/6babb8d9a8d...\n    cdm_data_type:              grid\n    comment:                    These data were produced as part of the ESA L...\n    creator_email:              djg20@le.ac.uk\n    creator_name:               University of Leicester Surface Temperature G...\n    ...                         ...\n    time_coverage_end:          19700101T000001Z\n    time_coverage_resolution:   P1M\n    time_coverage_start:        19700101T000001Z\n    title:                      ESA LST CCI land surface temperature time ser...\n    geospatial_bounds_crs:      CRS84\n    geospatial_bounds:          POLYGON((172.29998779296875 -44.0100021362304...","content_type":"text/plain"}}}],"key":"Lx0PZJfDDY"}],"key":"AvRnOBYD27"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#average LST around Christchurch area\nlst_ds_C_mean=lst_ds_C.lst.mean(dim=('lat','lon'))","key":"nDO531u962"},{"type":"output","id":"dBbEpCpzVn3uO7dKP2jRQ","data":[],"key":"pMiMaJyY2O"}],"key":"LObvIdGSmk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lst_ds_C_mean","key":"nyDkIJExY8"},{"type":"output","id":"0rrW9ESRDBh5zAVAdv0Wg","data":[{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\u003csvg style=\"position: absolute; width: 0; height: 0; overflow: hidden\"\u003e\n\u003cdefs\u003e\n\u003csymbol id=\"icon-database\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003csymbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003c/defs\u003e\n\u003c/svg\u003e\n\u003cstyle\u003e/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header \u003e div,\n.xr-header \u003e ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary \u003e span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"‚ñ∫\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"‚ñº\";\n}\n\n.xr-section-summary-in:checked + label \u003e span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap \u003e label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item \u003e div,\n.xr-var-item label,\n.xr-var-item \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item \u003e .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list \u003e li:nth-child(odd) \u003e div,\n.xr-var-list \u003e li:nth-child(odd) \u003e label,\n.xr-var-list \u003e li:nth-child(odd) \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data \u003e table {\n  float: right;\n}\n\n.xr-var-data \u003e pre,\n.xr-index-data \u003e pre,\n.xr-var-data \u003e table \u003e tbody \u003e tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label \u003e .xr-icon-file-text2,\n.xr-var-data-in:checked + label \u003e .xr-icon-database,\n.xr-index-data-in:checked + label \u003e .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n\u003c/style\u003e\u003cpre class='xr-text-repr-fallback'\u003e\u0026lt;xarray.DataArray \u0026#x27;lst\u0026#x27; (time: 294)\u0026gt; Size: 2kB\ndask.array\u0026lt;mean_agg-aggregate, shape=(294,), dtype=float64, chunksize=(1,), chunktype=numpy.ndarray\u0026gt;\nCoordinates:\n  * time     (time) datetime64[ns] 2kB 1995-08-01 1995-09-01 ... 2020-12-01\u003c/pre\u003e\u003cdiv class='xr-wrap' style='display:none'\u003e\u003cdiv class='xr-header'\u003e\u003cdiv class='xr-obj-type'\u003exarray.DataArray\u003c/div\u003e\u003cdiv class='xr-array-name'\u003e'lst'\u003c/div\u003e\u003cul class='xr-dim-list'\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003etime\u003c/span\u003e: 294\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003cul class='xr-sections'\u003e\u003cli class='xr-section-item'\u003e\u003cdiv class='xr-array-wrap'\u003e\u003cinput id='section-bef49c7a-3762-40c1-80be-1518b69f36fd' class='xr-array-in' type='checkbox' checked\u003e\u003clabel for='section-bef49c7a-3762-40c1-80be-1518b69f36fd' title='Show/hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-array-preview xr-preview'\u003e\u003cspan\u003edask.array\u0026lt;chunksize=(1,), meta=np.ndarray\u0026gt;\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-array-data'\u003e\u003ctable\u003e\n    \u003ctr\u003e\n        \u003ctd\u003e\n            \u003ctable style=\"border-collapse: collapse;\"\u003e\n                \u003cthead\u003e\n                    \u003ctr\u003e\n                        \u003ctd\u003e \u003c/td\u003e\n                        \u003cth\u003e Array \u003c/th\u003e\n                        \u003cth\u003e Chunk \u003c/th\u003e\n                    \u003c/tr\u003e\n                \u003c/thead\u003e\n                \u003ctbody\u003e\n                    \n                    \u003ctr\u003e\n                        \u003cth\u003e Bytes \u003c/th\u003e\n                        \u003ctd\u003e 2.30 kiB \u003c/td\u003e\n                        \u003ctd\u003e 8 B \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \n                    \u003ctr\u003e\n                        \u003cth\u003e Shape \u003c/th\u003e\n                        \u003ctd\u003e (294,) \u003c/td\u003e\n                        \u003ctd\u003e (1,) \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003e Dask graph \u003c/th\u003e\n                        \u003ctd colspan=\"2\"\u003e 294 chunks in 5 graph layers \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003e Data type \u003c/th\u003e\n                        \u003ctd colspan=\"2\"\u003e float64 numpy.ndarray \u003c/td\u003e\n                    \u003c/tr\u003e\n                \u003c/tbody\u003e\n            \u003c/table\u003e\n        \u003c/td\u003e\n        \u003ctd\u003e\n        \u003csvg width=\"170\" height=\"75\" style=\"stroke:rgb(0,0,0);stroke-width:1\" \u003e\n\n  \u003c!-- Horizontal lines --\u003e\n  \u003cline x1=\"0\" y1=\"0\" x2=\"120\" y2=\"0\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"0\" y1=\"25\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Vertical lines --\u003e\n  \u003cline x1=\"0\" y1=\"0\" x2=\"0\" y2=\"25\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"6\" y1=\"0\" x2=\"6\" y2=\"25\" /\u003e\n  \u003cline x1=\"12\" y1=\"0\" x2=\"12\" y2=\"25\" /\u003e\n  \u003cline x1=\"18\" y1=\"0\" x2=\"18\" y2=\"25\" /\u003e\n  \u003cline x1=\"24\" y1=\"0\" x2=\"24\" y2=\"25\" /\u003e\n  \u003cline x1=\"31\" y1=\"0\" x2=\"31\" y2=\"25\" /\u003e\n  \u003cline x1=\"37\" y1=\"0\" x2=\"37\" y2=\"25\" /\u003e\n  \u003cline x1=\"44\" y1=\"0\" x2=\"44\" y2=\"25\" /\u003e\n  \u003cline x1=\"50\" y1=\"0\" x2=\"50\" y2=\"25\" /\u003e\n  \u003cline x1=\"56\" y1=\"0\" x2=\"56\" y2=\"25\" /\u003e\n  \u003cline x1=\"62\" y1=\"0\" x2=\"62\" y2=\"25\" /\u003e\n  \u003cline x1=\"69\" y1=\"0\" x2=\"69\" y2=\"25\" /\u003e\n  \u003cline x1=\"75\" y1=\"0\" x2=\"75\" y2=\"25\" /\u003e\n  \u003cline x1=\"82\" y1=\"0\" x2=\"82\" y2=\"25\" /\u003e\n  \u003cline x1=\"88\" y1=\"0\" x2=\"88\" y2=\"25\" /\u003e\n  \u003cline x1=\"94\" y1=\"0\" x2=\"94\" y2=\"25\" /\u003e\n  \u003cline x1=\"100\" y1=\"0\" x2=\"100\" y2=\"25\" /\u003e\n  \u003cline x1=\"107\" y1=\"0\" x2=\"107\" y2=\"25\" /\u003e\n  \u003cline x1=\"113\" y1=\"0\" x2=\"113\" y2=\"25\" /\u003e\n  \u003cline x1=\"120\" y1=\"0\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Colored Rectangle --\u003e\n  \u003cpolygon points=\"0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485\" style=\"fill:#8B4903A0;stroke-width:0\"/\u003e\n\n  \u003c!-- Text --\u003e\n  \u003ctext x=\"60.000000\" y=\"45.412617\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" \u003e294\u003c/text\u003e\n  \u003ctext x=\"140.000000\" y=\"12.706308\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,140.000000,12.706308)\"\u003e1\u003c/text\u003e\n\u003c/svg\u003e\n        \u003c/td\u003e\n    \u003c/tr\u003e\n\u003c/table\u003e\u003c/div\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-8a9ba622-24a9-47d7-bf77-0b14d5a29c94' class='xr-section-summary-in' type='checkbox'  checked\u003e\u003clabel for='section-8a9ba622-24a9-47d7-bf77-0b14d5a29c94' class='xr-section-summary' \u003eCoordinates: \u003cspan\u003e(1)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003etime\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(time)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003edatetime64[ns]\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e1995-08-01 ... 2020-12-01\u003c/div\u003e\u003cinput id='attrs-cda67f33-aacb-46d3-b350-8dea57030826' class='xr-var-attrs-in' type='checkbox' \u003e\u003clabel for='attrs-cda67f33-aacb-46d3-b350-8dea57030826' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-e28f8e21-601e-40e2-b133-6518a852f2cb' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-e28f8e21-601e-40e2-b133-6518a852f2cb' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003cdt\u003e\u003cspan\u003elong_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003ereference time of file\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003estandard_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003etime\u003c/dd\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([\u0026#x27;1995-08-01T00:00:00.000000000\u0026#x27;, \u0026#x27;1995-09-01T00:00:00.000000000\u0026#x27;,\n       \u0026#x27;1995-10-01T00:00:00.000000000\u0026#x27;, ..., \u0026#x27;2020-10-01T00:00:00.000000000\u0026#x27;,\n       \u0026#x27;2020-11-01T00:00:00.000000000\u0026#x27;, \u0026#x27;2020-12-01T00:00:00.000000000\u0026#x27;],\n      shape=(294,), dtype=\u0026#x27;datetime64[ns]\u0026#x27;)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-c8eb0e6c-a808-46b9-b678-cce585709568' class='xr-section-summary-in' type='checkbox'  \u003e\u003clabel for='section-c8eb0e6c-a808-46b9-b678-cce585709568' class='xr-section-summary' \u003eIndexes: \u003cspan\u003e(1)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003etime\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-0d567496-dc3d-41f8-af26-2a4e13a3a6de' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-0d567496-dc3d-41f8-af26-2a4e13a3a6de' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(DatetimeIndex([\u0026#x27;1995-08-01\u0026#x27;, \u0026#x27;1995-09-01\u0026#x27;, \u0026#x27;1995-10-01\u0026#x27;, \u0026#x27;1995-11-01\u0026#x27;,\n               \u0026#x27;1995-12-01\u0026#x27;, \u0026#x27;1996-07-01\u0026#x27;, \u0026#x27;1996-08-01\u0026#x27;, \u0026#x27;1996-09-01\u0026#x27;,\n               \u0026#x27;1996-10-01\u0026#x27;, \u0026#x27;1996-11-01\u0026#x27;,\n               ...\n               \u0026#x27;2020-03-01\u0026#x27;, \u0026#x27;2020-04-01\u0026#x27;, \u0026#x27;2020-05-01\u0026#x27;, \u0026#x27;2020-06-01\u0026#x27;,\n               \u0026#x27;2020-07-01\u0026#x27;, \u0026#x27;2020-08-01\u0026#x27;, \u0026#x27;2020-09-01\u0026#x27;, \u0026#x27;2020-10-01\u0026#x27;,\n               \u0026#x27;2020-11-01\u0026#x27;, \u0026#x27;2020-12-01\u0026#x27;],\n              dtype=\u0026#x27;datetime64[ns]\u0026#x27;, name=\u0026#x27;time\u0026#x27;, length=294, freq=None))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-67d080dc-7c98-4750-99fe-ffb80617dd71' class='xr-section-summary-in' type='checkbox' disabled \u003e\u003clabel for='section-67d080dc-7c98-4750-99fe-ffb80617dd71' class='xr-section-summary'  title='Expand/collapse section'\u003eAttributes: \u003cspan\u003e(0)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"\u003cxarray.DataArray 'lst' (time: 294)\u003e Size: 2kB\ndask.array\u003cmean_agg-aggregate, shape=(294,), dtype=float64, chunksize=(1,), chunktype=numpy.ndarray\u003e\nCoordinates:\n  * time     (time) datetime64[ns] 2kB 1995-08-01 1995-09-01 ... 2020-12-01","content_type":"text/plain"}}}],"key":"PlwU3PDyDW"}],"key":"GnNp7INHe8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(12,3))\n# Define the axes\nax = fig.add_subplot(1,1,1) \n\n# plot the yearly mean\nlst_ds_C_mean.plot(c='crimson',linewidth=1,label='daily',marker='.')\n\n# add the labels for the axes and the title and the legend\nplt.legend()\nplt.grid()\nplt.ylabel('LST (¬∞C)')\nplt.xlabel('Year')\nplt.title(\"Time series of the yearly LST mean around Christchurch (1995-2020)\")\nplt.show()","key":"SO5Quq9W6Z"},{"type":"output","id":"tYB17s68jNk6Rt7M59NCT","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"65b501169713198347dc389cc0a8e4fd","path":"/cci-notebook-viewers/build/65b501169713198347dc389cc0a8e4fd.png"},"text/plain":{"content":"\u003cFigure size 1200x300 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"qTKKPhOHJd"}],"key":"MiQnVomga0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lst_ds_C_mean","key":"y82Nd17H8w"},{"type":"output","id":"3LHSKhFLoA9zY9VABNByl","data":[{"output_type":"execute_result","execution_count":58,"metadata":{},"data":{"text/html":{"content":"\u003cdiv\u003e\u003csvg style=\"position: absolute; width: 0; height: 0; overflow: hidden\"\u003e\n\u003cdefs\u003e\n\u003csymbol id=\"icon-database\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003csymbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\"\u003e\n\u003cpath d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003cpath d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"\u003e\u003c/path\u003e\n\u003c/symbol\u003e\n\u003c/defs\u003e\n\u003c/svg\u003e\n\u003cstyle\u003e/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header \u003e div,\n.xr-header \u003e ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary \u003e span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"‚ñ∫\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"‚ñº\";\n}\n\n.xr-section-summary-in:checked + label \u003e span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap \u003e label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item \u003e div,\n.xr-var-item label,\n.xr-var-item \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item \u003e .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list \u003e li:nth-child(odd) \u003e div,\n.xr-var-list \u003e li:nth-child(odd) \u003e label,\n.xr-var-list \u003e li:nth-child(odd) \u003e .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data \u003e table {\n  float: right;\n}\n\n.xr-var-data \u003e pre,\n.xr-index-data \u003e pre,\n.xr-var-data \u003e table \u003e tbody \u003e tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label \u003e .xr-icon-file-text2,\n.xr-var-data-in:checked + label \u003e .xr-icon-database,\n.xr-index-data-in:checked + label \u003e .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n\u003c/style\u003e\u003cpre class='xr-text-repr-fallback'\u003e\u0026lt;xarray.DataArray \u0026#x27;lst\u0026#x27; (time: 294)\u0026gt; Size: 2kB\ndask.array\u0026lt;mean_agg-aggregate, shape=(294,), dtype=float64, chunksize=(1,), chunktype=numpy.ndarray\u0026gt;\nCoordinates:\n  * time     (time) datetime64[ns] 2kB 1995-08-01 1995-09-01 ... 2020-12-01\u003c/pre\u003e\u003cdiv class='xr-wrap' style='display:none'\u003e\u003cdiv class='xr-header'\u003e\u003cdiv class='xr-obj-type'\u003exarray.DataArray\u003c/div\u003e\u003cdiv class='xr-array-name'\u003e'lst'\u003c/div\u003e\u003cul class='xr-dim-list'\u003e\u003cli\u003e\u003cspan class='xr-has-index'\u003etime\u003c/span\u003e: 294\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003cul class='xr-sections'\u003e\u003cli class='xr-section-item'\u003e\u003cdiv class='xr-array-wrap'\u003e\u003cinput id='section-c50a80e9-189d-497d-a1f8-c93deb9f938b' class='xr-array-in' type='checkbox' checked\u003e\u003clabel for='section-c50a80e9-189d-497d-a1f8-c93deb9f938b' title='Show/hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-array-preview xr-preview'\u003e\u003cspan\u003edask.array\u0026lt;chunksize=(1,), meta=np.ndarray\u0026gt;\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-array-data'\u003e\u003ctable\u003e\n    \u003ctr\u003e\n        \u003ctd\u003e\n            \u003ctable style=\"border-collapse: collapse;\"\u003e\n                \u003cthead\u003e\n                    \u003ctr\u003e\n                        \u003ctd\u003e \u003c/td\u003e\n                        \u003cth\u003e Array \u003c/th\u003e\n                        \u003cth\u003e Chunk \u003c/th\u003e\n                    \u003c/tr\u003e\n                \u003c/thead\u003e\n                \u003ctbody\u003e\n                    \n                    \u003ctr\u003e\n                        \u003cth\u003e Bytes \u003c/th\u003e\n                        \u003ctd\u003e 2.30 kiB \u003c/td\u003e\n                        \u003ctd\u003e 8 B \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \n                    \u003ctr\u003e\n                        \u003cth\u003e Shape \u003c/th\u003e\n                        \u003ctd\u003e (294,) \u003c/td\u003e\n                        \u003ctd\u003e (1,) \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003e Dask graph \u003c/th\u003e\n                        \u003ctd colspan=\"2\"\u003e 294 chunks in 5 graph layers \u003c/td\u003e\n                    \u003c/tr\u003e\n                    \u003ctr\u003e\n                        \u003cth\u003e Data type \u003c/th\u003e\n                        \u003ctd colspan=\"2\"\u003e float64 numpy.ndarray \u003c/td\u003e\n                    \u003c/tr\u003e\n                \u003c/tbody\u003e\n            \u003c/table\u003e\n        \u003c/td\u003e\n        \u003ctd\u003e\n        \u003csvg width=\"170\" height=\"75\" style=\"stroke:rgb(0,0,0);stroke-width:1\" \u003e\n\n  \u003c!-- Horizontal lines --\u003e\n  \u003cline x1=\"0\" y1=\"0\" x2=\"120\" y2=\"0\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"0\" y1=\"25\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Vertical lines --\u003e\n  \u003cline x1=\"0\" y1=\"0\" x2=\"0\" y2=\"25\" style=\"stroke-width:2\" /\u003e\n  \u003cline x1=\"6\" y1=\"0\" x2=\"6\" y2=\"25\" /\u003e\n  \u003cline x1=\"12\" y1=\"0\" x2=\"12\" y2=\"25\" /\u003e\n  \u003cline x1=\"18\" y1=\"0\" x2=\"18\" y2=\"25\" /\u003e\n  \u003cline x1=\"24\" y1=\"0\" x2=\"24\" y2=\"25\" /\u003e\n  \u003cline x1=\"31\" y1=\"0\" x2=\"31\" y2=\"25\" /\u003e\n  \u003cline x1=\"37\" y1=\"0\" x2=\"37\" y2=\"25\" /\u003e\n  \u003cline x1=\"44\" y1=\"0\" x2=\"44\" y2=\"25\" /\u003e\n  \u003cline x1=\"50\" y1=\"0\" x2=\"50\" y2=\"25\" /\u003e\n  \u003cline x1=\"56\" y1=\"0\" x2=\"56\" y2=\"25\" /\u003e\n  \u003cline x1=\"62\" y1=\"0\" x2=\"62\" y2=\"25\" /\u003e\n  \u003cline x1=\"69\" y1=\"0\" x2=\"69\" y2=\"25\" /\u003e\n  \u003cline x1=\"75\" y1=\"0\" x2=\"75\" y2=\"25\" /\u003e\n  \u003cline x1=\"82\" y1=\"0\" x2=\"82\" y2=\"25\" /\u003e\n  \u003cline x1=\"88\" y1=\"0\" x2=\"88\" y2=\"25\" /\u003e\n  \u003cline x1=\"94\" y1=\"0\" x2=\"94\" y2=\"25\" /\u003e\n  \u003cline x1=\"100\" y1=\"0\" x2=\"100\" y2=\"25\" /\u003e\n  \u003cline x1=\"107\" y1=\"0\" x2=\"107\" y2=\"25\" /\u003e\n  \u003cline x1=\"113\" y1=\"0\" x2=\"113\" y2=\"25\" /\u003e\n  \u003cline x1=\"120\" y1=\"0\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" /\u003e\n\n  \u003c!-- Colored Rectangle --\u003e\n  \u003cpolygon points=\"0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485\" style=\"fill:#8B4903A0;stroke-width:0\"/\u003e\n\n  \u003c!-- Text --\u003e\n  \u003ctext x=\"60.000000\" y=\"45.412617\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" \u003e294\u003c/text\u003e\n  \u003ctext x=\"140.000000\" y=\"12.706308\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,140.000000,12.706308)\"\u003e1\u003c/text\u003e\n\u003c/svg\u003e\n        \u003c/td\u003e\n    \u003c/tr\u003e\n\u003c/table\u003e\u003c/div\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-f1b24da9-442e-4c06-875d-7da83768d73f' class='xr-section-summary-in' type='checkbox'  checked\u003e\u003clabel for='section-f1b24da9-442e-4c06-875d-7da83768d73f' class='xr-section-summary' \u003eCoordinates: \u003cspan\u003e(1)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-var-name'\u003e\u003cspan class='xr-has-index'\u003etime\u003c/span\u003e\u003c/div\u003e\u003cdiv class='xr-var-dims'\u003e(time)\u003c/div\u003e\u003cdiv class='xr-var-dtype'\u003edatetime64[ns]\u003c/div\u003e\u003cdiv class='xr-var-preview xr-preview'\u003e1995-08-01 ... 2020-12-01\u003c/div\u003e\u003cinput id='attrs-8e6fc4e3-5a05-4ae0-b514-569f5c07aa8a' class='xr-var-attrs-in' type='checkbox' \u003e\u003clabel for='attrs-8e6fc4e3-5a05-4ae0-b514-569f5c07aa8a' title='Show/Hide attributes'\u003e\u003csvg class='icon xr-icon-file-text2'\u003e\u003cuse xlink:href='#icon-file-text2'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cinput id='data-c72e4b33-8e61-4415-b4d4-88acdf21245f' class='xr-var-data-in' type='checkbox'\u003e\u003clabel for='data-c72e4b33-8e61-4415-b4d4-88acdf21245f' title='Show/Hide data repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-var-attrs'\u003e\u003cdl class='xr-attrs'\u003e\u003cdt\u003e\u003cspan\u003elong_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003ereference time of file\u003c/dd\u003e\u003cdt\u003e\u003cspan\u003estandard_name :\u003c/span\u003e\u003c/dt\u003e\u003cdd\u003etime\u003c/dd\u003e\u003c/dl\u003e\u003c/div\u003e\u003cdiv class='xr-var-data'\u003e\u003cpre\u003earray([\u0026#x27;1995-08-01T00:00:00.000000000\u0026#x27;, \u0026#x27;1995-09-01T00:00:00.000000000\u0026#x27;,\n       \u0026#x27;1995-10-01T00:00:00.000000000\u0026#x27;, ..., \u0026#x27;2020-10-01T00:00:00.000000000\u0026#x27;,\n       \u0026#x27;2020-11-01T00:00:00.000000000\u0026#x27;, \u0026#x27;2020-12-01T00:00:00.000000000\u0026#x27;],\n      shape=(294,), dtype=\u0026#x27;datetime64[ns]\u0026#x27;)\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-a8aeb710-4373-4716-9305-0ffe0334f5c5' class='xr-section-summary-in' type='checkbox'  \u003e\u003clabel for='section-a8aeb710-4373-4716-9305-0ffe0334f5c5' class='xr-section-summary' \u003eIndexes: \u003cspan\u003e(1)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cul class='xr-var-list'\u003e\u003cli class='xr-var-item'\u003e\u003cdiv class='xr-index-name'\u003e\u003cdiv\u003etime\u003c/div\u003e\u003c/div\u003e\u003cdiv class='xr-index-preview'\u003ePandasIndex\u003c/div\u003e\u003cinput type='checkbox' disabled/\u003e\u003clabel\u003e\u003c/label\u003e\u003cinput id='index-8c300258-ba4d-4ae7-bdfe-2b4d33b00e81' class='xr-index-data-in' type='checkbox'/\u003e\u003clabel for='index-8c300258-ba4d-4ae7-bdfe-2b4d33b00e81' title='Show/Hide index repr'\u003e\u003csvg class='icon xr-icon-database'\u003e\u003cuse xlink:href='#icon-database'\u003e\u003c/use\u003e\u003c/svg\u003e\u003c/label\u003e\u003cdiv class='xr-index-data'\u003e\u003cpre\u003ePandasIndex(DatetimeIndex([\u0026#x27;1995-08-01\u0026#x27;, \u0026#x27;1995-09-01\u0026#x27;, \u0026#x27;1995-10-01\u0026#x27;, \u0026#x27;1995-11-01\u0026#x27;,\n               \u0026#x27;1995-12-01\u0026#x27;, \u0026#x27;1996-07-01\u0026#x27;, \u0026#x27;1996-08-01\u0026#x27;, \u0026#x27;1996-09-01\u0026#x27;,\n               \u0026#x27;1996-10-01\u0026#x27;, \u0026#x27;1996-11-01\u0026#x27;,\n               ...\n               \u0026#x27;2020-03-01\u0026#x27;, \u0026#x27;2020-04-01\u0026#x27;, \u0026#x27;2020-05-01\u0026#x27;, \u0026#x27;2020-06-01\u0026#x27;,\n               \u0026#x27;2020-07-01\u0026#x27;, \u0026#x27;2020-08-01\u0026#x27;, \u0026#x27;2020-09-01\u0026#x27;, \u0026#x27;2020-10-01\u0026#x27;,\n               \u0026#x27;2020-11-01\u0026#x27;, \u0026#x27;2020-12-01\u0026#x27;],\n              dtype=\u0026#x27;datetime64[ns]\u0026#x27;, name=\u0026#x27;time\u0026#x27;, length=294, freq=None))\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/li\u003e\u003cli class='xr-section-item'\u003e\u003cinput id='section-642a14ae-ca84-4f01-909c-65c809f9b666' class='xr-section-summary-in' type='checkbox' disabled \u003e\u003clabel for='section-642a14ae-ca84-4f01-909c-65c809f9b666' class='xr-section-summary'  title='Expand/collapse section'\u003eAttributes: \u003cspan\u003e(0)\u003c/span\u003e\u003c/label\u003e\u003cdiv class='xr-section-inline-details'\u003e\u003c/div\u003e\u003cdiv class='xr-section-details'\u003e\u003cdl class='xr-attrs'\u003e\u003c/dl\u003e\u003c/div\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/div\u003e","content_type":"text/html"},"text/plain":{"content":"\u003cxarray.DataArray 'lst' (time: 294)\u003e Size: 2kB\ndask.array\u003cmean_agg-aggregate, shape=(294,), dtype=float64, chunksize=(1,), chunktype=numpy.ndarray\u003e\nCoordinates:\n  * time     (time) datetime64[ns] 2kB 1995-08-01 1995-09-01 ... 2020-12-01","content_type":"text/plain"}}}],"key":"SKF5DN7PhV"}],"key":"JGTdkiJAAd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"span","style":{"color":"blue"},"children":[{"type":"text","value":"‚Üí How to save the time series as csv","key":"ct17aUv1kD"}],"key":"L7t0d3AJqg"}],"identifier":"id-how-to-save-the-time-series-as-csv","label":"‚Üí How to save the time series as csv","html_id":"id-how-to-save-the-time-series-as-csv","implicit":true,"key":"utI8KR1ajH"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"You can save the time series as ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LFAAOckBja"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"csv","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eZmcfPShKK"}],"key":"ilRKD2k3oi"},{"type":"text","value":" file like this:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t3xXJSRLAg"}],"key":"wst5YoUWHi"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"lst_ds_C_mean.to_dataframe(name=\"lst\").to_csv(\"lst_timeseries.csv\")","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ShpevGjb2x"}],"key":"sj6qS6ot9V"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"‚Üí see next cell, where you can uncomment the command","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MsyqZAVBxK"}],"key":"ad4LZGcgqH"}],"key":"OrOcXcMnB9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lst_ds_C_mean.to_dataframe(name=\"lst\").to_csv(\"lst_timeseries.csv\")","key":"ZfJztypw4g"},{"type":"output","id":"NDiB2-dr4TnzutRMCq9TE","data":[],"key":"OPfM4IFmvI"}],"key":"OpE76OrMHB"}],"key":"YfWU1H460g"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"ect-training","url":"/external-notebooks/esa-cci/ect-training/readme","group":"Ect Training"},"next":{"title":"README","url":"/external-notebooks/esa-cci/ect-training/adaptation-futures-nz-10-2025/readme","group":"Adaptation Futures NZ 10 2025"}}},"domain":"http://localhost:3000"},"project":{"subject":"CCI Examples","title":"CCI Examples","description":"Collection of examples relevant to the CCI activity","github":"https://github.com/esa-cci/cci-notebook-viewers","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Esa Cci","level":2},{"title":"Cci Notebooks","level":3},{"slug":"external-notebooks.esa-cci.cci-notebooks.readme","title":"cci-notebooks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebooks","level":4},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.aerosol-cci","title":"Getting Started with Aerosol CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.biomass-cci","title":"Getting Started with Biomass CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.cloud-cci","title":"Getting Started with Cloud CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.fire-cci","title":"Getting Started with Fire CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ghg-cci","title":"Getting Started with Greenhouse Gases CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.icesheets-cci","title":"Getting Started with Ice Sheets CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lakes-cci","title":"Getting Started with Lakes CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.landcover-cci","title":"Getting Started with Land Cover CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lst-cci","title":"Getting Started with Land Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.oceancolour-cci","title":"Getting Started with Ocean Colour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ozone-cci","title":"Getting Started with Ozone CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.permafrost-cci","title":"Getting Started with Permafrost CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.seaice-cci","title":"Getting Started with Sea Ice CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sealevel-cci","title":"Getting Started with Sea Level CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.snow-cci","title":"Getting Started with Snow CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.soilmoisture-cci","title":"Getting Started with Soil Moisture CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sss-cci","title":"Getting Started with Sea Surface Salinity CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sst-cci","title":"Getting Started with Sea Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.vegetation-cci","title":"Getting Started with Vegetation CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.watervapour-cci","title":"Getting Started with Water Vapour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Ect Training","level":3},{"slug":"external-notebooks.esa-cci.ect-training.readme","title":"ect-training","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Adaptation Futures NZ 10 2025","level":4},{"slug":"external-notebooks.esa-cci.ect-training.adaptation-futures-nz-10-2025.adaptation-futures-climate-risk-exposure-10-2025","title":"Step 1. Setup \u0026 Imports","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.adaptation-futures-nz-10-2025.readme","title":"README","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"ESA Climate Change Competition","level":4},{"slug":"external-notebooks.esa-cci.ect-training.esa-climate-change-competition.competition-forests-in-a-changing-climate","title":"Explore forests in a changing climate with the ESA CCI datasets","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lps Vienna 06 2025","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-beginner","title":"Step 1. Setup \u0026 Imports","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-cloud-uncertainties","title":"1. Import Necessary Packages","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-intermediate-level-elnino","title":"Questions We Aim to Explore","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lst Leicester 12 2024","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lst-leicester-12-2024.lst-training","title":"Analyzing Land Surface Temperature and Uncertainties: Insights from ESA CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/cci-notebook-viewers/build/manifest-ED236704.js";
import * as route0 from "/cci-notebook-viewers/build/root-ZJOPFBMV.js";
import * as route1 from "/cci-notebook-viewers/build/routes/$-CQPS5IOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/cci-notebook-viewers/build/entry.client-UNPC4GT3.js");</script></body></html>