<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>1. Import Necessary Packages - CCI Examples</title><meta property="og:title" content="1. Import Necessary Packages - CCI Examples"/><meta name="generator" content="mystmd"/><meta name="description" content="Collection of examples relevant to the CCI activity"/><meta property="og:description" content="Collection of examples relevant to the CCI activity"/><meta name="keywords" content=""/><meta name="image" content="/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png"/><meta property="og:image" content="/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png"/><link rel="stylesheet" href="/cci-notebook-viewers/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/cci-notebook-viewers/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/cci-notebook-viewers/favicon.ico"/><link rel="stylesheet" href="/cci-notebook-viewers/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block lg:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/cci-notebook-viewers/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] lg:hidden hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-none pr-2 smallcaps">CCI Examples</div><div class="flex-grow"></div><a href="https://github.com/esa-cci/cci-notebook-viewers" title="GitHub Repository: esa-cci/cci-notebook-viewers" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/esa-cci/cci-notebook-viewers/blob/main/external_notebooks/esa-cci/ect-training/lps_vienna_06_2025/LPS_cloud_uncertainties.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">1. Import Necessary Packages</h1></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="oi58wbNTjs" class="relative group/block"><div class="" style="text-align:center"><h1 id="lps-training-advanced-level-uncertainties-in-essential-climate-variables-ecvs-a-focus-on-clouds" class="relative group"><span class="heading-text">LPS Training - Advanced Level: Uncertainties in Essential Climate Variables (ECVs): A Focus on Clouds</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#lps-training-advanced-level-uncertainties-in-essential-climate-variables-ecvs-a-focus-on-clouds" title="Link to this Section" aria-label="Link to this Section">¶</a></h1></div></div><div id="Xn9i5CmzRG" class="relative group/block"><img id="X5Whk9B6E3" style="margin:0 auto" src="/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png" alt="cci_logo.png" data-canonical-url="data:image/png;base64,iVBORw0KGg...ORK5CYII=
" class=""/></div><div id="RwhkVnjTAl" class="relative group/block"><div class="" style="background-color:#e6f3ff;padding:10px;border-left:5px solid #e6f3ff"><h2 id="introduction" class="relative group"><span class="heading-text">Introduction:</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#introduction" title="Link to this Section" aria-label="Link to this Section">¶</a></h2></div><p>In climate science, no measurement is perfect—and understanding the uncertainties in our data is crucial for interpreting trends and making robust conclusions. This notebook explores the uncertainties associated with Essential Climate Variables (ECVs), using cloud properties as a representative example.</p><p>The ESA Climate Change Initiative (CCI) provides not only long-term datasets of key climate parameters, but also associated per-pixel uncertainty layers that quantify the confidence in each data point. These uncertainty values reflect the effects of sensor noise, retrieval limitations, and algorithm assumptions, all of which are especially relevant in satellite-derived variables like cloud cover.</p><p><strong>Using the ESA CCI Toolbox, we will:</strong></p><ul><li>Load both the primary cloud dataset (e.g. total cloud fraction and liquid water path) and its associated uncertainty layer</li><li>Visualize spatial patterns of cloud cover and uncertainty and liquid water path and its uncertainty</li><li>Discuss what these uncertainty values represent and how to interpret them when analyzing climate signals</li></ul><p><strong>By the end of this section, you’ll gain a better understanding of:</strong></p><ul><li>Why uncertainty information is critical for satellite climate datasets</li><li>How the CCI represents and provides uncertainty</li><li>How to visualize and work with these values in your own analyses</li></ul><div class=""></div></div><div id="HcTIBYJXfi" class="relative group/block"><h3 id="id-1-import-necessary-packages" class="relative group"><span class="heading-text">1. Import Necessary Packages</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-import-necessary-packages" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>In this section, we import the required Python packages to work with ESA Climate Change Initiative (CCI) data. Most notably, we use the <a target="_blank" rel="noreferrer" href="https://esa-climate-toolbox.readthedocs.io/en/latest/" class="">ESA Climate Toolbox</a> which simplifies access, manipulation, and visualization of CCI datasets in Python.</p><p>These packages allow us to:</p><ul><li>Access satellite-based climate data records from ESA.</li><li>Handle geospatial and temporal dimensions efficiently.</li><li>Visualize data with intuitive plotting tools.</li></ul><p>📚 For a broader introduction to the toolbox and how to install it, visit:<br/>🔗 <a target="_blank" rel="noreferrer" href="https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#jupyter-notebooks" class="">ESA CCI Climate Toolbox Quick Start</a><br/>🔗 <a target="_blank" rel="noreferrer" href="https://climate.esa.int/en/data/toolbox/" class="">ESA Climate Data Toolbox Website</a></p></div><div id="fKEMoxArKb" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create a new data store (e.g., remote or local access point for datasets)
from xcube.core.store import new_data_store

# Core functions from the ESA Climate Toolbox to access and process ECV datasets
from esa_climate_toolbox.core import get_op               # Get predefined operations (e.g., time series mean, subsetting)
from esa_climate_toolbox.core import list_ecv_datasets    # List available Essential Climate Variable (ECV) datasets
from esa_climate_toolbox.core import get_store            # Connect to a specific data store (e.g., ESA CCI)
from esa_climate_toolbox.core import list_datasets        # List all datasets within the selected store

# Plotting utility for ESA CCI toolbox outputs
from esa_climate_toolbox.ops import plot                  # Quick plotting for processed data

# Work with labeled multi-dimensional arrays (ideal for satellite/climate data)
import xarray as xr

# Plotting library for static figures
import matplotlib.pyplot as plt
# Ensure that plots appear inline in Jupyter notebooks
%matplotlib inline  

# Suppress warning messages (optional, for cleaner notebook output)
import warnings

# Numerical operations and array manipulation
import numpy as np

# Interactive plotting with Plotly
import plotly.io as pio
pio.renderers.default = &#x27;notebook_connected&#x27;  # Ensures Plotly figures render properly in notebooks

import plotly.graph_objects as go  # Create detailed and interactive figures with full layout control</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7FGHAyEXVBjrrPcerj27u" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="sUI59nPcoM" class="relative group/block"><h3 id="step-2-connect-to-the-esa-cci-data-store" class="relative group"><span class="heading-text">Step 2: Connect to the ESA CCI Data Store</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-2-connect-to-the-esa-cci-data-store" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The ESA Climate Toolbox provides direct access to the <strong>ESA Climate Data Store</strong>, which hosts harmonized satellite-based climate data records produced under the <strong>ESA Climate Change Initiative (CCI)</strong>.</p><p>In this step, we establish a connection to the data store so we can browse and open datasets. This connection allows us to access data <strong>without having to download files manually</strong> — a convenient way to explore and analyze large geospatial datasets in cloud-friendly formats such as <strong>Zarr</strong> or <strong>Kerchunk</strong>.</p><p>The data store includes a wide range of essential climate variables (ECVs), such as aerosols, land surface temperature, sea level, and soil moisture.</p><p>📘 Learn more about available datasets:<br/>🔗 <a target="_blank" rel="noreferrer" href="https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#data-access" class="">ESA Climate Data Toolbox – Quick Start Guide</a></p></div><div id="gqCuRsLtep" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cci_store = new_data_store(&quot;esa-cci&quot;)
# List all available data sets of an ECV
list_ecv_datasets(&quot;Cloud&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="AJqe5jN9ian8sNy4UCZ00" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[(&#x27;esacci.CLOUD.mon.L3C.CLD_PRODUCTS.MODIS.Aqua.MODIS_AQUA.2-0.r1&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.CLOUD.mon.L3C.CLD_PRODUCTS.MODIS.Terra.MODIS_TERRA.2-0.r1&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.multi-platform.ATSR2-AATSR.3-0.r1&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.multi-platform.AVHRR-AM.3-0.r1&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.multi-platform.AVHRR-PM.3-0.r1&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.multi-platform.MERIS-AATSR.2-0.r1&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;ESACCI-L3C_CLOUD-CLD_PRODUCTS-MODIS_AQUA-200208-201412-fv2.0_kr1.0&#x27;,
  &#x27;esa-cci-kc&#x27;),
 (&#x27;ESACCI-L3C_CLOUD-CLD_PRODUCTS-ATSR2_AATSR-199506-201204-fv3.0-kr1.1&#x27;,
  &#x27;esa-cci-kc&#x27;),
 (&#x27;ESACCI-L3C_CLOUD-CLD_PRODUCTS-AVHRR_AM-199109-201612-fv3.0-kr1.1&#x27;,
  &#x27;esa-cci-kc&#x27;),
 (&#x27;ESACCI-L3C_CLOUD-CLD_PRODUCTS-AVHRR_PM-198201-201612-fv3.0-kr1.1&#x27;,
  &#x27;esa-cci-kc&#x27;),
 (&#x27;ESACCI-L3C_CLOUD-CLD_PRODUCTS-MERIS-AATSR_ENVISAT-200301-201112_fv2.0_kr1.0&#x27;,
  &#x27;esa-cci-kc&#x27;),
 (&#x27;ESACCI-L3C_CLOUD-CLD_PRODUCTS-AVHRR_NOAA-1982-2016-fv3.0.zarr&#x27;,
  &#x27;esa-cci-zarr&#x27;)]</span></code></div></div></div><div id="FpMz4hN3Bv" class="relative group/block"><h3 id="step-3-define-the-dataset-id" class="relative group"><span class="heading-text">Step 3: Define the Dataset ID</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-3-define-the-dataset-id" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>To work with a specific ESA CCI dataset, we need to specify its <strong>dataset ID</strong>. This unique identifier tells the toolbox which variable and product we want to access.</p><p>In this example, we are using a dataset from the <strong>Cloud CCI project</strong> that provides monthly Level 3 cloud property products, derived from multiple satellite sensors. These products include key cloud variables such as <strong>cloud fraction (cfc)</strong> and <strong>liquid water path (lwp)</strong> including their uncertainties.</p><p>We will use the following dataset ID:</p></div><div id="SfFn7EE8XX" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">data_id = &#x27;esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.multi-platform.AVHRR-PM.3-0.r1&#x27;
cci_store.describe_data(data_id)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="cycmBYfvncX9DQTw0nGyG" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="uzGQKV3iKo" class="relative group/block"><p>You can find more information on the dataset on the CEDA website <a target="_blank" rel="noreferrer" href="https://catalogue.ceda.ac.uk/uuid/004fd44ff5124174ad3c03dd2c67d548/" class="">(Link)</a>.
If you click on “Related Documents”, you can find the documents about the algorithm description (ATBD CC4CL and ATBD). Those documents include the information on how the uncertainties are calculated and which parameters are included in the dataset.</p></div><div id="s2qJs6CrNY" class="relative group/block"><h3 id="step-4-define-time-range-and-variables-of-interest-and-open-the-dataset" class="relative group"><span class="heading-text">Step 4: Define Time Range and Variables of Interest and Open the Dataset</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-4-define-time-range-and-variables-of-interest-and-open-the-dataset" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Before opening the dataset, we define a few key parameters. We focus on only one day to decrease the dataload. If you wish to look at the time series of the uncertainties, you can change the start and end date to the desired time range.</p><ul><li><strong>Time range</strong>: the date(s) we want to load</li><li><strong>Variables</strong>: which data variable(s) to retrieve</li><li><em>(Optional)</em> <strong>Bounding box</strong>: spatial region of interest — here we skip it to load the global dataset</li></ul></div><div id="ea6nR6ffru" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">variables = [&#x27;cfc&#x27;,&#x27;cfc_unc&#x27;,&#x27;lwp&#x27;,&#x27;lwp_unc&#x27;,&#x27;lwp_prop_unc&#x27;,&#x27;lwp_corr_unc&#x27;]  # Variables to retrieve, their names can be found through the cci_store.describe_data(data_id) command above
start_date = &#x27;1997-12-01&#x27;    # Start and end date (same for a single timestep)
end_date = &#x27;1997-12-01&#x27;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="36K34O5NMo8pP8Vr0eXp1" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="yJ1ZoBAiG6" class="relative group/block"><p>Now we open the dataset using the selected parameters.<br/>The ESA Climate Toolbox will download only the necessary data (e.g., variable and time range).
You can always adjust the time range or variables to explore different slices of the dataset.</p></div><div id="eMy4epfHMm" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cloud_ds = cci_store.open_data(
    data_id=data_id,
    variable_names=variables,
    time_range=[start_date, end_date]
)
display(cloud_ds)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="NrK-lMXbzTmWFIN4ma4xi" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="wj5xoO684y" class="relative group/block"><h3 id="step-5-extract-the-variables-and-create-a-3d-plot" class="relative group"><span class="heading-text">Step 5: Extract the Variables and create a 3D Plot</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-5-extract-the-variables-and-create-a-3d-plot" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><h4 id="cloud-fraction-cfc" class="relative group"><span class="heading-text">Cloud Fraction (CFC)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#cloud-fraction-cfc" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>Next, we extract the variables we would like to plot. We start with the cloud fraction (CFC) and its uncertainty.</p></div><div id="AlE69tTLYw" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Extract variables
cfc = cloud_ds[&#x27;cfc&#x27;].squeeze()
cfc_unc = cloud_ds[&#x27;cfc_unc&#x27;].squeeze()

# Get coordinate arrays - the lat and lon are the same for cfc_unc and cfc, thus we only load them here via the cfc variable
lon = cfc[&#x27;lon&#x27;].values
lat = cfc[&#x27;lat&#x27;].values

# Get 2D grids (assuming dims are [lat, lon])
z_unc = cfc_unc.values  # Uncertainty for Z-axis
surface_color = cfc.values  # For coloring the surface</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9xgzg2JKUmPni6L2M1XgG" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="n8ZQ6M4irc" class="relative group/block"><p>Now we use the <code>plotly</code> package to create an interactive plot of the uncertainty. We use the CFC as color and the uncertainty will be shown on the vertical axis.</p></div><div id="kqUXwVX5sM" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create 2D coordinate grids
lon2d, lat2d = np.meshgrid(lon, lat)

# Check that all arrays have the same shape
assert lon2d.shape == lat2d.shape == z_unc.shape == surface_color.shape, &quot;Shape mismatch&quot;

# Create surface plot, define hover variables too show data via mouse hovering
fig = go.Figure(
    data=[go.Surface(
        x=lon2d,
        y=lat2d,
        z=z_unc,
        surfacecolor=surface_color,
        colorscale=&quot;Blues_r&quot;,
        colorbar=dict(title=&quot;Cloud Fraction&quot;),
        hovertemplate=
            &quot;Longitude: %{x}&lt;br&gt;&quot; +
            &quot;Latitude: %{y}&lt;br&gt;&quot; +
            &quot;Uncertainty in %: %{z:.2f}&lt;br&gt;&quot;
    )]
)

fig.update_layout(
    title=dict(text=&#x27;Cloud Fraction Uncertainty Surface&#x27;),
    autosize=False,
    width=700,
    height=600,
    margin=dict(l=65, r=50, b=65, t=90),
    scene=dict(
        xaxis_title=&quot;Longitude&quot;,
        yaxis_title=&quot;Latitude&quot;,
        zaxis_title=&quot;Uncertainty in %&quot;,
        yaxis=dict(range=[90, -90]),  # Reverse latitude axis 
        xaxis=dict(range=[180,-180]) # Reverse longitude axis
    )
)

fig.show()
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ZDmA_XJRFFKW63aSE1Te4" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="diJ8fprI7w" class="relative group/block"><h3 id="what-do-we-see" class="relative group"><span class="heading-text">What do we see?</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#what-do-we-see" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>The uncertainties in Cloud Fraction Cover (CFC) are relatively straightforward to interpret.
They are based on the average probability of cloud presence for each pixel, where the cloud detection algorithm classifies pixels as either “cloud” (1) or “no cloud” (0).</p><p>Uncertainties arise in cases where the classification is ambiguous—for example, over bright surfaces like snow or desert, where high surface albedo makes it difficult to distinguish clouds from the background. In such situations, the cloud detection confidence is reduced, leading to higher uncertainty values. We can see this above Antarctica, for example, where the uncertainty is abruptly rising while above the ocean along the coast of Antarctica and further north, the uncertainties are very low.</p></div><div id="H7SJHTugmY" class="relative group/block"><h2 id="liquid-water-path-lwp" class="relative group"><span class="heading-text">Liquid Water Path (LWP)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#liquid-water-path-lwp" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Now we move on to a more complex parameter, the liquid water path (LWP).</p><p>Satellite retrievals of LWP are based on radiative measurements (like reflectance, brightness temperature) which are fed into physical models. These retrievals are subject to various uncertainties, which are separated into two main types:</p><h5 id="id-1-propagated-uncertainty-lwp-prop-unc" class="relative group"><span class="heading-text"><strong>1. Propagated Uncertainty (<code>lwp_prop_unc</code>)</strong></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-propagated-uncertainty-lwp-prop-unc" title="Link to this Section" aria-label="Link to this Section">¶</a></h5><p><strong>Definition:</strong></p><ul><li><p>Uncertainties that originate from input measurements and propagate through the retrieval algorithm.</p></li><li><p>These stem from:</p><ul><li>Instrumental noise</li><li>Calibration errors</li><li>Assumed atmospheric conditions</li><li>Model assumptions within the retrieval algorithm</li></ul></li></ul><p><strong>How it’s computed:</strong></p><ul><li>Derived by error propagation using <strong>analytic formulas</strong> or <strong>sensitivity analysis</strong>.</li><li>It accounts for how small errors in input variables affect the output (LWP).</li></ul><p><strong>Characteristics:</strong></p><ul><li>Pixel-specific</li><li>Varies with atmospheric conditions, viewing geometry, surface type</li></ul><h5 id="id-2-correlated-uncertainty-lwp-corr-unc" class="relative group"><span class="heading-text"><strong>2. Correlated Uncertainty (<code>lwp_corr_unc</code>)</strong></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-correlated-uncertainty-lwp-corr-unc" title="Link to this Section" aria-label="Link to this Section">¶</a></h5><p><strong>Definition</strong></p><ul><li>Uncertainties that are spatially or temporally correlated, not random per pixel.</li><li>These come from:<ul><li>Systematic biases in retrieval algorithms</li><li>Assumptions in radiative transfer models</li><li>Shared calibration errors across multiple observations</li></ul></li></ul><p><strong>Characteristics:</strong></p><ul><li>Not independent from pixel to pixel</li><li>Important for regional or temporal averaging</li><li>Not properly accounting for this can lead to overconfident estimates</li></ul><h5 id="id-3-total-uncertainty-lwp-unc" class="relative group"><span class="heading-text"><strong>3. Total Uncertainty (<code>lwp_unc</code>)</strong></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-total-uncertainty-lwp-unc" title="Link to this Section" aria-label="Link to this Section">¶</a></h5><p>ESA CCI computes total uncertainty as a quadrature sum of both components:</p><p><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>lwp_unc</mtext><mo>=</mo><msqrt><mrow><mo stretchy="false">(</mo><mtext>lwp_prop_unc</mtext><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mtext>lwp_corr_unc</mtext><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">\text{lwp\_unc} = \sqrt{(\text{lwp\_prop\_unc})^2 + (\text{lwp\_corr\_unc})^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em;"></span><span class="mord text"><span class="mord">lwp_unc</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.24em;vertical-align:-0.335em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.905em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mopen">(</span><span class="mord text"><span class="mord">lwp_prop_unc</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord">lwp_corr_unc</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7401em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-2.865em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg xmlns="http://www.w3.org/2000/svg" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.335em;"><span></span></span></span></span></span></span></span></span></span></p><p>This assumes the propagated and correlated components are independent.</p><h5 id="why-is-the-combination-of-uncertainties-relevant" class="relative group"><span class="heading-text"><strong>Why is the combination of uncertainties relevant?</strong></span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#why-is-the-combination-of-uncertainties-relevant" title="Link to this Section" aria-label="Link to this Section">¶</a></h5><p>If you’re analyzing individual pixels, the propagated uncertainty dominates. If you’re computing regional means or trends, you must consider correlated uncertainty — otherwise, your confidence intervals will be too optimistic.</p><p>In this publication, you can read a more detailed description: <cite class="" data-state="closed"><a href="https://doi.org/10.5194/essd-9-881-2017" target="_blank" rel="noreferrer" class="hover-link">Stengel et al., Cloud property datasets retrieved from AVHRR, MODIS, AATSR and MERIS in the framework of the Cloud_cci project (2017)</a></cite>.</p><p>In this ESA Cloud CCI Product User Guide, you can find all parameters and uncertainties listed: <a target="_blank" rel="noreferrer" href="https://climate.esa.int/media/documents/Cloud_Product-User-Guide-PUG_v5.1.pdf" class="">ESA Cloud_cci Product User Guide (PUG)</a>.</p></div><div id="cEXwWXlIBJ" class="relative group/block"><h4 id="plotting-the-correlated-uncertainty" class="relative group"><span class="heading-text">Plotting the Correlated Uncertainty</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#plotting-the-correlated-uncertainty" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="nOVEYZJqA3" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Extract and squeeze variables
lwp = cloud_ds[&#x27;lwp&#x27;].squeeze()
lwp_corr_unc = cloud_ds[&#x27;lwp_corr_unc&#x27;].squeeze()

# Get 1D coordinate arrays
lon = lwp[&#x27;lon&#x27;].values
lat = lwp[&#x27;lat&#x27;].values

# Create 2D coordinate grids
lon2d, lat2d = np.meshgrid(lon, lat)

# Get 2D data arrays
z_unc = lwp_corr_unc.values
surface_color = lwp.values

# Check that all arrays have the same shape
assert lon2d.shape == lat2d.shape == z_unc.shape == surface_color.shape, &quot;Shape mismatch&quot;

# Create surface plot
fig = go.Figure(
    data=[go.Surface(
        x=lon2d,
        y=lat2d,
        z=z_unc,
        surfacecolor=surface_color,
        colorscale=&quot;viridis&quot;,
        colorbar=dict(title=&quot;Liquid Water Path (g/m2)&quot;),
        cmin = 0,
        cmax = 500,
        hovertemplate=
            &quot;Longitude: %{x}&lt;br&gt;&quot; +
            &quot;Latitude: %{y}&lt;br&gt;&quot; +
            &quot;Correlated Uncertainty (g/m2): %{z:.2f}&lt;br&gt;&quot;
    )]
)

fig.update_layout(
    title=dict(text=&#x27;Liquid Water Path Correlated Uncertainty&#x27;),
    autosize=False,
    width=700,
    height=600,
    margin=dict(l=65, r=50, b=65, t=90),
    scene=dict(
        xaxis_title=&quot;Longitude&quot;,
        yaxis_title=&quot;Latitude&quot;,
        zaxis_title=&quot;Correlated Uncertainty (g/m2)&quot;,
        yaxis=dict(range=[90, -90]),  # Reverse latitude axis 
        xaxis=dict(range=[180,-180]) # Reverse longitude axis
    )
)

# uncomment the next line &quot;fig.show()&quot; AND comment the &quot;pass&quot; command to show the figure:
#fig.show()
pass</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="yAzca8xEQEbtcEmUtnfLg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="WI6LmBjABd" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Extract and squeeze variables
lwp = cloud_ds[&#x27;lwp&#x27;].squeeze()
lwp_prop_unc = cloud_ds[&#x27;lwp_prop_unc&#x27;].squeeze()

# Get 1D coordinate arrays
lon = lwp[&#x27;lon&#x27;].values
lat = lwp[&#x27;lat&#x27;].values

# Create 2D coordinate grids
lon2d, lat2d = np.meshgrid(lon, lat)

# Get 2D data arrays
z_unc = lwp_prop_unc.values
surface_color = lwp.values

# Check that all arrays have the same shape
assert lon2d.shape == lat2d.shape == z_unc.shape == surface_color.shape, &quot;Shape mismatch&quot;

# Create surface plot
fig = go.Figure(
    data=[go.Surface(
        x=lon2d,
        y=lat2d,
        z=z_unc,
        surfacecolor=surface_color,
        colorscale=&quot;viridis&quot;,
        colorbar=dict(title=&quot;Liquid Water Path (g/m2)&quot;),
        cmin = 0,
        cmax = 500,
        hovertemplate=
            &quot;Longitude: %{x}&lt;br&gt;&quot; +
            &quot;Latitude: %{y}&lt;br&gt;&quot; +
            &quot;Propagated Uncertainty (g/m2): %{z:.2f}&lt;br&gt;&quot;
    )]
)

fig.update_layout(
    title=dict(text=&#x27;Liquid Water Path Propagated Uncertainty&#x27;),
    autosize=False,
    width=700,
    height=600,
    margin=dict(l=65, r=50, b=65, t=90),
    scene=dict(
        xaxis_title=&quot;Longitude&quot;,
        yaxis_title=&quot;Latitude&quot;,
        zaxis_title=&quot;Propagated Uncertainty (g/m2)&quot;,
        yaxis=dict(range=[90, -90]),  # Reverse latitude axis 
        xaxis=dict(range=[180,-180]) # Reverse longitude axis
    )
)

# uncomment the next line &quot;fig.show()&quot; AND comment the &quot;pass&quot; command to show the figure:
#fig.show()
pass</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="2-1_7vhQbaC1ib5bNdk8z" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="DQ9NwauZjI" class="relative group/block"><h4 id="plotting-the-total-uncertainty-of-lwp" class="relative group"><span class="heading-text">Plotting the total uncertainty of LWP</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#plotting-the-total-uncertainty-of-lwp" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="MdgrWC9c8L" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Extract and squeeze variables
lwp = cloud_ds[&#x27;lwp&#x27;].squeeze()
lwp_unc = cloud_ds[&#x27;lwp_unc&#x27;].squeeze()

# Get 1D coordinate arrays
lon = lwp[&#x27;lon&#x27;].values
lat = lwp[&#x27;lat&#x27;].values

# Create 2D coordinate grids
lon2d, lat2d = np.meshgrid(lon, lat)

# Get 2D data arrays
z_unc = lwp_unc.values
surface_color = lwp.values

# Check that all arrays have the same shape
assert lon2d.shape == lat2d.shape == z_unc.shape == surface_color.shape, &quot;Shape mismatch&quot;

# Create surface plot
fig = go.Figure(
    data=[go.Surface(
        x=lon2d,
        y=lat2d,
        z=z_unc,
        surfacecolor=surface_color,
        colorscale=&quot;viridis&quot;,
        colorbar=dict(title=&quot;Liquid Water Path (g/m2)&quot;),
        cmin = 0,
        cmax = 500,
        hovertemplate=
            &quot;Longitude: %{x}&lt;br&gt;&quot; +
            &quot;Latitude: %{y}&lt;br&gt;&quot; +
            &quot;Uncertainty (g/m2): %{z:.2f}&lt;br&gt;&quot;
    )]
)

fig.update_layout(
    title=dict(text=&#x27;Liquid Water Path Total Uncertainty&#x27;),
    autosize=False,
    width=700,
    height=600,
    margin=dict(l=65, r=50, b=65, t=90),
    scene=dict(
        xaxis_title=&quot;Longitude&quot;,
        yaxis_title=&quot;Latitude&quot;,
        zaxis_title=&quot;Uncertainty (g/m2)&quot;,
        yaxis=dict(range=[90, -90]),  # Reverse latitude axis 
        xaxis=dict(range=[180,-180]) # Reverse longitude axis
    )
)

# uncomment the next line &quot;fig.show()&quot; AND comment the &quot;pass&quot; command to show the figure:
#fig.show()
pass</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="d2vmyOwzpdujCenSl6-Rp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="fHOa9oqE03" class="relative group/block"><h4 id="what-do-we-see-1" class="relative group"><span class="heading-text">What do we see?</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#what-do-we-see-1" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>The uncertainty increases toward the northern polar region. Since this data is from December, the Sun’s zenith angle is low in these latitudes, resulting in limited visible light and higher retrieval uncertainty. Therefore, the high LWP values observed in the northern hemisphere should be interpreted with caution, as they are associated with high uncertainty.</p></div><div></div><section id="references" class="article-grid subgrid-gap col-screen"><div><header class="text-lg font-semibold text-stone-900 dark:text-white group">References<a class="no-underline text-inherit hover:text-inherit ml-2 select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to References" aria-label="Link to References">¶</a></header></div><div class="pl-3 mb-8 text-xs text-stone-500 dark:text-stone-300"><ol><li class="break-words" id="cite-Stengel_2017">Stengel, M., Stapelberg, S., Sus, O., Schlundt, C., Poulsen, C., Thomas, G., Christensen, M., Carbajal Henken, C., Preusker, R., Fischer, J., Devasthale, A., Willén, U., Karlsson, K.-G., McGarragh, G. R., Proud, S., Povey, A. C., Grainger, R. G., Meirink, J. F., Feofilov, A., … Hollmann, R. (2017). Cloud property datasets retrieved from AVHRR, MODIS, AATSR and MERIS in the framework of the Cloud_cci project. <i>Earth System Science Data</i>, <i>9</i>(2), 881–904. <a target="_blank" rel="noreferrer" href="https://doi.org/10.5194/essd-9-881-2017">10.5194/essd-9-881-2017</a></li></ol></div></section></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/cci-notebook-viewers/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-XWET6RJ7.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/root-ZJOPFBMV.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-NFM2H3KQ.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/routes/$-CQPS5IOR.js"/><script>window.__remixContext = {"url":"/external-notebooks/esa-cci/ect-training/lps-vienna-06-2025/lps-cloud-uncertainties","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.0","options":{"hide_toc":true,"hide_footer_links":true,"folders":true},"nav":[],"actions":[],"projects":[{"subject":"CCI Examples","title":"CCI Examples","description":"Collection of examples relevant to the CCI activity","github":"https://github.com/esa-cci/cci-notebook-viewers","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Esa Cci","level":2},{"title":"Cci Notebooks","level":3},{"slug":"external-notebooks.esa-cci.cci-notebooks.readme","title":"cci-notebooks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebooks","level":4},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.aerosol-cci","title":"Getting Started with Aerosol CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.biomass-cci","title":"Getting Started with Biomass CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.cloud-cci","title":"Getting Started with Cloud CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.fire-cci","title":"Getting Started with Fire CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ghg-cci","title":"Getting Started with Greenhouse Gases CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.icesheets-cci","title":"Getting Started with Ice Sheets CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lakes-cci","title":"Getting Started with Lakes CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.landcover-cci","title":"Getting Started with Land Cover CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lst-cci","title":"Getting Started with Land Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.oceancolour-cci","title":"Getting Started with Ocean Colour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ozone-cci","title":"Getting Started with Ozone CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.permafrost-cci","title":"Getting Started with Permafrost CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.seaice-cci","title":"Getting Started with Sea Ice CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sealevel-cci","title":"Getting Started with Sea Level CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.snow-cci","title":"Getting Started with Snow CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.soilmoisture-cci","title":"Getting Started with Soil Moisture CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sss-cci","title":"Getting Started with Sea Surface Salinity CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sst-cci","title":"Getting Started with Sea Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.vegetation-cci","title":"Getting Started with Vegetation CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.watervapour-cci","title":"Getting Started with Water Vapour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Ect Training","level":3},{"slug":"external-notebooks.esa-cci.ect-training.readme","title":"ect-training","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"ESA Climate Change Competition","level":4},{"slug":"external-notebooks.esa-cci.ect-training.esa-climate-change-competition.competition-forests-in-a-changing-climate","title":"Explore forests in a changing climate with the ESA CCI datasets","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lps Vienna 06 2025","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-beginner","title":"Step 1. Setup \u0026 Imports","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-cloud-uncertainties","title":"1. Import Necessary Packages","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-intermediate-level-elnino","title":"Questions We Aim to Explore","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lst Leicester 12 2024","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lst-leicester-12-2024.lst-training","title":"Analyzing Land Surface Temperature and Uncertainties: Insights from ESA CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/cci-notebook-viewers"},"routes/$":{"config":{"version":2,"myst":"1.6.0","options":{"hide_toc":true,"hide_footer_links":true,"folders":true},"nav":[],"actions":[],"projects":[{"subject":"CCI Examples","title":"CCI Examples","description":"Collection of examples relevant to the CCI activity","github":"https://github.com/esa-cci/cci-notebook-viewers","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Esa Cci","level":2},{"title":"Cci Notebooks","level":3},{"slug":"external-notebooks.esa-cci.cci-notebooks.readme","title":"cci-notebooks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebooks","level":4},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.aerosol-cci","title":"Getting Started with Aerosol CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.biomass-cci","title":"Getting Started with Biomass CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.cloud-cci","title":"Getting Started with Cloud CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.fire-cci","title":"Getting Started with Fire CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ghg-cci","title":"Getting Started with Greenhouse Gases CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.icesheets-cci","title":"Getting Started with Ice Sheets CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lakes-cci","title":"Getting Started with Lakes CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.landcover-cci","title":"Getting Started with Land Cover CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lst-cci","title":"Getting Started with Land Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.oceancolour-cci","title":"Getting Started with Ocean Colour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ozone-cci","title":"Getting Started with Ozone CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.permafrost-cci","title":"Getting Started with Permafrost CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.seaice-cci","title":"Getting Started with Sea Ice CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sealevel-cci","title":"Getting Started with Sea Level CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.snow-cci","title":"Getting Started with Snow CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.soilmoisture-cci","title":"Getting Started with Soil Moisture CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sss-cci","title":"Getting Started with Sea Surface Salinity CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sst-cci","title":"Getting Started with Sea Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.vegetation-cci","title":"Getting Started with Vegetation CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.watervapour-cci","title":"Getting Started with Water Vapour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Ect Training","level":3},{"slug":"external-notebooks.esa-cci.ect-training.readme","title":"ect-training","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"ESA Climate Change Competition","level":4},{"slug":"external-notebooks.esa-cci.ect-training.esa-climate-change-competition.competition-forests-in-a-changing-climate","title":"Explore forests in a changing climate with the ESA CCI datasets","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lps Vienna 06 2025","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-beginner","title":"Step 1. Setup \u0026 Imports","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-cloud-uncertainties","title":"1. Import Necessary Packages","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-intermediate-level-elnino","title":"Questions We Aim to Explore","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lst Leicester 12 2024","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lst-leicester-12-2024.lst-training","title":"Analyzing Land Surface Temperature and Uncertainties: Insights from ESA CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5}]}]},"page":{"version":2,"kind":"Notebook","sha256":"9b6a938c1c368d6b919b37ed3f56e3e037eb89af0006f8fabdf4cc40ea28ed9a","slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-cloud-uncertainties","location":"/external_notebooks/esa-cci/ect-training/lps_vienna_06_2025/LPS_cloud_uncertainties.ipynb","dependencies":[],"frontmatter":{"title":"1. Import Necessary Packages","content_includes_title":true,"kernelspec":{"name":"conda-env-climate-climate-esa-climate-toolbox-py","display_name":"climate-climate-esa-climate-toolbox","language":"python"},"github":"https://github.com/esa-cci/cci-notebook-viewers","subject":"CCI Examples","numbering":{"title":{"offset":4}},"edit_url":"https://github.com/esa-cci/cci-notebook-viewers/blob/main/external_notebooks/esa-cci/ect-training/lps_vienna_06_2025/LPS_cloud_uncertainties.ipynb","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","exports":[{"format":"ipynb","filename":"LPS_cloud_uncertainties.ipynb","url":"/cci-notebook-viewers/build/LPS_cloud_uncertaint-dfc9ea189bb76dcf99b46fd80720f6da.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"textAlign":"center"},"children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"LPS Training - Advanced Level: Uncertainties in Essential Climate Variables (ECVs): A Focus on Clouds","key":"SHCMyHoS2P"}],"identifier":"lps-training-advanced-level-uncertainties-in-essential-climate-variables-ecvs-a-focus-on-clouds","label":"LPS Training - Advanced Level: Uncertainties in Essential Climate Variables (ECVs): A Focus on Clouds","html_id":"lps-training-advanced-level-uncertainties-in-essential-climate-variables-ecvs-a-focus-on-clouds","implicit":true,"key":"uWlMTaJe0v"}],"key":"DANJ2bUmyT"}],"key":"oi58wbNTjs"},{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","alt":"cci_logo.png","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X5Whk9B6E3","urlSource":"data:image/png;base64,iVBORw0KGg...ORK5CYII=\n"}],"key":"Xn9i5CmzRG"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[{"type":"heading","depth":2,"children":[{"type":"text","value":"Introduction:","key":"HIIRpu42qE"}],"identifier":"introduction","label":"Introduction:","html_id":"introduction","implicit":true,"key":"MhA8nO7qJL"}],"key":"yy08fqBlla"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In climate science, no measurement is perfect—and understanding the uncertainties in our data is crucial for interpreting trends and making robust conclusions. This notebook explores the uncertainties associated with Essential Climate Variables (ECVs), using cloud properties as a representative example.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"LG2vegb8zK"}],"key":"apQQsdjtZY"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The ESA Climate Change Initiative (CCI) provides not only long-term datasets of key climate parameters, but also associated per-pixel uncertainty layers that quantify the confidence in each data point. These uncertainty values reflect the effects of sensor noise, retrieval limitations, and algorithm assumptions, all of which are especially relevant in satellite-derived variables like cloud cover.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"AUtPlkcXnW"}],"key":"tLxKmSn6Rb"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Using the ESA CCI Toolbox, we will:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Qq3YgZAUSb"}],"key":"u3LNsbAkeT"}],"key":"cFqWMsrv0g"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Load both the primary cloud dataset (e.g. total cloud fraction and liquid water path) and its associated uncertainty layer","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"eVRzCciYGO"}],"key":"YTICf5G5Mk"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Visualize spatial patterns of cloud cover and uncertainty and liquid water path and its uncertainty","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"kLpCvnyxaX"}],"key":"ShGppvtUl7"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Discuss what these uncertainty values represent and how to interpret them when analyzing climate signals","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"d8WyOmubpA"}],"key":"ebKSR0pB7e"}],"key":"EDXfAHi3iw"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"By the end of this section, you’ll gain a better understanding of:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"aY6ghf3NIB"}],"key":"GssZyGtuyV"}],"key":"uKaSY9jyhQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Why uncertainty information is critical for satellite climate datasets","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ILu1Dr6Hz7"}],"key":"Bo2qKKmcJl"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"How the CCI represents and provides uncertainty","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"seHEEaDV7S"}],"key":"QHQuYl34pl"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"How to visualize and work with these values in your own analyses","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Pgm3izv1y9"}],"key":"RTgBQOc7rw"}],"key":"DiiQA8WlEz"},{"type":"div","children":[],"key":"PCbMXZAmJ3"}],"key":"RwhkVnjTAl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1. Import Necessary Packages","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sC5pt4LUM0"}],"identifier":"id-1-import-necessary-packages","label":"1. Import Necessary Packages","html_id":"id-1-import-necessary-packages","implicit":true,"key":"w3Ar6re775"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this section, we import the required Python packages to work with ESA Climate Change Initiative (CCI) data. Most notably, we use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cdZnR98JK2"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ESA Climate Toolbox","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"C3IIJvj6PO"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/","key":"QHnAlveHAb"},{"type":"text","value":" which simplifies access, manipulation, and visualization of CCI datasets in Python.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OsPvKa9Yvw"}],"key":"GE25mYbt8J"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"These packages allow us to:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zrm6KDaZZF"}],"key":"zDIu8wRHzE"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Access satellite-based climate data records from ESA.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ABPIqsHVH5"}],"key":"FJ8eoltyg7"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Handle geospatial and temporal dimensions efficiently.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Q8rfTC1qjT"}],"key":"MazgltaeuE"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Visualize data with intuitive plotting tools.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"pYdJq9MPPU"}],"key":"Fvdh2fyyes"}],"key":"OtVs1mwPvZ"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"📚 For a broader introduction to the toolbox and how to install it, visit:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"bfyZj2HYcz"},{"type":"break","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"A7enyg5QGh"},{"type":"text","value":"🔗 ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"qvGsad0D5u"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#jupyter-notebooks","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"ESA CCI Climate Toolbox Quick Start","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"eFIhmAMmUq"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#jupyter-notebooks","key":"WLkE4Oo1ER"},{"type":"break","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"UyMsaO48do"},{"type":"text","value":"🔗 ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"GHjdCuIK0b"},{"type":"link","url":"https://climate.esa.int/en/data/toolbox/","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"ESA Climate Data Toolbox Website","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"G4TrkMTH8D"}],"urlSource":"https://climate.esa.int/en/data/toolbox/","key":"rA5PnKlM1g"}],"key":"xrSACTZqFa"}],"key":"HcTIBYJXfi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create a new data store (e.g., remote or local access point for datasets)\nfrom xcube.core.store import new_data_store\n\n# Core functions from the ESA Climate Toolbox to access and process ECV datasets\nfrom esa_climate_toolbox.core import get_op               # Get predefined operations (e.g., time series mean, subsetting)\nfrom esa_climate_toolbox.core import list_ecv_datasets    # List available Essential Climate Variable (ECV) datasets\nfrom esa_climate_toolbox.core import get_store            # Connect to a specific data store (e.g., ESA CCI)\nfrom esa_climate_toolbox.core import list_datasets        # List all datasets within the selected store\n\n# Plotting utility for ESA CCI toolbox outputs\nfrom esa_climate_toolbox.ops import plot                  # Quick plotting for processed data\n\n# Work with labeled multi-dimensional arrays (ideal for satellite/climate data)\nimport xarray as xr\n\n# Plotting library for static figures\nimport matplotlib.pyplot as plt\n# Ensure that plots appear inline in Jupyter notebooks\n%matplotlib inline  \n\n# Suppress warning messages (optional, for cleaner notebook output)\nimport warnings\n\n# Numerical operations and array manipulation\nimport numpy as np\n\n# Interactive plotting with Plotly\nimport plotly.io as pio\npio.renderers.default = 'notebook_connected'  # Ensures Plotly figures render properly in notebooks\n\nimport plotly.graph_objects as go  # Create detailed and interactive figures with full layout control","key":"ez4TzjELZk"},{"type":"output","id":"7FGHAyEXVBjrrPcerj27u","data":[],"key":"u5QOD5S7AH"}],"key":"fKEMoxArKb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 2: Connect to the ESA CCI Data Store","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lZh0oOkAPa"}],"identifier":"step-2-connect-to-the-esa-cci-data-store","label":"Step 2: Connect to the ESA CCI Data Store","html_id":"step-2-connect-to-the-esa-cci-data-store","implicit":true,"key":"Z2nSouz6nh"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The ESA Climate Toolbox provides direct access to the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zFe3RdffQk"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ESA Climate Data Store","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YHHxz32uEc"}],"key":"TckJW2dHsC"},{"type":"text","value":", which hosts harmonized satellite-based climate data records produced under the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GzEIn3YZU7"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"ESA Climate Change Initiative (CCI)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dHYk0tnPdq"}],"key":"tSue5GNHXB"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xK6Fj6MSm4"}],"key":"mNvXJhKrby"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In this step, we establish a connection to the data store so we can browse and open datasets. This connection allows us to access data ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ynEkIGWGVF"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"without having to download files manually","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mHT8ZYLM25"}],"key":"MCfl7CzBHY"},{"type":"text","value":" — a convenient way to explore and analyze large geospatial datasets in cloud-friendly formats such as ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vWuepSIMpU"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Zarr","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sujHlDX3kq"}],"key":"Fib1ghsM6G"},{"type":"text","value":" or ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NgoxSmt5NK"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Kerchunk","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KMYAZq5D5q"}],"key":"COOn8ujQQ8"},{"type":"text","value":".","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IQUGJgd7Gv"}],"key":"EEZswkaWdP"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The data store includes a wide range of essential climate variables (ECVs), such as aerosols, land surface temperature, sea level, and soil moisture.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"KPCjkC8Rvu"}],"key":"b0ovVTA40Y"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"📘 Learn more about available datasets:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"jl842SQcYN"},{"type":"break","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"aE0570nii3"},{"type":"text","value":"🔗 ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"y5ucnnf2HK"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#data-access","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"ESA Climate Data Toolbox – Quick Start Guide","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"VUowspzBlG"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#data-access","key":"OSieeSOTny"}],"key":"rVGkDqV4ON"}],"key":"sUI59nPcoM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cci_store = new_data_store(\"esa-cci\")\n# List all available data sets of an ECV\nlist_ecv_datasets(\"Cloud\")","key":"PGiwhRpdAd"},{"type":"output","id":"AJqe5jN9ian8sNy4UCZ00","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"[('esacci.CLOUD.mon.L3C.CLD_PRODUCTS.MODIS.Aqua.MODIS_AQUA.2-0.r1', 'esa-cci'),\n ('esacci.CLOUD.mon.L3C.CLD_PRODUCTS.MODIS.Terra.MODIS_TERRA.2-0.r1',\n  'esa-cci'),\n ('esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.multi-platform.ATSR2-AATSR.3-0.r1',\n  'esa-cci'),\n ('esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.multi-platform.AVHRR-AM.3-0.r1',\n  'esa-cci'),\n ('esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.multi-platform.AVHRR-PM.3-0.r1',\n  'esa-cci'),\n ('esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.multi-platform.MERIS-AATSR.2-0.r1',\n  'esa-cci'),\n ('ESACCI-L3C_CLOUD-CLD_PRODUCTS-MODIS_AQUA-200208-201412-fv2.0_kr1.0',\n  'esa-cci-kc'),\n ('ESACCI-L3C_CLOUD-CLD_PRODUCTS-ATSR2_AATSR-199506-201204-fv3.0-kr1.1',\n  'esa-cci-kc'),\n ('ESACCI-L3C_CLOUD-CLD_PRODUCTS-AVHRR_AM-199109-201612-fv3.0-kr1.1',\n  'esa-cci-kc'),\n ('ESACCI-L3C_CLOUD-CLD_PRODUCTS-AVHRR_PM-198201-201612-fv3.0-kr1.1',\n  'esa-cci-kc'),\n ('ESACCI-L3C_CLOUD-CLD_PRODUCTS-MERIS-AATSR_ENVISAT-200301-201112_fv2.0_kr1.0',\n  'esa-cci-kc'),\n ('ESACCI-L3C_CLOUD-CLD_PRODUCTS-AVHRR_NOAA-1982-2016-fv3.0.zarr',\n  'esa-cci-zarr')]","content_type":"text/plain"}}}],"key":"bhmKGXzxyV"}],"key":"gqCuRsLtep"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 3: Define the Dataset ID","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hcwgWSns7e"}],"identifier":"step-3-define-the-dataset-id","label":"Step 3: Define the Dataset ID","html_id":"step-3-define-the-dataset-id","implicit":true,"key":"GDNgpL41XP"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"To work with a specific ESA CCI dataset, we need to specify its ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rL7RhusUPV"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"dataset ID","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"pPmccEZCJu"}],"key":"l4F7aO2Y88"},{"type":"text","value":". This unique identifier tells the toolbox which variable and product we want to access.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"F60JVww5n4"}],"key":"HRbYCTfQqK"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"In this example, we are using a dataset from the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zwRWhjYH1k"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Cloud CCI project","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rLTN3Szebh"}],"key":"XD0GUKNxN3"},{"type":"text","value":" that provides monthly Level 3 cloud property products, derived from multiple satellite sensors. These products include key cloud variables such as ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Gj2TRicNpA"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"cloud fraction (cfc)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"hfNjHQIAeP"}],"key":"ZJ6IvJACEz"},{"type":"text","value":" and ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"CHhh7daJxc"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"liquid water path (lwp)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"k0zvkZDgVy"}],"key":"HlPRay6qoO"},{"type":"text","value":" including their uncertainties.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ax6iHBeCyW"}],"key":"W1LbgMF14L"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"We will use the following dataset ID:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Cnlt49R5XE"}],"key":"Y2IBW4M8JK"}],"key":"FpMz4hN3Bv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data_id = 'esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.multi-platform.AVHRR-PM.3-0.r1'\ncci_store.describe_data(data_id)","key":"xBykfoe0jH"},{"type":"output","id":"cycmBYfvncX9DQTw0nGyG","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"application/json":{"content_type":"application/json","hash":"4a745d7e7defa0d989f263f9fcd8a08b","path":"/cci-notebook-viewers/build/4a745d7e7defa0d989f263f9fcd8a08b.json"},"text/plain":{"content":"\u003cxcube.core.store.descriptor.DatasetDescriptor at 0x7f4b4eef6a50\u003e","content_type":"text/plain"}}}],"key":"USW6uxKa2Y"}],"key":"SfFn7EE8XX"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"You can find more information on the dataset on the CEDA website ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JYz1sumOMt"},{"type":"link","url":"https://catalogue.ceda.ac.uk/uuid/004fd44ff5124174ad3c03dd2c67d548/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"(Link)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oPF57kwe1r"}],"urlSource":"https://catalogue.ceda.ac.uk/uuid/004fd44ff5124174ad3c03dd2c67d548/","key":"dJbCUzo2Jq"},{"type":"text","value":".\nIf you click on “Related Documents”, you can find the documents about the algorithm description (ATBD CC4CL and ATBD). Those documents include the information on how the uncertainties are calculated and which parameters are included in the dataset.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BAGDxp7xkt"}],"key":"F1c4LA3ZHc"}],"key":"uzGQKV3iKo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 4: Define Time Range and Variables of Interest and Open the Dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N2SqjgBMJe"}],"identifier":"step-4-define-time-range-and-variables-of-interest-and-open-the-dataset","label":"Step 4: Define Time Range and Variables of Interest and Open the Dataset","html_id":"step-4-define-time-range-and-variables-of-interest-and-open-the-dataset","implicit":true,"key":"YOfqCS5DJA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Before opening the dataset, we define a few key parameters. We focus on only one day to decrease the dataload. If you wish to look at the time series of the uncertainties, you can change the start and end date to the desired time range.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"v3dvlCsr8A"}],"key":"NrpzjO1did"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Time range","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LeWsT3VAbe"}],"key":"QNPnA5YTrA"},{"type":"text","value":": the date(s) we want to load","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"hldM6YRoMg"}],"key":"swa6exGzI7"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Variables","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jyVfZL0JZa"}],"key":"XrEJYx4BMM"},{"type":"text","value":": which data variable(s) to retrieve","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"KMLH9sr4bX"}],"key":"A2nffxXqtO"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"(Optional)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"aRfGrLtM8N"}],"key":"ze9X2Xw3Kc"},{"type":"text","value":" ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"jBq5U2MUdX"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Bounding box","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"RLTKiUGKVa"}],"key":"sqC24AiOT1"},{"type":"text","value":": spatial region of interest — here we skip it to load the global dataset","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"llCs2b9ZuL"}],"key":"EicdxU6ppj"}],"key":"kNpv4VUmW5"}],"key":"s2qJs6CrNY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"variables = ['cfc','cfc_unc','lwp','lwp_unc','lwp_prop_unc','lwp_corr_unc']  # Variables to retrieve, their names can be found through the cci_store.describe_data(data_id) command above\nstart_date = '1997-12-01'    # Start and end date (same for a single timestep)\nend_date = '1997-12-01'","key":"QHIPwnJe7O"},{"type":"output","id":"36K34O5NMo8pP8Vr0eXp1","data":[],"key":"o5DJSgB22y"}],"key":"ea6nR6ffru"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now we open the dataset using the selected parameters.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mVLaipWSBq"},{"type":"break","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wFHu1Htxly"},{"type":"text","value":"The ESA Climate Toolbox will download only the necessary data (e.g., variable and time range).\nYou can always adjust the time range or variables to explore different slices of the dataset.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sp5gDHcggQ"}],"key":"NHDIJ3z9Jn"}],"key":"yJ1ZoBAiG6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cloud_ds = cci_store.open_data(\n    data_id=data_id,\n    variable_names=variables,\n    time_range=[start_date, end_date]\n)\ndisplay(cloud_ds)","key":"BljLIVBLMN"},{"type":"output","id":"NrK-lMXbzTmWFIN4ma4xi","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"6ef28f8e77dcab6ae7f1f1ebdc97d5e5","path":"/cci-notebook-viewers/build/6ef28f8e77dcab6ae7f1f1ebdc97d5e5.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 12MB\nDimensions:                       (time: 1, lat: 360, lon: 720,\n                                   hist1d_cer_bin_border: 12,\n                                   hist1d_cer_bin_centre: 11,\n                                   hist1d_cla_vis006_bin_border: 14,\n                                   hist1d_cla_vis006_bin_centre: 13,\n                                   hist1d_cla_vis008_bin_border: 14,\n                                   ...\n                                   hist1d_cwp_bin_centre: 14,\n                                   hist2d_cot_bin_border: 14,\n                                   hist2d_cot_bin_centre: 13,\n                                   hist2d_ctp_bin_border: 16,\n                                   hist2d_ctp_bin_centre: 15, hist_phase: 2,\n                                   bnds: 2)\nCoordinates: (12/23)\n  * hist1d_cer_bin_border         (hist1d_cer_bin_border) float32 48B 0.0 ......\n  * hist1d_cer_bin_centre         (hist1d_cer_bin_centre) float32 44B 1.5 ......\n  * hist1d_cla_vis006_bin_border  (hist1d_cla_vis006_bin_border) float32 56B ...\n  * hist1d_cla_vis006_bin_centre  (hist1d_cla_vis006_bin_centre) float32 52B ...\n  * hist1d_cla_vis008_bin_border  (hist1d_cla_vis008_bin_border) float32 56B ...\n  * hist1d_cla_vis008_bin_centre  (hist1d_cla_vis008_bin_centre) float32 52B ...\n    ...                            ...\n  * hist2d_ctp_bin_centre         (hist2d_ctp_bin_centre) float32 60B 45.5 .....\n  * hist_phase                    (hist_phase) int8 2B 0 1\n  * lat                           (lat) float32 1kB -89.75 -89.25 ... 89.75\n  * lon                           (lon) float32 3kB -179.8 -179.2 ... 179.8\n  * time                          (time) datetime64[ns] 8B 1997-12-16T12:00:00\n    time_bnds                     (time, bnds) datetime64[ns] 16B dask.array\u003cchunksize=(1, 2), meta=np.ndarray\u003e\nDimensions without coordinates: bnds\nData variables:\n    cfc                           (time, lat, lon) float64 2MB dask.array\u003cchunksize=(1, 360, 720), meta=np.ndarray\u003e\n    cfc_unc                       (time, lat, lon) float64 2MB dask.array\u003cchunksize=(1, 360, 720), meta=np.ndarray\u003e\n    lwp                           (time, lat, lon) float64 2MB dask.array\u003cchunksize=(1, 360, 720), meta=np.ndarray\u003e\n    lwp_corr_unc                  (time, lat, lon) float64 2MB dask.array\u003cchunksize=(1, 360, 720), meta=np.ndarray\u003e\n    lwp_prop_unc                  (time, lat, lon) float64 2MB dask.array\u003cchunksize=(1, 360, 720), meta=np.ndarray\u003e\n    lwp_unc                       (time, lat, lon) float64 2MB dask.array\u003cchunksize=(1, 360, 720), meta=np.ndarray\u003e\nAttributes:\n    Conventions:             CF-1.7\n    title:                   esacci.CLOUD.mon.L3C.CLD_PRODUCTS.multi-sensor.m...\n    date_created:            2025-06-18T13:35:53.010899\n    processing_level:        L3C\n    time_coverage_start:     1997-12-01T00:00:00\n    time_coverage_end:       1998-01-01T00:00:00\n    time_coverage_duration:  P31DT0H0M0S\n    history:                 [{'program': 'xcube_cci.chunkstore.CciChunkStore...","content_type":"text/plain"}}}],"key":"RRtERZ1Qsn"}],"key":"eMy4epfHMm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 5: Extract the Variables and create a 3D Plot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LuFAXMmBiT"}],"identifier":"step-5-extract-the-variables-and-create-a-3d-plot","label":"Step 5: Extract the Variables and create a 3D Plot","html_id":"step-5-extract-the-variables-and-create-a-3d-plot","implicit":true,"key":"FMZazlBG6S"},{"type":"heading","depth":4,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Cloud Fraction (CFC)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"WLbAfzNwqA"}],"identifier":"cloud-fraction-cfc","label":"Cloud Fraction (CFC)","html_id":"cloud-fraction-cfc","implicit":true,"key":"EmBFnTCZKG"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Next, we extract the variables we would like to plot. We start with the cloud fraction (CFC) and its uncertainty.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ibYltIYmwO"}],"key":"qVoo1tAyOI"}],"key":"wj5xoO684y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Extract variables\ncfc = cloud_ds['cfc'].squeeze()\ncfc_unc = cloud_ds['cfc_unc'].squeeze()\n\n# Get coordinate arrays - the lat and lon are the same for cfc_unc and cfc, thus we only load them here via the cfc variable\nlon = cfc['lon'].values\nlat = cfc['lat'].values\n\n# Get 2D grids (assuming dims are [lat, lon])\nz_unc = cfc_unc.values  # Uncertainty for Z-axis\nsurface_color = cfc.values  # For coloring the surface","key":"TeCegxANuA"},{"type":"output","id":"9xgzg2JKUmPni6L2M1XgG","data":[],"key":"ttc7pNPy3p"}],"key":"AlE69tTLYw"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"adKKAMO1QL"},{"type":"inlineCode","value":"plotly","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hV51V6NRIG"},{"type":"text","value":" package to create an interactive plot of the uncertainty. We use the CFC as color and the uncertainty will be shown on the vertical axis.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yycv8LOeFy"}],"key":"j2WvRsnamF"}],"key":"n8ZQ6M4irc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create 2D coordinate grids\nlon2d, lat2d = np.meshgrid(lon, lat)\n\n# Check that all arrays have the same shape\nassert lon2d.shape == lat2d.shape == z_unc.shape == surface_color.shape, \"Shape mismatch\"\n\n# Create surface plot, define hover variables too show data via mouse hovering\nfig = go.Figure(\n    data=[go.Surface(\n        x=lon2d,\n        y=lat2d,\n        z=z_unc,\n        surfacecolor=surface_color,\n        colorscale=\"Blues_r\",\n        colorbar=dict(title=\"Cloud Fraction\"),\n        hovertemplate=\n            \"Longitude: %{x}\u003cbr\u003e\" +\n            \"Latitude: %{y}\u003cbr\u003e\" +\n            \"Uncertainty in %: %{z:.2f}\u003cbr\u003e\"\n    )]\n)\n\nfig.update_layout(\n    title=dict(text='Cloud Fraction Uncertainty Surface'),\n    autosize=False,\n    width=700,\n    height=600,\n    margin=dict(l=65, r=50, b=65, t=90),\n    scene=dict(\n        xaxis_title=\"Longitude\",\n        yaxis_title=\"Latitude\",\n        zaxis_title=\"Uncertainty in %\",\n        yaxis=dict(range=[90, -90]),  # Reverse latitude axis \n        xaxis=dict(range=[180,-180]) # Reverse longitude axis\n    )\n)\n\nfig.show()\n","key":"o76UEHTTQr"},{"type":"output","id":"ZDmA_XJRFFKW63aSE1Te4","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"        \u003cscript type=\"text/javascript\"\u003e\n        window.PlotlyConfig = {MathJaxConfig: 'local'};\n        if (window.MathJax \u0026\u0026 window.MathJax.Hub \u0026\u0026 window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\n        \u003c/script\u003e\n        \u003cscript type=\"module\"\u003eimport \"https://cdn.plot.ly/plotly-3.0.1.min\"\u003c/script\u003e\n        ","content_type":"text/html"}}},{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"fac681c39324ffa305a473e1f83bd21b","path":"/cci-notebook-viewers/build/fac681c39324ffa305a473e1f83bd21b.html"}}}],"key":"xcIuES9D0F"}],"key":"kqUXwVX5sM"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What do we see?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aUCoIOxYfM"}],"identifier":"what-do-we-see","label":"What do we see?","html_id":"what-do-we-see","implicit":true,"key":"tRfSmZLTkV"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The uncertainties in Cloud Fraction Cover (CFC) are relatively straightforward to interpret.\nThey are based on the average probability of cloud presence for each pixel, where the cloud detection algorithm classifies pixels as either “cloud” (1) or “no cloud” (0).","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bzqsMdCyUg"}],"key":"hI4jfH65Du"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Uncertainties arise in cases where the classification is ambiguous—for example, over bright surfaces like snow or desert, where high surface albedo makes it difficult to distinguish clouds from the background. In such situations, the cloud detection confidence is reduced, leading to higher uncertainty values. We can see this above Antarctica, for example, where the uncertainty is abruptly rising while above the ocean along the coast of Antarctica and further north, the uncertainties are very low.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SAbBSPVgkK"}],"key":"wpwf6ycbZj"}],"key":"diJ8fprI7w"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Liquid Water Path (LWP)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ofmdmxxRbM"}],"identifier":"liquid-water-path-lwp","label":"Liquid Water Path (LWP)","html_id":"liquid-water-path-lwp","implicit":true,"key":"LzD5TbfyNl"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Now we move on to a more complex parameter, the liquid water path (LWP).","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"QHUSmarsVG"}],"key":"eHY0dHBSTt"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Satellite retrievals of LWP are based on radiative measurements (like reflectance, brightness temperature) which are fed into physical models. These retrievals are subject to various uncertainties, which are separated into two main types:","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kGIJ2hSvXx"}],"key":"Kb5oaL7Dmy"},{"type":"heading","depth":5,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"1. Propagated Uncertainty (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"G2ACSr8w99"},{"type":"inlineCode","value":"lwp_prop_unc","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"JEy3fFlenO"},{"type":"text","value":")","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"eW7VyqF6K5"}],"key":"dEHx3eMkIS"}],"identifier":"id-1-propagated-uncertainty-lwp-prop-unc","label":"1. Propagated Uncertainty (lwp_prop_unc)","html_id":"id-1-propagated-uncertainty-lwp-prop-unc","implicit":true,"key":"Cnw21f8shX"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Definition:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"RvbeXkWLpZ"}],"key":"RKCuJ6K7N2"}],"key":"zNESOrXaPg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Uncertainties that originate from input measurements and propagate through the retrieval algorithm.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"vhlMFCSqgR"}],"key":"sstBdVoAaS"}],"key":"yEwQDPlXtv"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"These stem from:","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"RQxN7pQPwt"}],"key":"cyGkJsKRWx"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Instrumental noise","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"K4ZCQxRK5t"}],"key":"HfZEbO21wh"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Calibration errors","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"fmWHLaKyLs"}],"key":"PyL4P5InXI"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Assumed atmospheric conditions","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"mYqhZ5jm2L"}],"key":"G3r0HigS1Z"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Model assumptions within the retrieval algorithm","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"YPJRVVdLtR"}],"key":"tYtxpVzG4H"}],"key":"vkapqpUsWJ"}],"key":"JDXdtem6Cr"}],"key":"R0EOpqZtlg"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"How it’s computed:","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"qP9VOcBxCU"}],"key":"WNGCBURbNG"}],"key":"G9Kpz48jhz"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":20,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Derived by error propagation using ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"yT4YlgAlg0"},{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"analytic formulas","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"itzEejuf94"}],"key":"IqZCsd85w6"},{"type":"text","value":" or ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"hX1YyzBiFI"},{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"sensitivity analysis","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"LAYSSmHha3"}],"key":"aI1OBNDaY1"},{"type":"text","value":".","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"bTN370KhPb"}],"key":"TZPUjoyHnw"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"It accounts for how small errors in input variables affect the output (LWP).","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"Mm5ajuW4mj"}],"key":"z7cTYnMzvd"}],"key":"RfhluHxJCL"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"strong","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Characteristics:","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"Ejuiloe1xE"}],"key":"FH0BJ10zye"}],"key":"eqeWIcHbX6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":25,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Pixel-specific","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"jhm8UXPaJX"}],"key":"MWp3DmGDf4"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Varies with atmospheric conditions, viewing geometry, surface type","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"xaoEHx4ZU2"}],"key":"VoHI7HjPhk"}],"key":"JKAUzxMkYN"},{"type":"heading","depth":5,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"2. Correlated Uncertainty (","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"q1g5DXTK53"},{"type":"inlineCode","value":"lwp_corr_unc","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"LsjssU0E7I"},{"type":"text","value":")","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"vOvzjiFApE"}],"key":"XwCs4r4YSx"}],"identifier":"id-2-correlated-uncertainty-lwp-corr-unc","label":"2. Correlated Uncertainty (lwp_corr_unc)","html_id":"id-2-correlated-uncertainty-lwp-corr-unc","implicit":true,"key":"A0M4mByQLN"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"strong","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Definition","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"pAfNSacBQF"}],"key":"CxzRPCpq63"}],"key":"YB4TW7sDU1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":31,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Uncertainties that are spatially or temporally correlated, not random per pixel.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"Uwn7qZIbod"}],"key":"cRpbn57VCk"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"These come from:","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"zAAZsNYs6D"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":33,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Systematic biases in retrieval algorithms","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"ZpG8gdKDDh"}],"key":"LLAEU7vDok"},{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Assumptions in radiative transfer models","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"jCJMVqhev1"}],"key":"mBxX9Zxbhi"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"Shared calibration errors across multiple observations","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"gMLwQTLna3"}],"key":"XqOWR1Hqon"}],"key":"FEaqY01u66"}],"key":"ypRi7oVzAT"}],"key":"OBBa5yDgTQ"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"strong","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Characteristics:","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"iqAeWcx8IA"}],"key":"R3BTc8k43N"}],"key":"SnH6nb6r9G"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":39,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Not independent from pixel to pixel","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"LpPECHTczB"}],"key":"Syi393Ntps"},{"type":"listItem","spread":true,"position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"Important for regional or temporal averaging","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"qOmTDdfcOG"}],"key":"woiFw4LxJU"},{"type":"listItem","spread":true,"position":{"start":{"line":41,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"Not properly accounting for this can lead to overconfident estimates","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"GZIj1k6DCQ"}],"key":"IXBLUyuubH"}],"key":"c5n7Iufvrk"},{"type":"heading","depth":5,"position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"3. Total Uncertainty (","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"NPdCFqLfoZ"},{"type":"inlineCode","value":"lwp_unc","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"PN23V1r9Um"},{"type":"text","value":")","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"GOUt8PPi1P"}],"key":"Kb1sRwsOLt"}],"identifier":"id-3-total-uncertainty-lwp-unc","label":"3. Total Uncertainty (lwp_unc)","html_id":"id-3-total-uncertainty-lwp-unc","implicit":true,"key":"pNtXzzV2NP"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"ESA CCI computes total uncertainty as a quadrature sum of both components:","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"EHk0KlQoeS"}],"key":"UnwIaA5exZ"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"inlineMath","value":"\\text{lwp\\_unc} = \\sqrt{(\\text{lwp\\_prop\\_unc})^2 + (\\text{lwp\\_corr\\_unc})^2}","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"html":"\u003cspan class=\"katex\"\u003e\u003cspan class=\"katex-mathml\"\u003e\u003cmath xmlns=\"http://www.w3.org/1998/Math/MathML\"\u003e\u003csemantics\u003e\u003cmrow\u003e\u003cmtext\u003elwp_unc\u003c/mtext\u003e\u003cmo\u003e=\u003c/mo\u003e\u003cmsqrt\u003e\u003cmrow\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmtext\u003elwp_prop_unc\u003c/mtext\u003e\u003cmsup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003cmo\u003e+\u003c/mo\u003e\u003cmo stretchy=\"false\"\u003e(\u003c/mo\u003e\u003cmtext\u003elwp_corr_unc\u003c/mtext\u003e\u003cmsup\u003e\u003cmo stretchy=\"false\"\u003e)\u003c/mo\u003e\u003cmn\u003e2\u003c/mn\u003e\u003c/msup\u003e\u003c/mrow\u003e\u003c/msqrt\u003e\u003c/mrow\u003e\u003cannotation encoding=\"application/x-tex\"\u003e\\text{lwp\\_unc} = \\sqrt{(\\text{lwp\\_prop\\_unc})^2 + (\\text{lwp\\_corr\\_unc})^2}\u003c/annotation\u003e\u003c/semantics\u003e\u003c/math\u003e\u003c/span\u003e\u003cspan class=\"katex-html\" aria-hidden=\"true\"\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.0044em;vertical-align:-0.31em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003elwp_unc\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003cspan class=\"mrel\"\u003e=\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2778em;\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"base\"\u003e\u003cspan class=\"strut\" style=\"height:1.24em;vertical-align:-0.335em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord sqrt\"\u003e\u003cspan class=\"vlist-t vlist-t2\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.905em;\"\u003e\u003cspan class=\"svg-align\" style=\"top:-3.2em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.2em;\"\u003e\u003c/span\u003e\u003cspan class=\"mord\" style=\"padding-left:1em;\"\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003elwp_prop_unc\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7401em;\"\u003e\u003cspan style=\"top:-2.989em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mbin\"\u003e+\u003c/span\u003e\u003cspan class=\"mspace\" style=\"margin-right:0.2222em;\"\u003e\u003c/span\u003e\u003cspan class=\"mopen\"\u003e(\u003c/span\u003e\u003cspan class=\"mord text\"\u003e\u003cspan class=\"mord\"\u003elwp_corr_unc\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"mclose\"\u003e\u003cspan class=\"mclose\"\u003e)\u003c/span\u003e\u003cspan class=\"msupsub\"\u003e\u003cspan class=\"vlist-t\"\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.7401em;\"\u003e\u003cspan style=\"top:-2.989em;margin-right:0.05em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:2.7em;\"\u003e\u003c/span\u003e\u003cspan class=\"sizing reset-size6 size3 mtight\"\u003e\u003cspan class=\"mord mtight\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"top:-2.865em;\"\u003e\u003cspan class=\"pstrut\" style=\"height:3.2em;\"\u003e\u003c/span\u003e\u003cspan class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'\u003e\u003cpath d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-s\"\u003e​\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"vlist-r\"\u003e\u003cspan class=\"vlist\" style=\"height:0.335em;\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e","key":"mhA1RHh0ty"}],"key":"laPxfBON1X"},{"type":"paragraph","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"This assumes the propagated and correlated components are independent.","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"UQJpmEDm6i"}],"key":"jecprsJoUX"},{"type":"heading","depth":5,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"strong","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"text","value":"Why is the combination of uncertainties relevant?","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"la9cYCVJr2"}],"key":"f41JcmKTAx"}],"identifier":"why-is-the-combination-of-uncertainties-relevant","label":"Why is the combination of uncertainties relevant?","html_id":"why-is-the-combination-of-uncertainties-relevant","implicit":true,"key":"IRqsc7iC2h"},{"type":"paragraph","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"If you’re analyzing individual pixels, the propagated uncertainty dominates. If you’re computing regional means or trends, you must consider correlated uncertainty — otherwise, your confidence intervals will be too optimistic.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"Mq47e8KWWi"}],"key":"BjOXglEH1i"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"In this publication, you can read a more detailed description: ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"F5HcwEfG87"},{"type":"cite","url":"https://doi.org/10.5194/essd-9-881-2017","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Stengel et al., Cloud property datasets retrieved from AVHRR, MODIS, AATSR and MERIS in the framework of the Cloud_cci project (2017)","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"EdAEbTOuW4"}],"kind":"narrative","label":"Stengel_2017","identifier":"https://doi.org/10.5194/essd-9-881-2017","enumerator":"1","key":"iZCk5aQNsp"},{"type":"text","value":".","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"bJHg5DunOx"}],"key":"v70zyKmosM"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"In this ESA Cloud CCI Product User Guide, you can find all parameters and uncertainties listed: ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"u7rs9Fh8dc"},{"type":"link","url":"https://climate.esa.int/media/documents/Cloud_Product-User-Guide-PUG_v5.1.pdf","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"ESA Cloud_cci Product User Guide (PUG)","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"eRcu4JwbLE"}],"urlSource":"https://climate.esa.int/media/documents/Cloud_Product-User-Guide-PUG_v5.1.pdf","key":"MewkXKpFvE"},{"type":"text","value":".","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"VAZLtQwyJ5"}],"key":"pVNlB9V5ZS"}],"key":"H7SJHTugmY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plotting the Correlated Uncertainty","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FDP2KsNlQM"}],"identifier":"plotting-the-correlated-uncertainty","label":"Plotting the Correlated Uncertainty","html_id":"plotting-the-correlated-uncertainty","implicit":true,"key":"ZINiGI0lhi"}],"key":"cEXwWXlIBJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Extract and squeeze variables\nlwp = cloud_ds['lwp'].squeeze()\nlwp_corr_unc = cloud_ds['lwp_corr_unc'].squeeze()\n\n# Get 1D coordinate arrays\nlon = lwp['lon'].values\nlat = lwp['lat'].values\n\n# Create 2D coordinate grids\nlon2d, lat2d = np.meshgrid(lon, lat)\n\n# Get 2D data arrays\nz_unc = lwp_corr_unc.values\nsurface_color = lwp.values\n\n# Check that all arrays have the same shape\nassert lon2d.shape == lat2d.shape == z_unc.shape == surface_color.shape, \"Shape mismatch\"\n\n# Create surface plot\nfig = go.Figure(\n    data=[go.Surface(\n        x=lon2d,\n        y=lat2d,\n        z=z_unc,\n        surfacecolor=surface_color,\n        colorscale=\"viridis\",\n        colorbar=dict(title=\"Liquid Water Path (g/m2)\"),\n        cmin = 0,\n        cmax = 500,\n        hovertemplate=\n            \"Longitude: %{x}\u003cbr\u003e\" +\n            \"Latitude: %{y}\u003cbr\u003e\" +\n            \"Correlated Uncertainty (g/m2): %{z:.2f}\u003cbr\u003e\"\n    )]\n)\n\nfig.update_layout(\n    title=dict(text='Liquid Water Path Correlated Uncertainty'),\n    autosize=False,\n    width=700,\n    height=600,\n    margin=dict(l=65, r=50, b=65, t=90),\n    scene=dict(\n        xaxis_title=\"Longitude\",\n        yaxis_title=\"Latitude\",\n        zaxis_title=\"Correlated Uncertainty (g/m2)\",\n        yaxis=dict(range=[90, -90]),  # Reverse latitude axis \n        xaxis=dict(range=[180,-180]) # Reverse longitude axis\n    )\n)\n\n# uncomment the next line \"fig.show()\" AND comment the \"pass\" command to show the figure:\n#fig.show()\npass","key":"McD3e0Moxu"},{"type":"output","id":"yAzca8xEQEbtcEmUtnfLg","data":[],"key":"iJ22SKf5Ud"}],"key":"nOVEYZJqA3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Extract and squeeze variables\nlwp = cloud_ds['lwp'].squeeze()\nlwp_prop_unc = cloud_ds['lwp_prop_unc'].squeeze()\n\n# Get 1D coordinate arrays\nlon = lwp['lon'].values\nlat = lwp['lat'].values\n\n# Create 2D coordinate grids\nlon2d, lat2d = np.meshgrid(lon, lat)\n\n# Get 2D data arrays\nz_unc = lwp_prop_unc.values\nsurface_color = lwp.values\n\n# Check that all arrays have the same shape\nassert lon2d.shape == lat2d.shape == z_unc.shape == surface_color.shape, \"Shape mismatch\"\n\n# Create surface plot\nfig = go.Figure(\n    data=[go.Surface(\n        x=lon2d,\n        y=lat2d,\n        z=z_unc,\n        surfacecolor=surface_color,\n        colorscale=\"viridis\",\n        colorbar=dict(title=\"Liquid Water Path (g/m2)\"),\n        cmin = 0,\n        cmax = 500,\n        hovertemplate=\n            \"Longitude: %{x}\u003cbr\u003e\" +\n            \"Latitude: %{y}\u003cbr\u003e\" +\n            \"Propagated Uncertainty (g/m2): %{z:.2f}\u003cbr\u003e\"\n    )]\n)\n\nfig.update_layout(\n    title=dict(text='Liquid Water Path Propagated Uncertainty'),\n    autosize=False,\n    width=700,\n    height=600,\n    margin=dict(l=65, r=50, b=65, t=90),\n    scene=dict(\n        xaxis_title=\"Longitude\",\n        yaxis_title=\"Latitude\",\n        zaxis_title=\"Propagated Uncertainty (g/m2)\",\n        yaxis=dict(range=[90, -90]),  # Reverse latitude axis \n        xaxis=dict(range=[180,-180]) # Reverse longitude axis\n    )\n)\n\n# uncomment the next line \"fig.show()\" AND comment the \"pass\" command to show the figure:\n#fig.show()\npass","key":"uZ6YvUYUkN"},{"type":"output","id":"2-1_7vhQbaC1ib5bNdk8z","data":[],"key":"tCnS4lZmLH"}],"key":"WI6LmBjABd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plotting the total uncertainty of LWP","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LUC4IbYmvD"}],"identifier":"plotting-the-total-uncertainty-of-lwp","label":"Plotting the total uncertainty of LWP","html_id":"plotting-the-total-uncertainty-of-lwp","implicit":true,"key":"iLy2aYlpnU"}],"key":"DQ9NwauZjI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Extract and squeeze variables\nlwp = cloud_ds['lwp'].squeeze()\nlwp_unc = cloud_ds['lwp_unc'].squeeze()\n\n# Get 1D coordinate arrays\nlon = lwp['lon'].values\nlat = lwp['lat'].values\n\n# Create 2D coordinate grids\nlon2d, lat2d = np.meshgrid(lon, lat)\n\n# Get 2D data arrays\nz_unc = lwp_unc.values\nsurface_color = lwp.values\n\n# Check that all arrays have the same shape\nassert lon2d.shape == lat2d.shape == z_unc.shape == surface_color.shape, \"Shape mismatch\"\n\n# Create surface plot\nfig = go.Figure(\n    data=[go.Surface(\n        x=lon2d,\n        y=lat2d,\n        z=z_unc,\n        surfacecolor=surface_color,\n        colorscale=\"viridis\",\n        colorbar=dict(title=\"Liquid Water Path (g/m2)\"),\n        cmin = 0,\n        cmax = 500,\n        hovertemplate=\n            \"Longitude: %{x}\u003cbr\u003e\" +\n            \"Latitude: %{y}\u003cbr\u003e\" +\n            \"Uncertainty (g/m2): %{z:.2f}\u003cbr\u003e\"\n    )]\n)\n\nfig.update_layout(\n    title=dict(text='Liquid Water Path Total Uncertainty'),\n    autosize=False,\n    width=700,\n    height=600,\n    margin=dict(l=65, r=50, b=65, t=90),\n    scene=dict(\n        xaxis_title=\"Longitude\",\n        yaxis_title=\"Latitude\",\n        zaxis_title=\"Uncertainty (g/m2)\",\n        yaxis=dict(range=[90, -90]),  # Reverse latitude axis \n        xaxis=dict(range=[180,-180]) # Reverse longitude axis\n    )\n)\n\n# uncomment the next line \"fig.show()\" AND comment the \"pass\" command to show the figure:\n#fig.show()\npass","key":"gQV2OyCmwP"},{"type":"output","id":"d2vmyOwzpdujCenSl6-Rp","data":[],"key":"GNffyAe5tX"}],"key":"MdgrWC9c8L"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What do we see?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i9Hak9s8lg"}],"identifier":"what-do-we-see","label":"What do we see?","html_id":"what-do-we-see-1","implicit":true,"key":"aEXaTANIIE"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The uncertainty increases toward the northern polar region. Since this data is from December, the Sun’s zenith angle is low in these latitudes, resulting in limited visible light and higher retrieval uncertainty. Therefore, the high LWP values observed in the northern hemisphere should be interpreted with caution, as they are associated with high uncertainty.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"SSUGWMaaku"}],"key":"mUA69eERoi"}],"key":"fHOa9oqE03"}],"key":"j8KM0CEoSQ"},"references":{"cite":{"order":["Stengel_2017"],"data":{"Stengel_2017":{"label":"Stengel_2017","enumerator":"1","doi":"10.5194/essd-9-881-2017","html":"Stengel, M., Stapelberg, S., Sus, O., Schlundt, C., Poulsen, C., Thomas, G., Christensen, M., Carbajal Henken, C., Preusker, R., Fischer, J., Devasthale, A., Willén, U., Karlsson, K.-G., McGarragh, G. R., Proud, S., Povey, A. C., Grainger, R. G., Meirink, J. F., Feofilov, A., … Hollmann, R. (2017). Cloud property datasets retrieved from AVHRR, MODIS, AATSR and MERIS in the framework of the Cloud_cci project. \u003ci\u003eEarth System Science Data\u003c/i\u003e, \u003ci\u003e9\u003c/i\u003e(2), 881–904. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5194/essd-9-881-2017\"\u003e10.5194/essd-9-881-2017\u003c/a\u003e","url":"https://doi.org/10.5194/essd-9-881-2017"}}}},"footer":{"navigation":{"prev":{"title":"Step 1. Setup \u0026 Imports","url":"/external-notebooks/esa-cci/ect-training/lps-vienna-06-2025/lps-beginner","group":"Lps Vienna 06 2025"},"next":{"title":"Questions We Aim to Explore","url":"/external-notebooks/esa-cci/ect-training/lps-vienna-06-2025/lps-intermediate-level-elnino","group":"Lps Vienna 06 2025"}}},"domain":"http://localhost:3000"},"project":{"subject":"CCI Examples","title":"CCI Examples","description":"Collection of examples relevant to the CCI activity","github":"https://github.com/esa-cci/cci-notebook-viewers","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Esa Cci","level":2},{"title":"Cci Notebooks","level":3},{"slug":"external-notebooks.esa-cci.cci-notebooks.readme","title":"cci-notebooks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebooks","level":4},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.aerosol-cci","title":"Getting Started with Aerosol CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.biomass-cci","title":"Getting Started with Biomass CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.cloud-cci","title":"Getting Started with Cloud CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.fire-cci","title":"Getting Started with Fire CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ghg-cci","title":"Getting Started with Greenhouse Gases CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.icesheets-cci","title":"Getting Started with Ice Sheets CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lakes-cci","title":"Getting Started with Lakes CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.landcover-cci","title":"Getting Started with Land Cover CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lst-cci","title":"Getting Started with Land Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.oceancolour-cci","title":"Getting Started with Ocean Colour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ozone-cci","title":"Getting Started with Ozone CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.permafrost-cci","title":"Getting Started with Permafrost CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.seaice-cci","title":"Getting Started with Sea Ice CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sealevel-cci","title":"Getting Started with Sea Level CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.snow-cci","title":"Getting Started with Snow CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.soilmoisture-cci","title":"Getting Started with Soil Moisture CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sss-cci","title":"Getting Started with Sea Surface Salinity CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sst-cci","title":"Getting Started with Sea Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.vegetation-cci","title":"Getting Started with Vegetation CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.watervapour-cci","title":"Getting Started with Water Vapour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Ect Training","level":3},{"slug":"external-notebooks.esa-cci.ect-training.readme","title":"ect-training","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"ESA Climate Change Competition","level":4},{"slug":"external-notebooks.esa-cci.ect-training.esa-climate-change-competition.competition-forests-in-a-changing-climate","title":"Explore forests in a changing climate with the ESA CCI datasets","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lps Vienna 06 2025","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-beginner","title":"Step 1. Setup \u0026 Imports","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-cloud-uncertainties","title":"1. Import Necessary Packages","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-intermediate-level-elnino","title":"Questions We Aim to Explore","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lst Leicester 12 2024","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lst-leicester-12-2024.lst-training","title":"Analyzing Land Surface Temperature and Uncertainties: Insights from ESA CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/cci-notebook-viewers/build/manifest-ED236704.js";
import * as route0 from "/cci-notebook-viewers/build/root-ZJOPFBMV.js";
import * as route1 from "/cci-notebook-viewers/build/routes/$-CQPS5IOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/cci-notebook-viewers/build/entry.client-UNPC4GT3.js");</script></body></html>