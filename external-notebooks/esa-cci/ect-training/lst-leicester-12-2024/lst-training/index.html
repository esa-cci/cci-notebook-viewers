<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Analyzing Land Surface Temperature and Uncertainties: Insights from ESA CCI Data - CCI Examples</title><meta property="og:title" content="Analyzing Land Surface Temperature and Uncertainties: Insights from ESA CCI Data - CCI Examples"/><meta name="generator" content="mystmd"/><meta name="description" content="Collection of examples relevant to the CCI activity"/><meta property="og:description" content="Collection of examples relevant to the CCI activity"/><meta name="keywords" content=""/><link rel="stylesheet" href="/cci-notebook-viewers/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/cci-notebook-viewers/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/cci-notebook-viewers/favicon.ico"/><link rel="stylesheet" href="/cci-notebook-viewers/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block lg:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/cci-notebook-viewers/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] lg:hidden hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"></div></nav></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-none pr-2 smallcaps">CCI Examples</div><div class="flex-grow"></div><a href="https://github.com/esa-cci/cci-notebook-viewers" title="GitHub Repository: esa-cci/cci-notebook-viewers" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/esa-cci/cci-notebook-viewers/blob/main/external_notebooks/esa-cci/ect-training/lst_leicester_12_2024/LST_Training.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="mb-0">Analyzing Land Surface Temperature and Uncertainties: Insights from ESA CCI Data</h1></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><div id="JxRDgNsDQ9" class="relative group/block"><p>This notebook guides you through analyzing Land Surface Temperature (LST) data from the ESA Climate Change Initiative (CCI) to study urban heat islands, focusing on the Leicestershire region. We’ll use LST data alongside land cover information to identify temperature differences between urban and non-urban areas. Additionally, we’ll discuss uncertainties associated with LST data products.</p></div><div id="GHFjwAm14E" class="relative group/block"><h3 id="objectives" class="relative group"><span class="heading-text">Objectives</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#objectives" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><ul><li>Access and visualize LST data for Leicestershire using the ESA CCI toolbox.</li><li>Analyze urban heat islands in Leicestershire by comparing urban and non-urban areas.</li><li>Explore uncertainties in LST data and interpret quality flags.</li></ul></div><div id="zYbdzlCn9F" class="relative group/block"><h4 id="add-imports" class="relative group"><span class="heading-text">Add imports</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#add-imports" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>To run this Notebook, make sure the ESA CCI Toolbox is setup correctly.</p></div><div id="DsGARfEBJL" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">from xcube.core.store import new_data_store
import IPython.display
import shapely.geometry
import matplotlib.pyplot as plt
from esa_climate_toolbox.core import get_store
from esa_climate_toolbox.core import get_op
from esa_climate_toolbox.core import list_ecv_datasets
from esa_climate_toolbox.core import list_datasets
from esa_climate_toolbox.ops import downsample_2d
from esa_climate_toolbox.ops import coregister
import matplotlib
import numpy as np
import xarray as xr</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FYIWF6AVM_I00BaGeTH83" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ZX0BNSgF1R" class="relative group/block"><h2 id="id-1-access-and-visualize-lst-data" class="relative group"><span class="heading-text">1. Access and visualize LST data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-1-access-and-visualize-lst-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In this section, we explore how to access Land Surface Temperature (LST) data from the ESA Climate Change Initiative (CCI) data store. This includes identifying datasets of interest, understanding their metadata, and preparing for subsequent analysis.</p><p>The ESA CCI provides high-quality, harmonized climate data records that are essential for monitoring and understanding climate variability and trends. These datasets are generated using consistent algorithms across space and time, ensuring their reliability for climate research and applications.</p></div><div id="XwoCGJT304" class="relative group/block"><h4 id="filter-and-select-lst-data" class="relative group"><span class="heading-text">Filter and Select LST Data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#filter-and-select-lst-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>Identify LST datasets based on spatial and temporal requirements. The <code>list_ecv_datasets</code> command returns the names of datasets for a given essential climate variable.</p></div><div id="orCaKzCTcV" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">list_ecv_datasets(&quot;LST&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-GbdQKrcIRW_ybri91wbi" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[(&#x27;esacci.LST.3-hours.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.r1&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3C.LST.AATSR.Envisat.ATSR_3.3-00.DAY&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3C.LST.AATSR.Envisat.ATSR_3.3-00.NIGHT&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3C.LST.ATSR-2.ERS-2.ATSR_2.3-00.DAY&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3C.LST.ATSR-2.ERS-2.ATSR_2.3-00.NIGHT&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3C.LST.MODIS.Aqua.MODISA.3-00.DAY&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3C.LST.MODIS.Aqua.MODISA.3-00.NIGHT&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3C.LST.MODIS.Terra.MODIST.3-00.DAY&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3C.LST.MODIS.Terra.MODIST.3-00.NIGHT&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3C.LST.SLSTR.Sentinel-3A.SLSTRA.3-00.DAY&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3C.LST.SLSTR.Sentinel-3A.SLSTRA.3-00.NIGHT&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3C.LST.SLSTR.Sentinel-3B.SLSTRB.3-00.DAY&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3C.LST.SLSTR.Sentinel-3B.SLSTRB.3-00.NIGHT&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3C.LST.multi-sensor.multi-platform.SSMI_SSMIS.v2-33.ASC&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3C.LST.multi-sensor.multi-platform.SSMI_SSMIS.v2-33.DES&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3S.LST.multi-sensor.multi-platform.IRCDR.2-00.DAY&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.day.L3S.LST.multi-sensor.multi-platform.IRCDR.2-00.NIGHT&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3C.LST.AATSR.Envisat.ATSR_3.3-00.DAY&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3C.LST.AATSR.Envisat.ATSR_3.3-00.NIGHT&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3C.LST.ATSR-2.ERS-2.ATSR_2.3-00.DAY&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3C.LST.ATSR-2.ERS-2.ATSR_2.3-00.NIGHT&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3C.LST.MODIS.Aqua.MODISA.3-00.DAY&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3C.LST.MODIS.Aqua.MODISA.3-00.NIGHT&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3C.LST.MODIS.Terra.MODIST.3-00.DAY&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3C.LST.MODIS.Terra.MODIST.3-00.NIGHT&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3C.LST.SLSTR.Sentinel-3A.SLSTRA.3-00.DAY&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3C.LST.SLSTR.Sentinel-3A.SLSTRA.3-00.NIGHT&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3C.LST.SLSTR.Sentinel-3B.SLSTRB.3-00.DAY&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3C.LST.SLSTR.Sentinel-3B.SLSTRB.3-00.NIGHT&#x27;, &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3C.LST.multi-sensor.multi-platform.SSMI_SSMIS.v2-33.ASC&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3C.LST.multi-sensor.multi-platform.SSMI_SSMIS.v2-33.DES&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRCDR.2-00.DAY&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRCDR.2-00.NIGHT&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.00:00UTC&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.03:00UTC&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.06:00UTC&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.09:00UTC&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.12:00UTC&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.15:00UTC&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.18:00UTC&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.21:00UTC&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.yr.L3C.LST.multi-sensor.multi-platform.SSMI_SSMIS.v2-33.ASC&#x27;,
  &#x27;esa-cci&#x27;),
 (&#x27;esacci.LST.yr.L3C.LST.multi-sensor.multi-platform.SSMI_SSMIS.v2-33.DES&#x27;,
  &#x27;esa-cci&#x27;)]</span></code></div></div></div><div id="tv6bjaQj8z" class="relative group/block"><h4 id="zarr-kerchunk-netcdf-format" class="relative group"><span class="heading-text">zarr &amp; kerchunk &amp; NetCDF format</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#zarr-kerchunk-netcdf-format" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>For this workshop it might be a good idea to use LST data in zarr or kerchunk format, as data loading will be much faster.
Several CCI data records are available in these formats as they have some advantages.
Zarr is ideal for new datasets that will be frequently accessed, updated, or analyzed and it is suitable for large-scale distributed processing in cloud-native workflows.
Kerchunk is best for efficiently accessing legacy data formats (e.g., NetCDF, GRIB) stored in object stores without converting them and useful when data duplication must be avoided.
NetCDF, while widely used and highly compatible with scientific tools, is less optimized for cloud-native workflows and accessing large datasets efficiently, making it better suited for smaller-scale, traditional file-based analysis.</p><table class=""><tbody><tr class=""><th class=""><strong>Feature</strong></th><th class=""><strong>Zarr</strong></th><th class=""><strong>Kerchunk</strong></th><th class=""><strong>NetCDF</strong></th></tr><tr class=""><td class=""><strong>Storage Format</strong></td><td class="">Self-contained, new format</td><td class="">Wrapper for existing formats</td><td class="">Traditional file-based format</td></tr><tr class=""><td class=""><strong>Cloud-Native</strong></td><td class="">Yes</td><td class="">Yes</td><td class="">No</td></tr><tr class=""><td class=""><strong>Efficiency</strong></td><td class="">Good for accessing subsets</td><td class="">Great for legacy data in object stores</td><td class="">Efficient for small to medium files</td></tr><tr class=""><td class=""><strong>Compression</strong></td><td class="">Supports multiple algorithms</td><td class="">Depends on underlying format</td><td class="">Limited to format-specific methods</td></tr><tr class=""><td class=""><strong>Metadata Handling</strong></td><td class="">Embedded metadata</td><td class="">External JSON index</td><td class="">Embedded in file</td></tr><tr class=""><td class=""><strong>Read/Write Access</strong></td><td class="">Supports both</td><td class="">Read-only</td><td class="">Read and write</td></tr><tr class=""><td class=""><strong>Setup Overhead</strong></td><td class="">None, works out of the box</td><td class="">Requires pre-generated JSON indices</td><td class="">None, but slower for large datasets</td></tr><tr class=""><td class=""><strong>Storage Duplication</strong></td><td class="">Requires duplicating data</td><td class="">Minimal, uses existing files</td><td class="">Minimal, as data is stored in single files</td></tr><tr class=""><td class=""><strong>Performance</strong></td><td class="">Optimized for chunk-based access</td><td class="">Slight overhead for index lookup</td><td class="">Can be slow for very large files</td></tr></tbody></table></div><div id="HtYEusCSup" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">list_datasets(&quot;esa-cci-zarr&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="UbBjurhrmdIEP2l1syvHr" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div class="font-mono text-sm whitespace-pre-wrap"><code><span>[&#x27;ESACCI-BIOMASS-L4-AGB-MERGED-100m-2010-2018-fv2.0.zarr&#x27;,
 &#x27;ESACCI-BIOMASS-L4-AGB-MERGED-100m-2010-2020-fv4.0.zarr&#x27;,
 &#x27;ESACCI-GHG-L2-CH4-SCIAMACHY-WFMD-2002-2011-fv1.zarr&#x27;,
 &#x27;ESACCI-GHG-L2-CO2-OCO-2-FOCAL-2014-2021-v10.zarr&#x27;,
 &#x27;ESACCI-GHG-L2-CO2-SCIAMACHY-WFMD-2002-2012-fv1.zarr&#x27;,
 &#x27;ESACCI-ICESHEETS_Antarctica_GMB-2002-2016-v1.1.zarr&#x27;,
 &#x27;ESACCI-ICESHEETS_Greenland_GMB-2003-2016-v1.1.zarr&#x27;,
 &#x27;ESACCI-L3C_CLOUD-CLD_PRODUCTS-AVHRR_NOAA-1982-2016-fv3.0.zarr&#x27;,
 &#x27;ESACCI-L3C_SNOW-SWE-1979-2018-fv1.0.zarr&#x27;,
 &#x27;ESACCI-L3C_SNOW-SWE-1979-2020-fv2.0.zarr&#x27;,
 &#x27;ESACCI-L4_GHRSST-SST-GMPE-GLOB_CDR2.0-1981-2016-v02.0-fv01.0.zarr&#x27;,
 &#x27;ESACCI-LC-L4-LCCS-Map-300m-P1Y-1992-2015-v2.0.7b.zarr&#x27;,
 &#x27;ESACCI-LST-L3C-LST-MODISA-0.01deg_1DAILY_DAY-2002-2018-fv3.00.zarr&#x27;,
 &#x27;ESACCI-LST-L3C-LST-MODISA-0.01deg_1DAILY_NIGHT-2002-2018-fv3.00.zarr&#x27;,
 &#x27;ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1DAILY_DAY-1995-2020-fv3.00.zarr&#x27;,
 &#x27;ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1DAILY_NIGHT-1995-2020-fv3.00.zarr&#x27;,
 &#x27;ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_DAY-1995-2020-fv3.00.zarr&#x27;,
 &#x27;ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_NIGHT-1995-2020-fv3.00.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-IOP-MERGED-1M_MONTHLY_4km_GEO_PML_OCx_QAA-1997-2020-fv5.0.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-IOP-MERGED-1M_MONTHLY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-IOP-MERGED-1D_DAILY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-IOP-MERGED-1Y_YEARLY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-IOP-MERGED-5D_DAILY_4km_GEO_PML_OCx_QAA-2022-fv6.0.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-IOP-MERGED-8D_DAILY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-OC_PRODUCTS-MERGED-1D_DAILY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-OC_PRODUCTS-MERGED-1M_MONTHLY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-OC_PRODUCTS-MERGED-1Y_YEARLY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-OC_PRODUCTS-MERGED-5D_DAILY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-OC_PRODUCTS-MERGED-8D_DAILY_4km_GEO_PML_OCx_QAA-2022-fv6.0.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-RRS-MERGED-1M_MONTHLY_4km_GEO_PML_RRS-1997-2022-fv6.0.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-RRS-MERGED-1Y_YEARLY_4km_GEO_PML_RRS-1997-2022-fv6.0.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-RRS-MERGED-1D_DAILY_4km_GEO_PML_RRS-1997-2022-fv6.0.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-RRS-MERGED-5D_DAILY_4km_GEO_PML_RRS-1997-2022-fv6.0.zarr&#x27;,
 &#x27;ESACCI-OC-L3S-RRS-MERGED-8D_DAILY_4km_GEO_PML_RRS-1997-2022-fv6.0.zarr&#x27;,
 &#x27;ESACCI-PERMAFROST-L4-ALT-MODISLST-AREA4_PP-1997-2018-fv02.0.zarr&#x27;,
 &#x27;ESACCI-SEAICE-L3C-SITHICK-RA2_ENVISAT-NH25KMEASE2-2002-2012-fv2.0.zarr&#x27;,
 &#x27;ESACCI-SEAICE-L3C-SITHICK-SIRAL_CRYOSAT2-NH25KMEASE2-2010-2017-fv2.0.zarr&#x27;,
 &#x27;ESACCI-SEAICE-L4-SICONC-AMSR_50.0kmEASE2-NH-2002-2017-fv2.1.zarr&#x27;,
 &#x27;ESACCI-SEALEVEL-IND-MSLTR-MERGED-1993-2016-fv02.zarr&#x27;,
 &#x27;ESACCI-SEALEVEL-L4-MSLA-MERGED-1993-2015-fv02.zarr&#x27;,
 &#x27;ESACCI-SOILMOISTURE-L3S-SSMV-COMBINED-1978-2020-fv05.3.zarr&#x27;,
 &#x27;ESACCI-SOILMOISTURE-L3S-SSMV-COMBINED-1978-2021-fv07.1.zarr&#x27;]</span></code></div></div></div><div id="qNknuDyhV5" class="relative group/block"><h4 id="defining-the-region-of-interest-leicestershire" class="relative group"><span class="heading-text">Defining the Region of Interest (Leicestershire)</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#defining-the-region-of-interest-leicestershire" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>In this section, we define the bounding box for the Leicestershire region to extract a dataset sample covering both urban and non-urban areas. This will help to analyze temperature variations between these areas. In addition, the data size to download will be much smaller.</p></div><div id="JD4iJNpkRX" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Set bounding box for Leicestershire
lon_min, lon_max = -1.5, -0.5
lat_min, lat_max = 52.5, 53.5

bbox = (lon_min, lat_min, lon_max, lat_max)

# Display bounding box for reference
IPython.display.GeoJSON(shapely.geometry.box(*bbox).__geo_interface__)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Loc-Ih6Y7Qg47EvXgp2PE" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="UdnOVtS5fo" class="relative group/block"><h4 id="lst-data-basing-on-polar-orbiting-satellites" class="relative group"><span class="heading-text">LST data basing on polar-orbiting satellites</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#lst-data-basing-on-polar-orbiting-satellites" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>For this example, we will have a look at monthly LST for the years 2011 to 2020, which is available in the zarr data store:
‘ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_DAY-1995-2020-fv3.00.zarr’</p><p>This dataset provides monthly-averaged land surface temperatures (LSTs) and uncertainty estimates from multiple polar-orbiting satellites, spanning August 1995 to December 2020, with coverage on a 0.01° global grid. LSTs, derived from instruments such as ATSR-2, AATSR, MODIS Terra, and SLSTR, are adjusted for inter-instrument biases and provide separate daytime (used in this example) and nighttime temperatures along with observation geometry, land cover, and quality flags. Produced by the University of Leicester as part of the ESA Land Surface Temperature Climate Change Initiative, the dataset meets GCOS standards and supports studies of surface heat and water fluxes.</p></div><div id="txeVdGfwkV" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">cci_zarr_store = get_store(&quot;esa-cci-zarr&quot;)
lst_ds = cci_zarr_store.open_data(
    &#x27;ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_DAY-1995-2020-fv3.00.zarr&#x27;
)
lst_ds</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="JBIbX6J6z615YguF4atq9" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="q8FifqFiZ5" class="relative group/block"><p>Now get a spatial and temporal subset. This reduces the data size and speeds up calculations.</p></div><div id="IpoC1AKegn" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">subset_spatial_op = get_op(&#x27;subset_spatial&#x27;)
lst_ds_sub = subset_spatial_op(ds=lst_ds, region=bbox)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="pgCue7ynsQ3GxcYO15dB7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ocbuOsSqWQ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">subset_temporal_op = get_op(&#x27;subset_temporal&#x27;)
lst_ds_sub = subset_temporal_op(ds=lst_ds_sub, time_range=[&#x27;2011-01-01&#x27;, &#x27;2020-12-01&#x27;])
lst_ds_sub  # use this to have a quick look into the metadata</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="mKve7Am4Y9CA21Dc1EUco" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="VbH278cK33" class="relative group/block"><p>To get an impression of the mean LST in that region, we calculate the mean of the data and make a simple plot. The <code>climatology</code> operation of the CCI Toolbox creates a ‘mean over years’ dataset by averaging the values of the given input dataset over all years. The output is a climatological dataset with the same resolution as the input dataset, in this example a monthly climatology.</p></div><div id="u1odJ5dv0r" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">climatology_op = get_op(&#x27;climatology&#x27;)
lst_ds_clim = climatology_op(ds=lst_ds_sub)
# lst_ds_clim  # use this to have a quick look into the metadata

# The warning is informing you that the code is handling np.datetime64 objects without explicit timezone information. 
# This is typically not a problem for operations that do not require timezone awareness, such as climatology calculations, 
# but it might lead to unexpected behavior if timezone handling is critical for your workflow.</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="_TKNrBKtSx7EyGdnNbfRa" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>/cmsaf/cmsaf-ops3/stkothe/KE/ect/lib/python3.12/site-packages/esa_climate_toolbox/ops/aggregate.py:134: UserWarning: no explicit representation of timezones available for np.datetime64
  climatology_bounds = xr.DataArray(data=da.tile(np.array([time_min, time_max],
</span></code></pre></div></div></div><div id="FyWxKlBIcm" class="relative group/block"><h4 id="lets-plot-the-climatology-data" class="relative group"><span class="heading-text">Let’s plot the climatology data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#lets-plot-the-climatology-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><ol start="1"><li>Plotting LST Data: The code uses the plot_op operation to create a plot of mean Land Surface Temperature (LST) for a specific date (2011-06-01 represents the mean for June 2011 to 2020) from the dataset lst_ds_clim, applying a color map (‘viridis’) and adding a title for context.</li><li>Adding Geographical Markers: The plot highlights specific locations, Leicester and Nottingham, by overlaying markers (o) with dashed lines at their respective latitude and longitude coordinates.</li><li>Customizing the Plot: Legends are added to label the geographical markers, enhancing the plot’s interpretability for spatial analysis.</li></ol></div><div id="PEPR7dfQsO" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">plot_op = get_op(&#x27;plot&#x27;)
# Create a plot of the LST data
%matplotlib inline 

plot_op(
    ds=lst_ds_clim,  # Dataset variable
    var=&#x27;lst&#x27;,       # Variable you want to plot
    indexers={&#x27;time&#x27;: &#x27;2011-06-01&#x27;},  # Specify the date
    title=&quot;Mean Land Surface Temperature June 2011 to 2020&quot;,
    properties=&quot;cmap=&#x27;viridis&#x27;&quot;,  # Pass other properties here, such as color
)

# Add Leicester to the plot
leicester_lat, leicester_lon = 52.6369, -1.1398
plt.plot(leicester_lon, leicester_lat, linestyle=&#x27;--&#x27;, marker=&#x27;o&#x27;, color=&#x27;r&#x27;, label=&#x27;Leicester&#x27;)
plt.legend()

# Add Nottingham to the plot
nottingham_lat, nottingham_lon = 52.9536, -1.1569
plt.plot(nottingham_lon, nottingham_lat, linestyle=&#x27;--&#x27;, marker=&#x27;o&#x27;, color=&#x27;m&#x27;, label=&#x27;Nottingham&#x27;)
plt.legend()

</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="iB0agjR_qREN9f8SIIR1p" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/e5e912a619bb77692638eae242a92a87.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="H3R05lDd5G" class="relative group/block"><h2 id="id-2-analyze-urban-heat-islands" class="relative group"><span class="heading-text">2. Analyze urban heat islands</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-2-analyze-urban-heat-islands" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Urban areas often exhibit higher temperatures compared to their surrounding non-urban regions, a phenomenon known as the <strong>Urban Heat Island (UHI) effect</strong>. This section focuses on quantifying and visualizing this effect using Land Surface Temperature (LST) data from the ESA CCI dataset. By comparing LST values in urban and non-urban pixels, we can identify temperature differences and analyze their spatial patterns over time. This analysis is particularly relevant for understanding the impacts of urbanization on local climates and informing sustainable urban planning.</p></div><div id="vQXoL3JJKA" class="relative group/block"><h4 id="land-cover-lc-data" class="relative group"><span class="heading-text">Land Cover (LC) data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#land-cover-lc-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>For this step, we will use LC data for the same region. The ESA Land Cover CCI provides annual global land cover maps at 300m spatial resolution, covering the period from 1992 to 2015. Each pixel represents a land cover class based on the UN Land Cover Classification System (LCCS), accompanied by quality flags that document the classification reliability. These data offer a valuable resource for studying land cover dynamics and their role in climate systems.</p></div><div id="WZD61bj5ZL" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">lc_ds = cci_zarr_store.open_data(
    &#x27;ESACCI-LC-L4-LCCS-Map-300m-P1Y-1992-2015-v2.0.7b.zarr&#x27;
)
lc_ds</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="w6xE5zs0UMPlxqkiUSYQp" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="m0JIWDDQUp" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">lc_ds_sub = subset_temporal_op(ds=lc_ds, time_range=[&#x27;2015-07-03&#x27;, &#x27;2015-07-03&#x27;])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="vvLiw5k5sc3oViwRYbUYQ" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ZwFKozCLjv" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">select_var_op = get_op(&#x27;select_var&#x27;)
lc_ds_sub = select_var_op(ds=lc_ds_sub, var=&quot;lccs_class&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Q-Ki2MGEbsfZF9a6ocWSj" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="iGu665kgoE" class="relative group/block"><h4 id="downsample-lc-data-to-match-the-grid-resolution-of-lst-data" class="relative group"><span class="heading-text">Downsample LC data to match the grid resolution of LST data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#downsample-lc-data-to-match-the-grid-resolution-of-lst-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>This code snippet first normalizes the land cover dataset (<code>lc_ds_sub</code>) to standardize its values using the <code>normalize_op</code> operation. It then coregisters the normalized land cover dataset (<code>lc_ds_sub</code>) with the land surface temperature dataset (<code>lst_ds_sub</code>) using the <code>coregister_op</code> operation, aligning their spatial grids and downsampling the land cover data to match the LST grid using the “mode” method for categorical data.</p><p>Resampling categorical data presents a challenge because traditional statistical methods like averaging are not suitable. Instead, mode-based aggregation must be used to preserve the integrity of categorical classifications, ensuring that the dominant class in each new grid cell accurately reflects the underlying data.</p></div><div id="ItiuQgaQrn" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">normalize_op = get_op(&#x27;normalize&#x27;)

lc_ds_sub = normalize_op(ds=lc_ds_sub)

coregister_op = get_op(&#x27;coregister&#x27;)

downsampled_lc = coregister_op(
    ds_primary=lst_ds_sub,
    ds_replica=lc_ds_sub,
    method_ds=&quot;mode&quot;
)
downsampled_lc</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9w0_Sp9c0xtO8tXj6DZ8b" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="f8w8lXqeC2" class="relative group/block"><p>Plotting the resulting LC field. You can have a look into the metadata of the <code>lccs_class</code> variable to get the meaning of each land cover flag.</p></div><div id="on8ykXlZci" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Create a colormap for land cover categories (e.g., forest, urban, water)

plot_op(
    ds=downsampled_lc,           # Dataset variable (should be xarray.Dataset or DataArray)
    var=&#x27;lccs_class&#x27;,            # Variable name
    title=&quot;Downsampled Land Cover Map&quot;,
    properties=&quot;cmap=&#x27;tab20&#x27;&quot;    # Choose a colormap suitable for categorical data
)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="KiMb4SYV96zd3tDox40vq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/09551e3da80524b11a9cadcd5ee19863.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="qUzrelZihP" class="relative group/block"><h4 id="identify-urban-and-non-urban-grid-points" class="relative group"><span class="heading-text">Identify urban and non-urban grid points</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#identify-urban-and-non-urban-grid-points" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>Information on the flag for urban grid points is stored in the meta data for the variable lccs_class of the LC data. To check if the masks for urban and non-urban grid points look reasonable, we plot both fields.</p></div><div id="zCSkQToTD5" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Urban flag value based on the land cover data
urban_flag = 190

# Apply the threshold to create the urban mask
urban_mask = downsampled_lc[&#x27;lccs_class&#x27;] &gt;= urban_flag  # Boolean mask for urban points
urban_mask_da = urban_mask.astype(int).to_dataset(name=&quot;urban_mask&quot;)  # Convert to dataset with int values

# Plot the urban mask
plot_op(
    ds=urban_mask_da,          # Dataset variable
    var=&#x27;urban_mask&#x27;,          # Variable name
    title=&quot;Urban Mask&quot;,
    properties=&quot;cmap=&#x27;Greys&#x27;&quot;  # Use a greyscale colormap
)

# Apply the threshold to create the non-urban mask
non_urban_mask = ~urban_mask  # Invert the urban mask
non_urban_mask_da = non_urban_mask.astype(int).to_dataset(name=&quot;non_urban_mask&quot;)  # Convert to dataset with int values

# Plot the non-urban mask
plot_op(
    ds=non_urban_mask_da,      # Dataset variable
    var=&#x27;non_urban_mask&#x27;,      # Variable name
    title=&quot;Non-Urban Mask&quot;,
    properties=&quot;cmap=&#x27;Greys&#x27;&quot;  # Use a greyscale colormap
)
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="R5LC6xWJepNcKE1oaslRI" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/15457dddd978d2117e0bd3eeab188d30.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/><img src="/cci-notebook-viewers/build/20e6bc2ba0c6c4082d0f6c814573e9b7.png" alt="&lt;Figure size 640x480 with 2 Axes&gt;"/></div></div><div id="jCiMuuhNol" class="relative group/block"><p>Now we apply this mask to the data.</p></div><div id="D5R1dJ1ZAx" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Extract the LST variable as an xarray.DataArray
lst_data_array = lst_ds_clim[&#x27;lst&#x27;]  # Replace &#x27;lst&#x27; with the correct variable name

# Flip the urban_mask along the latitude axis
urban_mask_flipped = np.flipud(urban_mask)  # Flip along the vertical axis

# Apply the flipped mask to the LST data
urban_lst = xr.where(urban_mask_flipped, lst_data_array, np.nan)
non_urban_lst = xr.where(~urban_mask_flipped, lst_data_array, np.nan)

# Plot an example time step
time_step = lst_data_array.time[5]  # Choose the sixth time step for June
plt.figure(figsize=(12, 6))

# Plot Urban LST
plt.subplot(1, 2, 1)
urban_lst.sel(time=time_step).plot(cmap=&quot;viridis&quot;)
plt.title(f&quot;Urban LST at {time_step.values}&quot;)

# Plot Non-Urban LST
plt.subplot(1, 2, 2)
non_urban_lst.sel(time=time_step).plot(cmap=&quot;viridis&quot;)
plt.title(f&quot;Non-Urban LST at {time_step.values}&quot;)

plt.tight_layout()
plt.show()

</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="cZG7WBuyTDL-6rTNm8kqB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/ffba5f91ff88cfcff8afd34cb0c54e22.png" alt="&lt;Figure size 1200x600 with 4 Axes&gt;"/></div></div><div id="p34BXi09en" class="relative group/block"><h4 id="compare-urban-and-non-urban-grid-points" class="relative group"><span class="heading-text">Compare urban and non-urban grid points</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#compare-urban-and-non-urban-grid-points" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>When comparing urban and non-urban mean LST time series, keep in mind that the differing number of grid points can bias results. Urban areas often cover fewer, geographically clustered points, while non-urban areas span diverse climates, potentially skewing averages. Thus, we should consider including uncertainty bounds, noting the grid point counts, and normalizing results to improve comparability.</p></div><div id="Kt5EOykm5u" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Compute the mean LST for urban and non-urban pixels over time
urban_mean = urban_lst.mean(dim=[&quot;lat&quot;, &quot;lon&quot;])
non_urban_mean = non_urban_lst.mean(dim=[&quot;lat&quot;, &quot;lon&quot;])

# Plot the time series
plt.figure(figsize=(10, 6))
urban_mean.plot(label=&quot;Urban&quot;)
non_urban_mean.plot(label=&quot;Non-Urban&quot;)
plt.title(&quot;Mean LST Over Time&quot;)
plt.ylabel(&quot;LST (K)&quot;)
plt.xlabel(&quot;Time&quot;)
plt.legend()
plt.show()

# Compute the number of grid points explicitly
urban_count = urban_mask.sum().compute()  # Trigger computation for the Dask array
non_urban_count = non_urban_mask.sum().compute()

# Print the results
print(f&quot;Number of Urban Grid Points: {urban_count.values}&quot;)
print(f&quot;Number of Non-Urban Grid Points: {non_urban_count.values}&quot;)

normalized_urban_mean = urban_mean / urban_count
normalized_non_urban_mean = non_urban_mean / non_urban_count

# Plot the normalized time series
plt.figure(figsize=(10, 6))
normalized_urban_mean.plot(label=&quot;Urban normalized&quot;)
normalized_non_urban_mean.plot(label=&quot;Non-Urban normalized&quot;)
plt.title(&quot;Normalized LST Over Time&quot;)
plt.ylabel(&quot;normalized LST&quot;)
plt.xlabel(&quot;Time&quot;)
plt.legend()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="esA8G45x-NEInvWj1VgYB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/68a7fb4539b14dfbfb0334fe74002599.png" alt="&lt;Figure size 1000x600 with 1 Axes&gt;"/><div><pre class="text-sm font-thin font-system"><code><span>Number of Urban Grid Points: 1331
Number of Non-Urban Grid Points: 8769
</span></code></pre></div><img src="/cci-notebook-viewers/build/ed2f852dd5485ae8bd23b0aa883b678d.png" alt="&lt;Figure size 1000x600 with 1 Axes&gt;"/></div></div><div id="QdsfddPexb" class="relative group/block"><h2 id="id-3-explore-uncertainties" class="relative group"><span class="heading-text">3. Explore uncertainties</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-3-explore-uncertainties" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><h4 id="discussion-on-uncertainties-in-lst-data" class="relative group"><span class="heading-text">Discussion on Uncertainties in LST Data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#discussion-on-uncertainties-in-lst-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>Land Surface Temperature (LST) data from the ESA CCI include detailed uncertainty estimates to account for the challenges of measuring surface temperatures from space. These uncertainties arise from factors such as sensor differences, atmospheric corrections, and surface characteristics, all of which can impact data quality. In this section, we explore the different sources of uncertainty, visualize their spatial and temporal distributions, and discuss how they contribute to the total uncertainty provided with the LST products. Understanding these uncertainties is essential for interpreting the data and ensuring confidence in its applications.</p></div><div id="Nf71NDjgH2" class="relative group/block"><p>Let’s use as an example the LST data for one random year.</p></div><div id="Xc0cX8Uabl" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">lst_example = subset_temporal_op(ds=lst_ds_sub, time_range=[&#x27;2011-01-01&#x27;, &#x27;2011-12-01&#x27;])</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="H-Kg03Ns608XZP67nLrrg" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="nx5Qku9KBN" class="relative group/block"><h4 id="step-1-visualize-total-uncertainty" class="relative group"><span class="heading-text">Step 1: Visualize Total Uncertainty</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-1-visualize-total-uncertainty" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>The <strong>total uncertainty</strong> in the CCI LST data represents the overall error estimate associated with each LST measurement. It combines contributions from multiple sources of uncertainty, including:</p><ol start="1"><li><strong>Random Errors</strong>:<ul><li>Noise in the sensor measurements and other uncorrelated sources of error.</li></ul></li><li><strong>Locally Correlated Errors</strong>:<ul><li>Errors linked to specific spatial and temporal conditions, such as:<ul><li><strong>Atmospheric Scale Errors</strong>: Uncertainty from atmospheric corrections.</li><li><strong>Surface Scale Errors</strong>: Uncertainty due to surface emissivity and heterogeneity.</li><li><strong>LST Correction Errors</strong>: Errors introduced during LST algorithm corrections.</li></ul></li></ul></li><li><strong>Systematic Errors</strong>:<ul><li>Larger-scale, persistent biases across the dataset, such as calibration differences between sensors or long-term trends in instrument performance.</li></ul></li></ol><p>By aggregating these components, the total uncertainty provides a comprehensive error estimate for each pixel, helping users to assess the reliability of the data for their specific applications.</p></div><div id="OT3S37w5BN" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Extract the total uncertainty variable
total_uncertainty = lst_example[&#x27;lst_uncertainty&#x27;]  # That&#x27;s the total uncertainty

# Plot total uncertainty for a specific time step
time_step = total_uncertainty.time[5]  # Choose the sixth time step for June
plt.figure(figsize=(8, 6))
total_uncertainty.sel(time=time_step).plot(cmap=&quot;viridis&quot;)  # Xarray handles the colorbar
plt.title(f&quot;Total LST Uncertainty at {time_step.values}&quot;)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="eXwzSUT1Miffy5XzBKLJ7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/3ffcf309d9da9d6cfbae60e1f115501b.png" alt="&lt;Figure size 800x600 with 2 Axes&gt;"/></div></div><div id="btkhDsCgHt" class="relative group/block"><h4 id="step-2-compare-uncertainty-components" class="relative group"><span class="heading-text">Step 2: Compare Uncertainty Components</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-2-compare-uncertainty-components" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>To better understand the sources of uncertainty in the LST data, we visualize the spatial distribution of each component:</p><ul><li>Atmospheric Errors</li><li>LST Correction Errors</li><li>Surface Errors</li><li>Random Errors</li></ul></div><div id="X5cBYKlVIJ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Extract individual uncertainty components
unc_loc_atm = lst_example[&#x27;lst_unc_loc_atm&#x27;]
unc_loc_cor = lst_example[&#x27;lst_unc_loc_cor&#x27;]
unc_loc_sfc = lst_example[&#x27;lst_unc_loc_sfc&#x27;]
unc_ran = lst_example[&#x27;lst_unc_ran&#x27;]

# Plot individual components for a specific time step
fig, axs = plt.subplots(2, 2, figsize=(12, 10))
components = [unc_loc_atm, unc_loc_cor, unc_loc_sfc, unc_ran]
titles = [
    &quot;Atmospheric Uncertainty (loc_atm)&quot;,
    &quot;LST Corrections Uncertainty (loc_cor)&quot;,
    &quot;Surface Uncertainty (loc_sfc)&quot;,
    &quot;Random Uncertainty (ran)&quot;
]

for ax, comp, title in zip(axs.flat, components, titles):
    comp.sel(time=time_step).plot(ax=ax, cmap=&quot;coolwarm&quot;)
    ax.set_title(title)

plt.suptitle(f&quot;LST Uncertainty Components at {time_step.values}&quot;)
plt.tight_layout()
plt.show()
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="I93Hjr0ULGK2uusTbWYpV" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/d01cb4f18f7adb8c33048bb918e78251.png" alt="&lt;Figure size 1200x1000 with 8 Axes&gt;"/></div></div><div id="KyxAzuu1Kw" class="relative group/block"><h4 id="step-3-contribution-to-total-uncertainty" class="relative group"><span class="heading-text">Step 3: Contribution to Total Uncertainty</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-3-contribution-to-total-uncertainty" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>Let’s have a look at the contribution of each uncertainty component to the total uncertainty.</p></div><div id="SYfMb01TPl" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Compute mean uncertainty components over the region and time
mean_unc_loc_atm = unc_loc_atm.mean(dim=[&quot;lat&quot;, &quot;lon&quot;]).sel(time=time_step)
mean_unc_loc_cor = unc_loc_cor.mean(dim=[&quot;lat&quot;, &quot;lon&quot;]).sel(time=time_step)
mean_unc_loc_sfc = unc_loc_sfc.mean(dim=[&quot;lat&quot;, &quot;lon&quot;]).sel(time=time_step)
mean_unc_ran = unc_ran.mean(dim=[&quot;lat&quot;, &quot;lon&quot;]).sel(time=time_step)
mean_total_unc = total_uncertainty.mean(dim=[&quot;lat&quot;, &quot;lon&quot;]).sel(time=time_step)

# Plot the contributions
contributions = [
    mean_unc_loc_atm, mean_unc_loc_cor, mean_unc_loc_sfc, mean_unc_ran
]
labels = [&quot;Loc Atm&quot;, &quot;Loc Cor&quot;, &quot;Loc Sfc&quot;, &quot;Random&quot;]

plt.figure(figsize=(8, 6))
some_colors = [&quot;#2a9d8f&quot;, &quot;#264653&quot;, &quot;#e9c46a&quot;, &quot;#e76f51&quot;]
plt.bar(labels, [c.values for c in contributions], color=some_colors)
plt.axhline(y=mean_total_unc.values, color=&quot;black&quot;, linestyle=&quot;--&quot;, label=&quot;Total&quot;)
plt.title(f&quot;Contribution of Uncertainty Components at {time_step.values}&quot;)
plt.ylabel(&quot;Mean Uncertainty (K)&quot;)
plt.legend()
plt.show()
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="3jsOspIt1ySyyLF53wcAy" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/ee392246d4d461c0fa56a88e41778487.png" alt="&lt;Figure size 800x600 with 1 Axes&gt;"/></div></div><div id="GbeVTsXoB4" class="relative group/block"><p>Random errors contribute the most to the total uncertainty in LST data because they arise from sensor noise, atmospheric variability, and surface heterogeneity, which are inherently unpredictable and uncorrelated across space and time. These errors are amplified in challenging conditions, such as areas with variable cloud cover, complex terrain, or mixed land cover types, where accurate retrieval of surface temperatures becomes more difficult. Additionally, the high-resolution nature of the data means more detailed measurements, which can increase the influence of random fluctuations compared to systematic or locally correlated errors.</p></div><div id="Z4OH0N8dXT" class="relative group/block"><h4 id="step-4-temporal-trends-in-uncertainties" class="relative group"><span class="heading-text">Step 4: Temporal Trends in Uncertainties</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-4-temporal-trends-in-uncertainties" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>Here, we aim to identify how different sources of uncertainty in LST data vary over time. By examining temporal patterns, we hope to:</p><ul><li>Detect seasonal trends, such as higher uncertainties during periods of increased cloud cover or surface variability.</li><li>Assess whether uncertainties remain stable over the dataset’s time span or change due to factors like sensor transitions or calibration updates.</li><li>Understand how each component contributes to the total uncertainty across different periods, which can provide insights into the consistency and reliability of the LST dataset for long-term climate studies.</li></ul></div><div id="ck5RtIzgDH" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Compute mean uncertainty components over time
mean_unc_loc_atm_time = unc_loc_atm.mean(dim=[&quot;lat&quot;, &quot;lon&quot;]).dropna(dim=&quot;time&quot;)
mean_unc_loc_cor_time = unc_loc_cor.mean(dim=[&quot;lat&quot;, &quot;lon&quot;]).dropna(dim=&quot;time&quot;)
mean_unc_loc_sfc_time = unc_loc_sfc.mean(dim=[&quot;lat&quot;, &quot;lon&quot;]).dropna(dim=&quot;time&quot;)
mean_unc_ran_time = unc_ran.mean(dim=[&quot;lat&quot;, &quot;lon&quot;]).dropna(dim=&quot;time&quot;)
mean_total_unc_time = total_uncertainty.mean(dim=[&quot;lat&quot;, &quot;lon&quot;]).dropna(dim=&quot;time&quot;)

# Plot the time series
plt.figure(figsize=(10, 6))
mean_unc_loc_atm_time.plot(label=&quot;Loc Atm&quot;)
mean_unc_loc_cor_time.plot(label=&quot;Loc Cor&quot;)
mean_unc_loc_sfc_time.plot(label=&quot;Loc Sfc&quot;)
mean_unc_ran_time.plot(label=&quot;Random&quot;)
mean_total_unc_time.plot(label=&quot;Total&quot;, linestyle=&quot;--&quot;, color=&quot;black&quot;)
plt.title(&quot;Temporal Variation of LST Uncertainty Components&quot;)
plt.ylabel(&quot;Mean Uncertainty (K)&quot;)
plt.xlabel(&quot;Time&quot;)
plt.legend()
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7GLzuQSqeYtutUOXK2wVm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><img src="/cci-notebook-viewers/build/c83c7fe65920bed825c4b1550bff1689.png" alt="&lt;Figure size 1000x600 with 1 Axes&gt;"/></div></div><div></div></article></main><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/cci-notebook-viewers/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-XWET6RJ7.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/root-ZJOPFBMV.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/_shared/chunk-NFM2H3KQ.js"/><link rel="modulepreload" href="/cci-notebook-viewers/build/routes/$-CQPS5IOR.js"/><script>window.__remixContext = {"url":"/external-notebooks/esa-cci/ect-training/lst-leicester-12-2024/lst-training","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.0","options":{"hide_toc":true,"hide_footer_links":true,"folders":true},"nav":[],"actions":[],"projects":[{"subject":"CCI Examples","title":"CCI Examples","description":"Collection of examples relevant to the CCI activity","github":"https://github.com/esa-cci/cci-notebook-viewers","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Esa Cci","level":2},{"title":"Cci Notebooks","level":3},{"slug":"external-notebooks.esa-cci.cci-notebooks.readme","title":"cci-notebooks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebooks","level":4},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.aerosol-cci","title":"Getting Started with Aerosol CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.biomass-cci","title":"Getting Started with Biomass CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.cloud-cci","title":"Getting Started with Cloud CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.fire-cci","title":"Getting Started with Fire CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ghg-cci","title":"Getting Started with Greenhouse Gases CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.icesheets-cci","title":"Getting Started with Ice Sheets CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lakes-cci","title":"Getting Started with Lakes CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.landcover-cci","title":"Getting Started with Land Cover CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lst-cci","title":"Getting Started with Land Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.oceancolour-cci","title":"Getting Started with Ocean Colour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ozone-cci","title":"Getting Started with Ozone CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.permafrost-cci","title":"Getting Started with Permafrost CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.seaice-cci","title":"Getting Started with Sea Ice CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sealevel-cci","title":"Getting Started with Sea Level CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.snow-cci","title":"Getting Started with Snow CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.soilmoisture-cci","title":"Getting Started with Soil Moisture CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sss-cci","title":"Getting Started with Sea Surface Salinity CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sst-cci","title":"Getting Started with Sea Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.vegetation-cci","title":"Getting Started with Vegetation CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.watervapour-cci","title":"Getting Started with Water Vapour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Ect Training","level":3},{"slug":"external-notebooks.esa-cci.ect-training.readme","title":"ect-training","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"ESA Climate Change Competition","level":4},{"slug":"external-notebooks.esa-cci.ect-training.esa-climate-change-competition.competition-forests-in-a-changing-climate","title":"Explore forests in a changing climate with the ESA CCI datasets","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lps Vienna 06 2025","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-beginner","title":"Step 1. Setup \u0026 Imports","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-cloud-uncertainties","title":"1. Import Necessary Packages","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-intermediate-level-elnino","title":"Questions We Aim to Explore","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lst Leicester 12 2024","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lst-leicester-12-2024.lst-training","title":"Analyzing Land Surface Temperature and Uncertainties: Insights from ESA CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/cci-notebook-viewers"},"routes/$":{"config":{"version":2,"myst":"1.6.0","options":{"hide_toc":true,"hide_footer_links":true,"folders":true},"nav":[],"actions":[],"projects":[{"subject":"CCI Examples","title":"CCI Examples","description":"Collection of examples relevant to the CCI activity","github":"https://github.com/esa-cci/cci-notebook-viewers","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Esa Cci","level":2},{"title":"Cci Notebooks","level":3},{"slug":"external-notebooks.esa-cci.cci-notebooks.readme","title":"cci-notebooks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebooks","level":4},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.aerosol-cci","title":"Getting Started with Aerosol CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.biomass-cci","title":"Getting Started with Biomass CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.cloud-cci","title":"Getting Started with Cloud CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.fire-cci","title":"Getting Started with Fire CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ghg-cci","title":"Getting Started with Greenhouse Gases CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.icesheets-cci","title":"Getting Started with Ice Sheets CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lakes-cci","title":"Getting Started with Lakes CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.landcover-cci","title":"Getting Started with Land Cover CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lst-cci","title":"Getting Started with Land Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.oceancolour-cci","title":"Getting Started with Ocean Colour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ozone-cci","title":"Getting Started with Ozone CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.permafrost-cci","title":"Getting Started with Permafrost CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.seaice-cci","title":"Getting Started with Sea Ice CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sealevel-cci","title":"Getting Started with Sea Level CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.snow-cci","title":"Getting Started with Snow CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.soilmoisture-cci","title":"Getting Started with Soil Moisture CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sss-cci","title":"Getting Started with Sea Surface Salinity CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sst-cci","title":"Getting Started with Sea Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.vegetation-cci","title":"Getting Started with Vegetation CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.watervapour-cci","title":"Getting Started with Water Vapour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Ect Training","level":3},{"slug":"external-notebooks.esa-cci.ect-training.readme","title":"ect-training","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"ESA Climate Change Competition","level":4},{"slug":"external-notebooks.esa-cci.ect-training.esa-climate-change-competition.competition-forests-in-a-changing-climate","title":"Explore forests in a changing climate with the ESA CCI datasets","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lps Vienna 06 2025","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-beginner","title":"Step 1. Setup \u0026 Imports","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-cloud-uncertainties","title":"1. Import Necessary Packages","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-intermediate-level-elnino","title":"Questions We Aim to Explore","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lst Leicester 12 2024","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lst-leicester-12-2024.lst-training","title":"Analyzing Land Surface Temperature and Uncertainties: Insights from ESA CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5}]}]},"page":{"version":2,"kind":"Notebook","sha256":"9af252881d345be48813bc2170b868ba66524c93aa4ff6a8ec8428364023f2c2","slug":"external-notebooks.esa-cci.ect-training.lst-leicester-12-2024.lst-training","location":"/external_notebooks/esa-cci/ect-training/lst_leicester_12_2024/LST_Training.ipynb","dependencies":[],"frontmatter":{"title":"Analyzing Land Surface Temperature and Uncertainties: Insights from ESA CCI Data","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"github":"https://github.com/esa-cci/cci-notebook-viewers","subject":"CCI Examples","numbering":{"title":{"offset":4}},"edit_url":"https://github.com/esa-cci/cci-notebook-viewers/blob/main/external_notebooks/esa-cci/ect-training/lst_leicester_12_2024/LST_Training.ipynb","exports":[{"format":"ipynb","filename":"LST_Training.ipynb","url":"/cci-notebook-viewers/build/LST_Training-1ebcc471e595c45991413437b7820d4a.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This notebook guides you through analyzing Land Surface Temperature (LST) data from the ESA Climate Change Initiative (CCI) to study urban heat islands, focusing on the Leicestershire region. We’ll use LST data alongside land cover information to identify temperature differences between urban and non-urban areas. Additionally, we’ll discuss uncertainties associated with LST data products.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UXP5GSFYMD"}],"key":"xuEsUcz6sD"}],"key":"JxRDgNsDQ9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Objectives","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RVxm4mOnVd"}],"identifier":"objectives","label":"Objectives","html_id":"objectives","implicit":true,"key":"NLvbCcCSdN"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Access and visualize LST data for Leicestershire using the ESA CCI toolbox.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"odhcLsll9X"}],"key":"ci8iAAjt1T"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Analyze urban heat islands in Leicestershire by comparing urban and non-urban areas.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yrN6dPhBM4"}],"key":"qPFlsuWgLw"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Explore uncertainties in LST data and interpret quality flags.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"YocEVumCYH"}],"key":"RlJDSYWhES"}],"key":"J2mPq5Ne58"}],"key":"GHFjwAm14E"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Add imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fNnxvNarp5"}],"identifier":"add-imports","label":"Add imports","html_id":"add-imports","implicit":true,"key":"j0JjALFvVq"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"To run this Notebook, make sure the ESA CCI Toolbox is setup correctly.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Qudf6J8pNl"}],"key":"TxOsOGeWHa"}],"key":"zYbdzlCn9F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from xcube.core.store import new_data_store\nimport IPython.display\nimport shapely.geometry\nimport matplotlib.pyplot as plt\nfrom esa_climate_toolbox.core import get_store\nfrom esa_climate_toolbox.core import get_op\nfrom esa_climate_toolbox.core import list_ecv_datasets\nfrom esa_climate_toolbox.core import list_datasets\nfrom esa_climate_toolbox.ops import downsample_2d\nfrom esa_climate_toolbox.ops import coregister\nimport matplotlib\nimport numpy as np\nimport xarray as xr","key":"VShiucZZFN"},{"type":"output","id":"FYIWF6AVM_I00BaGeTH83","data":[],"key":"EzNivQsEYx"}],"key":"DsGARfEBJL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1. Access and visualize LST data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CZ56ssaQjY"}],"identifier":"id-1-access-and-visualize-lst-data","label":"1. Access and visualize LST data","html_id":"id-1-access-and-visualize-lst-data","implicit":true,"key":"QTRnEQ2UDr"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In this section, we explore how to access Land Surface Temperature (LST) data from the ESA Climate Change Initiative (CCI) data store. This includes identifying datasets of interest, understanding their metadata, and preparing for subsequent analysis.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"tH4wwF5W6z"}],"key":"yoYfczsz7A"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The ESA CCI provides high-quality, harmonized climate data records that are essential for monitoring and understanding climate variability and trends. These datasets are generated using consistent algorithms across space and time, ensuring their reliability for climate research and applications.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"lMyeI5AsDA"}],"key":"CW5TnWxq5z"}],"key":"ZX0BNSgF1R"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Filter and Select LST Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BJ7HwF3F7g"}],"identifier":"filter-and-select-lst-data","label":"Filter and Select LST Data","html_id":"filter-and-select-lst-data","implicit":true,"key":"f2NdZFPtfz"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Identify LST datasets based on spatial and temporal requirements. The ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FdqspOhl0h"},{"type":"inlineCode","value":"list_ecv_datasets","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Qon0GLo3Lm"},{"type":"text","value":" command returns the names of datasets for a given essential climate variable.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Kq1ZJfyPuy"}],"key":"obJY5EucYV"}],"key":"XwoCGJT304"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"list_ecv_datasets(\"LST\")","key":"eLUapx2rLS"},{"type":"output","id":"-GbdQKrcIRW_ybri91wbi","data":[{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/plain":{"content":"[('esacci.LST.3-hours.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.r1',\n  'esa-cci'),\n ('esacci.LST.day.L3C.LST.AATSR.Envisat.ATSR_3.3-00.DAY', 'esa-cci'),\n ('esacci.LST.day.L3C.LST.AATSR.Envisat.ATSR_3.3-00.NIGHT', 'esa-cci'),\n ('esacci.LST.day.L3C.LST.ATSR-2.ERS-2.ATSR_2.3-00.DAY', 'esa-cci'),\n ('esacci.LST.day.L3C.LST.ATSR-2.ERS-2.ATSR_2.3-00.NIGHT', 'esa-cci'),\n ('esacci.LST.day.L3C.LST.MODIS.Aqua.MODISA.3-00.DAY', 'esa-cci'),\n ('esacci.LST.day.L3C.LST.MODIS.Aqua.MODISA.3-00.NIGHT', 'esa-cci'),\n ('esacci.LST.day.L3C.LST.MODIS.Terra.MODIST.3-00.DAY', 'esa-cci'),\n ('esacci.LST.day.L3C.LST.MODIS.Terra.MODIST.3-00.NIGHT', 'esa-cci'),\n ('esacci.LST.day.L3C.LST.SLSTR.Sentinel-3A.SLSTRA.3-00.DAY', 'esa-cci'),\n ('esacci.LST.day.L3C.LST.SLSTR.Sentinel-3A.SLSTRA.3-00.NIGHT', 'esa-cci'),\n ('esacci.LST.day.L3C.LST.SLSTR.Sentinel-3B.SLSTRB.3-00.DAY', 'esa-cci'),\n ('esacci.LST.day.L3C.LST.SLSTR.Sentinel-3B.SLSTRB.3-00.NIGHT', 'esa-cci'),\n ('esacci.LST.day.L3C.LST.multi-sensor.multi-platform.SSMI_SSMIS.v2-33.ASC',\n  'esa-cci'),\n ('esacci.LST.day.L3C.LST.multi-sensor.multi-platform.SSMI_SSMIS.v2-33.DES',\n  'esa-cci'),\n ('esacci.LST.day.L3S.LST.multi-sensor.multi-platform.IRCDR.2-00.DAY',\n  'esa-cci'),\n ('esacci.LST.day.L3S.LST.multi-sensor.multi-platform.IRCDR.2-00.NIGHT',\n  'esa-cci'),\n ('esacci.LST.mon.L3C.LST.AATSR.Envisat.ATSR_3.3-00.DAY', 'esa-cci'),\n ('esacci.LST.mon.L3C.LST.AATSR.Envisat.ATSR_3.3-00.NIGHT', 'esa-cci'),\n ('esacci.LST.mon.L3C.LST.ATSR-2.ERS-2.ATSR_2.3-00.DAY', 'esa-cci'),\n ('esacci.LST.mon.L3C.LST.ATSR-2.ERS-2.ATSR_2.3-00.NIGHT', 'esa-cci'),\n ('esacci.LST.mon.L3C.LST.MODIS.Aqua.MODISA.3-00.DAY', 'esa-cci'),\n ('esacci.LST.mon.L3C.LST.MODIS.Aqua.MODISA.3-00.NIGHT', 'esa-cci'),\n ('esacci.LST.mon.L3C.LST.MODIS.Terra.MODIST.3-00.DAY', 'esa-cci'),\n ('esacci.LST.mon.L3C.LST.MODIS.Terra.MODIST.3-00.NIGHT', 'esa-cci'),\n ('esacci.LST.mon.L3C.LST.SLSTR.Sentinel-3A.SLSTRA.3-00.DAY', 'esa-cci'),\n ('esacci.LST.mon.L3C.LST.SLSTR.Sentinel-3A.SLSTRA.3-00.NIGHT', 'esa-cci'),\n ('esacci.LST.mon.L3C.LST.SLSTR.Sentinel-3B.SLSTRB.3-00.DAY', 'esa-cci'),\n ('esacci.LST.mon.L3C.LST.SLSTR.Sentinel-3B.SLSTRB.3-00.NIGHT', 'esa-cci'),\n ('esacci.LST.mon.L3C.LST.multi-sensor.multi-platform.SSMI_SSMIS.v2-33.ASC',\n  'esa-cci'),\n ('esacci.LST.mon.L3C.LST.multi-sensor.multi-platform.SSMI_SSMIS.v2-33.DES',\n  'esa-cci'),\n ('esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRCDR.2-00.DAY',\n  'esa-cci'),\n ('esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRCDR.2-00.NIGHT',\n  'esa-cci'),\n ('esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.00:00UTC',\n  'esa-cci'),\n ('esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.03:00UTC',\n  'esa-cci'),\n ('esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.06:00UTC',\n  'esa-cci'),\n ('esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.09:00UTC',\n  'esa-cci'),\n ('esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.12:00UTC',\n  'esa-cci'),\n ('esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.15:00UTC',\n  'esa-cci'),\n ('esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.18:00UTC',\n  'esa-cci'),\n ('esacci.LST.mon.L3S.LST.multi-sensor.multi-platform.IRMGP.1-00.21:00UTC',\n  'esa-cci'),\n ('esacci.LST.yr.L3C.LST.multi-sensor.multi-platform.SSMI_SSMIS.v2-33.ASC',\n  'esa-cci'),\n ('esacci.LST.yr.L3C.LST.multi-sensor.multi-platform.SSMI_SSMIS.v2-33.DES',\n  'esa-cci')]","content_type":"text/plain"}}}],"key":"IMRfG7E387"}],"key":"orCaKzCTcV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"zarr \u0026 kerchunk \u0026 NetCDF format","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wrv81Tgu57"}],"identifier":"zarr-kerchunk-netcdf-format","label":"zarr \u0026 kerchunk \u0026 NetCDF format","html_id":"zarr-kerchunk-netcdf-format","implicit":true,"key":"mPI1ldoF9I"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"For this workshop it might be a good idea to use LST data in zarr or kerchunk format, as data loading will be much faster.\nSeveral CCI data records are available in these formats as they have some advantages.\nZarr is ideal for new datasets that will be frequently accessed, updated, or analyzed and it is suitable for large-scale distributed processing in cloud-native workflows.\nKerchunk is best for efficiently accessing legacy data formats (e.g., NetCDF, GRIB) stored in object stores without converting them and useful when data duplication must be avoided.\nNetCDF, while widely used and highly compatible with scientific tools, is less optimized for cloud-native workflows and accessing large datasets efficiently, making it better suited for smaller-scale, traditional file-based analysis.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"CQ8yKomGdm"}],"key":"QleG6cQytW"},{"type":"table","position":{"start":{"line":8,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Feature","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"TAbsSGeGpl"}],"key":"hX9o7TgTYL"}],"key":"IR7z33JDwy"},{"type":"tableCell","header":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Zarr","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Wh9RoYOVCs"}],"key":"gnnX4x2N9p"}],"key":"YFt8bDXySF"},{"type":"tableCell","header":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Kerchunk","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"mo8uZeQmUt"}],"key":"nNoGV8W9fh"}],"key":"hdDMngn43A"},{"type":"tableCell","header":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"NetCDF","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"cKxMsFTnMA"}],"key":"IB2QyQnqjH"}],"key":"AjHuUBHTle"}],"key":"qWXLfO2UaR"},{"type":"tableRow","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Storage Format","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"hqov0AsKIO"}],"key":"XVaZxgpqyE"}],"key":"FWO0uLDLWz"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Self-contained, new format","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"RLWAV8gSQ3"}],"key":"qfDIvOUmmU"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Wrapper for existing formats","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"h0cQZiQSx4"}],"key":"xXbtHlmAHD"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Traditional file-based format","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Cpw4YM2DPC"}],"key":"o12hgvkz4F"}],"key":"bTlbyEV8ag"},{"type":"tableRow","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Cloud-Native","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"NXOuvI9FfS"}],"key":"Wfc41twWYY"}],"key":"vLxDHhJeIg"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Yes","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ZJqppefMWy"}],"key":"g768aZrzw8"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Yes","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"oJtzh8ThWF"}],"key":"UstzBgNMtO"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"No","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"sctlO6RPQ9"}],"key":"WlOF7MECn4"}],"key":"rNypj4JxCd"},{"type":"tableRow","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Efficiency","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"saXW9gsUrn"}],"key":"SZ69bgexrP"}],"key":"QmiiU7DWHD"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Good for accessing subsets","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"UDzbHiiO7O"}],"key":"R5FzExpijO"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Great for legacy data in object stores","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Vg2pLBW1GP"}],"key":"x3nJYpkJsZ"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Efficient for small to medium files","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"SAF1x8XeBM"}],"key":"pqcseMPrFp"}],"key":"Ugvo8ozMtN"},{"type":"tableRow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Compression","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"dLnGo5Y6YH"}],"key":"lgNT6IdIxE"}],"key":"TMHYsttnXh"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Supports multiple algorithms","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"kGB1Cphyp3"}],"key":"y8Lb3QSuXQ"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Depends on underlying format","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"nGqVvXnqiP"}],"key":"V3ocTD1vu4"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Limited to format-specific methods","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"W4JzTRV8X5"}],"key":"lwc0eywOQQ"}],"key":"iKKPGkrufY"},{"type":"tableRow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Metadata Handling","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Lu50HGxDVj"}],"key":"AEW8lNPYix"}],"key":"m5PM2ulUGM"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Embedded metadata","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"SI0HTg3mJi"}],"key":"okkRQ6GigR"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"External JSON index","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Qku62ZHoKA"}],"key":"TieQ5Ohrf8"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Embedded in file","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"WwgN6uZxLG"}],"key":"R0J6hynnXn"}],"key":"MvUJ3CcaoK"},{"type":"tableRow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Read/Write Access","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"AMaQIcTZ7x"}],"key":"gji3aFXh8D"}],"key":"vL31DqDKCG"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Supports both","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"txnaspOUYb"}],"key":"cjfTFFa9s6"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Read-only","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ewGZM9kakw"}],"key":"JZ7ylGrT07"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Read and write","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"wzuHLCchgn"}],"key":"uojVb0ww3x"}],"key":"EsHuWYpftJ"},{"type":"tableRow","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Setup Overhead","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"encmubSKSF"}],"key":"Gweja0BpTq"}],"key":"VkP6oiCS3D"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"None, works out of the box","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"guOqMry3W0"}],"key":"YkNuxyBSo7"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Requires pre-generated JSON indices","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"M9gD7Z2wtq"}],"key":"ao1jXDzCUm"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"None, but slower for large datasets","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"G0OU4xoUbR"}],"key":"WUz5HHUBQb"}],"key":"fj6OF7Ql0y"},{"type":"tableRow","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Storage Duplication","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Fflx1IHF4G"}],"key":"wp1HKz89ZL"}],"key":"exNN5Cc144"},{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Requires duplicating data","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"uaf6JdF7SQ"}],"key":"Idl3KFBjrX"},{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Minimal, uses existing files","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"IHjcXelMRl"}],"key":"iSn6kpp36i"},{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Minimal, as data is stored in single files","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Ry5GbkDe8z"}],"key":"hxPLGArAzr"}],"key":"wDY7a0yrsL"},{"type":"tableRow","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Performance","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"pqJY7f5eXO"}],"key":"lacwuS6lvw"}],"key":"QeF09snQbC"},{"type":"tableCell","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Optimized for chunk-based access","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"zPDsO8LAsb"}],"key":"uhqmeWGU6a"},{"type":"tableCell","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Slight overhead for index lookup","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"QBADHh5G5j"}],"key":"JuZNEBu2IO"},{"type":"tableCell","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Can be slow for very large files","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"S9YCV6Z6MP"}],"key":"bDfHONx9yv"}],"key":"hd1lNb82xx"}],"key":"ahkJ44qBD1"}],"key":"tv6bjaQj8z"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"list_datasets(\"esa-cci-zarr\")","key":"Nhel1t2Uvf"},{"type":"output","id":"UbBjurhrmdIEP2l1syvHr","data":[{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/plain":{"content":"['ESACCI-BIOMASS-L4-AGB-MERGED-100m-2010-2018-fv2.0.zarr',\n 'ESACCI-BIOMASS-L4-AGB-MERGED-100m-2010-2020-fv4.0.zarr',\n 'ESACCI-GHG-L2-CH4-SCIAMACHY-WFMD-2002-2011-fv1.zarr',\n 'ESACCI-GHG-L2-CO2-OCO-2-FOCAL-2014-2021-v10.zarr',\n 'ESACCI-GHG-L2-CO2-SCIAMACHY-WFMD-2002-2012-fv1.zarr',\n 'ESACCI-ICESHEETS_Antarctica_GMB-2002-2016-v1.1.zarr',\n 'ESACCI-ICESHEETS_Greenland_GMB-2003-2016-v1.1.zarr',\n 'ESACCI-L3C_CLOUD-CLD_PRODUCTS-AVHRR_NOAA-1982-2016-fv3.0.zarr',\n 'ESACCI-L3C_SNOW-SWE-1979-2018-fv1.0.zarr',\n 'ESACCI-L3C_SNOW-SWE-1979-2020-fv2.0.zarr',\n 'ESACCI-L4_GHRSST-SST-GMPE-GLOB_CDR2.0-1981-2016-v02.0-fv01.0.zarr',\n 'ESACCI-LC-L4-LCCS-Map-300m-P1Y-1992-2015-v2.0.7b.zarr',\n 'ESACCI-LST-L3C-LST-MODISA-0.01deg_1DAILY_DAY-2002-2018-fv3.00.zarr',\n 'ESACCI-LST-L3C-LST-MODISA-0.01deg_1DAILY_NIGHT-2002-2018-fv3.00.zarr',\n 'ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1DAILY_DAY-1995-2020-fv3.00.zarr',\n 'ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1DAILY_NIGHT-1995-2020-fv3.00.zarr',\n 'ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_DAY-1995-2020-fv3.00.zarr',\n 'ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_NIGHT-1995-2020-fv3.00.zarr',\n 'ESACCI-OC-L3S-IOP-MERGED-1M_MONTHLY_4km_GEO_PML_OCx_QAA-1997-2020-fv5.0.zarr',\n 'ESACCI-OC-L3S-IOP-MERGED-1M_MONTHLY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr',\n 'ESACCI-OC-L3S-IOP-MERGED-1D_DAILY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr',\n 'ESACCI-OC-L3S-IOP-MERGED-1Y_YEARLY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr',\n 'ESACCI-OC-L3S-IOP-MERGED-5D_DAILY_4km_GEO_PML_OCx_QAA-2022-fv6.0.zarr',\n 'ESACCI-OC-L3S-IOP-MERGED-8D_DAILY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr',\n 'ESACCI-OC-L3S-OC_PRODUCTS-MERGED-1D_DAILY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr',\n 'ESACCI-OC-L3S-OC_PRODUCTS-MERGED-1M_MONTHLY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr',\n 'ESACCI-OC-L3S-OC_PRODUCTS-MERGED-1Y_YEARLY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr',\n 'ESACCI-OC-L3S-OC_PRODUCTS-MERGED-5D_DAILY_4km_GEO_PML_OCx_QAA-1997-2022-fv6.0.zarr',\n 'ESACCI-OC-L3S-OC_PRODUCTS-MERGED-8D_DAILY_4km_GEO_PML_OCx_QAA-2022-fv6.0.zarr',\n 'ESACCI-OC-L3S-RRS-MERGED-1M_MONTHLY_4km_GEO_PML_RRS-1997-2022-fv6.0.zarr',\n 'ESACCI-OC-L3S-RRS-MERGED-1Y_YEARLY_4km_GEO_PML_RRS-1997-2022-fv6.0.zarr',\n 'ESACCI-OC-L3S-RRS-MERGED-1D_DAILY_4km_GEO_PML_RRS-1997-2022-fv6.0.zarr',\n 'ESACCI-OC-L3S-RRS-MERGED-5D_DAILY_4km_GEO_PML_RRS-1997-2022-fv6.0.zarr',\n 'ESACCI-OC-L3S-RRS-MERGED-8D_DAILY_4km_GEO_PML_RRS-1997-2022-fv6.0.zarr',\n 'ESACCI-PERMAFROST-L4-ALT-MODISLST-AREA4_PP-1997-2018-fv02.0.zarr',\n 'ESACCI-SEAICE-L3C-SITHICK-RA2_ENVISAT-NH25KMEASE2-2002-2012-fv2.0.zarr',\n 'ESACCI-SEAICE-L3C-SITHICK-SIRAL_CRYOSAT2-NH25KMEASE2-2010-2017-fv2.0.zarr',\n 'ESACCI-SEAICE-L4-SICONC-AMSR_50.0kmEASE2-NH-2002-2017-fv2.1.zarr',\n 'ESACCI-SEALEVEL-IND-MSLTR-MERGED-1993-2016-fv02.zarr',\n 'ESACCI-SEALEVEL-L4-MSLA-MERGED-1993-2015-fv02.zarr',\n 'ESACCI-SOILMOISTURE-L3S-SSMV-COMBINED-1978-2020-fv05.3.zarr',\n 'ESACCI-SOILMOISTURE-L3S-SSMV-COMBINED-1978-2021-fv07.1.zarr']","content_type":"text/plain"}}}],"key":"xb6cXtK8OL"}],"key":"HtYEusCSup"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Defining the Region of Interest (Leicestershire)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L0a83eMmRw"}],"identifier":"defining-the-region-of-interest-leicestershire","label":"Defining the Region of Interest (Leicestershire)","html_id":"defining-the-region-of-interest-leicestershire","implicit":true,"key":"kpqqfkFkCA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In this section, we define the bounding box for the Leicestershire region to extract a dataset sample covering both urban and non-urban areas. This will help to analyze temperature variations between these areas. In addition, the data size to download will be much smaller.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"q53iG7DGJp"}],"key":"CPtOJnxTkm"}],"key":"qNknuDyhV5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set bounding box for Leicestershire\nlon_min, lon_max = -1.5, -0.5\nlat_min, lat_max = 52.5, 53.5\n\nbbox = (lon_min, lat_min, lon_max, lat_max)\n\n# Display bounding box for reference\nIPython.display.GeoJSON(shapely.geometry.box(*bbox).__geo_interface__)","key":"FoOXSp0mKj"},{"type":"output","id":"Loc-Ih6Y7Qg47EvXgp2PE","data":[{"output_type":"display_data","metadata":{"application/geo+json":{"expanded":false,"root":"root"}},"data":{"application/geo+json":{"content":"{\"coordinates\":[[[-0.5,52.5],[-0.5,53.5],[-1.5,53.5],[-1.5,52.5],[-0.5,52.5]]],\"type\":\"Polygon\"}","content_type":"application/geo+json"},"text/plain":{"content":"\u003cIPython.display.GeoJSON object\u003e","content_type":"text/plain"}}}],"key":"klwmUqIJYY"}],"key":"JD4iJNpkRX"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"LST data basing on polar-orbiting satellites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H6je0VyRn0"}],"identifier":"lst-data-basing-on-polar-orbiting-satellites","label":"LST data basing on polar-orbiting satellites","html_id":"lst-data-basing-on-polar-orbiting-satellites","implicit":true,"key":"vamsklYv6d"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For this example, we will have a look at monthly LST for the years 2011 to 2020, which is available in the zarr data store:\n‘ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_DAY-1995-2020-fv3.00.zarr’","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ouBKnk2TLM"}],"key":"i1pI2wyrCT"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This dataset provides monthly-averaged land surface temperatures (LSTs) and uncertainty estimates from multiple polar-orbiting satellites, spanning August 1995 to December 2020, with coverage on a 0.01° global grid. LSTs, derived from instruments such as ATSR-2, AATSR, MODIS Terra, and SLSTR, are adjusted for inter-instrument biases and provide separate daytime (used in this example) and nighttime temperatures along with observation geometry, land cover, and quality flags. Produced by the University of Leicester as part of the ESA Land Surface Temperature Climate Change Initiative, the dataset meets GCOS standards and supports studies of surface heat and water fluxes.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"r1LCzD0MxQ"}],"key":"uq6RtAvfzq"}],"key":"UdnOVtS5fo"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"cci_zarr_store = get_store(\"esa-cci-zarr\")\nlst_ds = cci_zarr_store.open_data(\n    'ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_DAY-1995-2020-fv3.00.zarr'\n)\nlst_ds","key":"gn26M7ySAK"},{"type":"output","id":"JBIbX6J6z615YguF4atq9","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"8e6375c4612bc472ba3980576a06db69","path":"/cci-notebook-viewers/build/8e6375c4612bc472ba3980576a06db69.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 18TB\nDimensions:          (channel: 2, time: 294, lat: 18000, lon: 36000,\n                      length_scale: 294)\nCoordinates:\n  * channel          (channel) float64 16B 11.0 12.0\n  * lat              (lat) float32 72kB -90.0 -89.99 -89.98 ... 89.98 89.99\n  * lon              (lon) float32 144kB -180.0 -180.0 -180.0 ... 180.0 180.0\n  * time             (time) datetime64[ns] 2kB 1995-08-01 ... 2020-12-01\nDimensions without coordinates: length_scale\nData variables: (12/14)\n    dtime            (time, lat, lon) timedelta64[ns] 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    lcc              (time, lat, lon) float32 762GB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    lst              (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    lst_unc_loc_atm  (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    lst_unc_loc_cor  (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    lst_unc_loc_sfc  (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    ...               ...\n    lst_uncertainty  (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    n                (time, lat, lon) float32 762GB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    sataz            (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    satze            (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    solaz            (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\n    solze            (time, lat, lon) float64 2TB dask.array\u003cchunksize=(1, 2250, 2250), meta=np.ndarray\u003e\nAttributes: (12/42)\n    Conventions:                CF-1.8\n    catalogue_url:              https://catalogue.ceda.ac.uk/uuid/6babb8d9a8d...\n    cdm_data_type:              grid\n    comment:                    These data were produced as part of the ESA L...\n    creator_email:              djg20@le.ac.uk\n    creator_name:               University of Leicester Surface Temperature G...\n    ...                         ...\n    summary:                    This file contains level L3S global land surf...\n    time_coverage_duration:     P1M\n    time_coverage_end:          19700101T000001Z\n    time_coverage_resolution:   P1M\n    time_coverage_start:        19700101T000001Z\n    title:                      ESA LST CCI land surface temperature time ser...","content_type":"text/plain"}}}],"key":"zFut6kiaOp"}],"key":"txeVdGfwkV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now get a spatial and temporal subset. This reduces the data size and speeds up calculations.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fYE2uDkX3U"}],"key":"I4T0FmGccZ"}],"key":"q8FifqFiZ5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"subset_spatial_op = get_op('subset_spatial')\nlst_ds_sub = subset_spatial_op(ds=lst_ds, region=bbox)","key":"DH0V06DneU"},{"type":"output","id":"pgCue7ynsQ3GxcYO15dB7","data":[],"key":"dWwwzqBcPL"}],"key":"IpoC1AKegn"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"subset_temporal_op = get_op('subset_temporal')\nlst_ds_sub = subset_temporal_op(ds=lst_ds_sub, time_range=['2011-01-01', '2020-12-01'])\nlst_ds_sub  # use this to have a quick look into the metadata","key":"Xbh91TVCux"},{"type":"output","id":"mKve7Am4Y9CA21Dc1EUco","data":[{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"3bee14565a71248da67da5b7c8f9cf9f","path":"/cci-notebook-viewers/build/3bee14565a71248da67da5b7c8f9cf9f.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 116MB\nDimensions:          (channel: 2, time: 120, lat: 101, lon: 100,\n                      length_scale: 294)\nCoordinates:\n  * channel          (channel) float64 16B 11.0 12.0\n  * lat              (lat) float32 404B 52.51 52.51 52.53 ... 53.48 53.49 53.51\n  * lon              (lon) float32 400B -1.495 -1.485 -1.475 ... -0.515 -0.505\n  * time             (time) datetime64[ns] 960B 2011-01-01 ... 2020-12-01\nDimensions without coordinates: length_scale\nData variables: (12/14)\n    dtime            (time, lat, lon) timedelta64[ns] 10MB dask.array\u003cchunksize=(1, 101, 100), meta=np.ndarray\u003e\n    lcc              (time, lat, lon) float32 5MB dask.array\u003cchunksize=(1, 101, 100), meta=np.ndarray\u003e\n    lst              (time, lat, lon) float64 10MB dask.array\u003cchunksize=(1, 101, 100), meta=np.ndarray\u003e\n    lst_unc_loc_atm  (time, lat, lon) float64 10MB dask.array\u003cchunksize=(1, 101, 100), meta=np.ndarray\u003e\n    lst_unc_loc_cor  (time, lat, lon) float64 10MB dask.array\u003cchunksize=(1, 101, 100), meta=np.ndarray\u003e\n    lst_unc_loc_sfc  (time, lat, lon) float64 10MB dask.array\u003cchunksize=(1, 101, 100), meta=np.ndarray\u003e\n    ...               ...\n    lst_uncertainty  (time, lat, lon) float64 10MB dask.array\u003cchunksize=(1, 101, 100), meta=np.ndarray\u003e\n    n                (time, lat, lon) float32 5MB dask.array\u003cchunksize=(1, 101, 100), meta=np.ndarray\u003e\n    sataz            (time, lat, lon) float64 10MB dask.array\u003cchunksize=(1, 101, 100), meta=np.ndarray\u003e\n    satze            (time, lat, lon) float64 10MB dask.array\u003cchunksize=(1, 101, 100), meta=np.ndarray\u003e\n    solaz            (time, lat, lon) float64 10MB dask.array\u003cchunksize=(1, 101, 100), meta=np.ndarray\u003e\n    solze            (time, lat, lon) float64 10MB dask.array\u003cchunksize=(1, 101, 100), meta=np.ndarray\u003e\nAttributes: (12/44)\n    Conventions:                CF-1.8\n    catalogue_url:              https://catalogue.ceda.ac.uk/uuid/6babb8d9a8d...\n    cdm_data_type:              grid\n    comment:                    These data were produced as part of the ESA L...\n    creator_email:              djg20@le.ac.uk\n    creator_name:               University of Leicester Surface Temperature G...\n    ...                         ...\n    time_coverage_end:          2020-12-01T00:00:00\n    time_coverage_resolution:   P1M\n    time_coverage_start:        2011-01-01T00:00:00\n    title:                      ESA LST CCI land surface temperature time ser...\n    geospatial_bounds_crs:      CRS84\n    geospatial_bounds:          POLYGON((-1.4999972581863403 52.5000038146972...","content_type":"text/plain"}}}],"key":"ejZiIM7jAs"}],"key":"ocbuOsSqWQ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To get an impression of the mean LST in that region, we calculate the mean of the data and make a simple plot. The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uKBVrSMGoI"},{"type":"inlineCode","value":"climatology","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m3bWC7rpWz"},{"type":"text","value":" operation of the CCI Toolbox creates a ‘mean over years’ dataset by averaging the values of the given input dataset over all years. The output is a climatological dataset with the same resolution as the input dataset, in this example a monthly climatology.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i1XhG9PgUr"}],"key":"y7UZb6SrJy"}],"key":"VbH278cK33"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"climatology_op = get_op('climatology')\nlst_ds_clim = climatology_op(ds=lst_ds_sub)\n# lst_ds_clim  # use this to have a quick look into the metadata\n\n# The warning is informing you that the code is handling np.datetime64 objects without explicit timezone information. \n# This is typically not a problem for operations that do not require timezone awareness, such as climatology calculations, \n# but it might lead to unexpected behavior if timezone handling is critical for your workflow.","key":"vqQfyWMwwX"},{"type":"output","id":"_TKNrBKtSx7EyGdnNbfRa","data":[{"name":"stderr","output_type":"stream","text":"/cmsaf/cmsaf-ops3/stkothe/KE/ect/lib/python3.12/site-packages/esa_climate_toolbox/ops/aggregate.py:134: UserWarning: no explicit representation of timezones available for np.datetime64\n  climatology_bounds = xr.DataArray(data=da.tile(np.array([time_min, time_max],\n"}],"key":"MHCTi9eI95"}],"key":"u1odJ5dv0r"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s plot the climatology data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CGJkEoaY1l"}],"identifier":"lets-plot-the-climatology-data","label":"Let’s plot the climatology data","html_id":"lets-plot-the-climatology-data","implicit":true,"key":"lJvB0M5a8h"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Plotting LST Data: The code uses the plot_op operation to create a plot of mean Land Surface Temperature (LST) for a specific date (2011-06-01 represents the mean for June 2011 to 2020) from the dataset lst_ds_clim, applying a color map (‘viridis’) and adding a title for context.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RxuHJd5UsL"}],"key":"JydW8wACn4"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Adding Geographical Markers: The plot highlights specific locations, Leicester and Nottingham, by overlaying markers (o) with dashed lines at their respective latitude and longitude coordinates.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lcfZVIxggF"}],"key":"rAPoON7X3e"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Customizing the Plot: Legends are added to label the geographical markers, enhancing the plot’s interpretability for spatial analysis.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JGBiPte4d6"}],"key":"enMCXWatZ8"}],"key":"dAioFcO3Gq"}],"key":"FyWxKlBIcm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_op = get_op('plot')\n# Create a plot of the LST data\n%matplotlib inline \n\nplot_op(\n    ds=lst_ds_clim,  # Dataset variable\n    var='lst',       # Variable you want to plot\n    indexers={'time': '2011-06-01'},  # Specify the date\n    title=\"Mean Land Surface Temperature June 2011 to 2020\",\n    properties=\"cmap='viridis'\",  # Pass other properties here, such as color\n)\n\n# Add Leicester to the plot\nleicester_lat, leicester_lon = 52.6369, -1.1398\nplt.plot(leicester_lon, leicester_lat, linestyle='--', marker='o', color='r', label='Leicester')\nplt.legend()\n\n# Add Nottingham to the plot\nnottingham_lat, nottingham_lon = 52.9536, -1.1569\nplt.plot(nottingham_lon, nottingham_lat, linestyle='--', marker='o', color='m', label='Nottingham')\nplt.legend()\n\n","key":"v8iyFM4cRE"},{"type":"output","id":"iB0agjR_qREN9f8SIIR1p","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"e5e912a619bb77692638eae242a92a87","path":"/cci-notebook-viewers/build/e5e912a619bb77692638eae242a92a87.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"oKZ9nJkG40"}],"key":"PEPR7dfQsO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2. Analyze urban heat islands","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kBoZKbmrSM"}],"identifier":"id-2-analyze-urban-heat-islands","label":"2. Analyze urban heat islands","html_id":"id-2-analyze-urban-heat-islands","implicit":true,"key":"c4s6xZNS0p"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Urban areas often exhibit higher temperatures compared to their surrounding non-urban regions, a phenomenon known as the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MSAqxr45ng"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Urban Heat Island (UHI) effect","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O0L31XDShb"}],"key":"U39nb5kOFZ"},{"type":"text","value":". This section focuses on quantifying and visualizing this effect using Land Surface Temperature (LST) data from the ESA CCI dataset. By comparing LST values in urban and non-urban pixels, we can identify temperature differences and analyze their spatial patterns over time. This analysis is particularly relevant for understanding the impacts of urbanization on local climates and informing sustainable urban planning.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xmrLaWxPq1"}],"key":"MwfRFlvGAe"}],"key":"H3R05lDd5G"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Land Cover (LC) data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O8FEUi31wh"}],"identifier":"land-cover-lc-data","label":"Land Cover (LC) data","html_id":"land-cover-lc-data","implicit":true,"key":"at5UxSo8z3"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"For this step, we will use LC data for the same region. The ESA Land Cover CCI provides annual global land cover maps at 300m spatial resolution, covering the period from 1992 to 2015. Each pixel represents a land cover class based on the UN Land Cover Classification System (LCCS), accompanied by quality flags that document the classification reliability. These data offer a valuable resource for studying land cover dynamics and their role in climate systems.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"az7YbYkgHp"}],"key":"N8u4c2oju8"}],"key":"vQXoL3JJKA"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"lc_ds = cci_zarr_store.open_data(\n    'ESACCI-LC-L4-LCCS-Map-300m-P1Y-1992-2015-v2.0.7b.zarr'\n)\nlc_ds","key":"JAxXVwgv31"},{"type":"output","id":"w6xE5zs0UMPlxqkiUSYQp","data":[{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"853f336e6dc5c812c943b4919af89ba3","path":"/cci-notebook-viewers/build/853f336e6dc5c812c943b4919af89ba3.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 4TB\nDimensions:              (time: 24, lat: 64800, lon: 129600)\nCoordinates:\n  * lat                  (lat) float32 259kB 90.0 90.0 89.99 ... -90.0 -90.0\n  * lon                  (lon) float32 518kB -180.0 -180.0 ... 180.0 180.0\n  * time                 (time) datetime64[ns] 192B 1992-07-02 ... 2015-07-03\nData variables:\n    change_count         (time, lat, lon) float32 806GB dask.array\u003cchunksize=(1, 2592, 1296), meta=np.ndarray\u003e\n    current_pixel_state  (time, lat, lon) float32 806GB dask.array\u003cchunksize=(1, 2592, 1296), meta=np.ndarray\u003e\n    lccs_class           (time, lat, lon) float32 806GB dask.array\u003cchunksize=(1, 2592, 1296), meta=np.ndarray\u003e\n    observation_count    (time, lat, lon) float32 806GB dask.array\u003cchunksize=(1, 2592, 1296), meta=np.ndarray\u003e\n    processed_flag       (time, lat, lon) float32 806GB dask.array\u003cchunksize=(1, 2592, 1296), meta=np.ndarray\u003e\nAttributes: (12/40)\n    Conventions:                CF-1.6\n    TileSize:                   2048:2048\n    catalogue_url:              https://catalogue.ceda.ac.uk/uuid/b382ebe6679...\n    cdm_data_type:              grid\n    comment:                    \n    contact:                    landcover-cci@uclouvain.be\n    ...                         ...\n    time_coverage_end:          20150703T000000Z\n    time_coverage_resolution:   P1Y\n    time_coverage_start:        20150703T000000Z\n    title:                      ESA CCI Land Cover Map\n    tracking_id:                12590bad-9014-4a91-9048-d06b67965490\n    type:                       ESACCI-LC-L4-LCCS-Map-300m-P1Y","content_type":"text/plain"}}}],"key":"q7GGHOHybY"}],"key":"WZD61bj5ZL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lc_ds_sub = subset_temporal_op(ds=lc_ds, time_range=['2015-07-03', '2015-07-03'])","key":"oBe7HAM6No"},{"type":"output","id":"vvLiw5k5sc3oViwRYbUYQ","data":[],"key":"FzyyIHqelF"}],"key":"m0JIWDDQUp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"select_var_op = get_op('select_var')\nlc_ds_sub = select_var_op(ds=lc_ds_sub, var=\"lccs_class\")","key":"pTtQ6AKjca"},{"type":"output","id":"Q-Ki2MGEbsfZF9a6ocWSj","data":[],"key":"cUQDxpu8qZ"}],"key":"ZwFKozCLjv"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Downsample LC data to match the grid resolution of LST data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B3aA5hTZVY"}],"identifier":"downsample-lc-data-to-match-the-grid-resolution-of-lst-data","label":"Downsample LC data to match the grid resolution of LST data","html_id":"downsample-lc-data-to-match-the-grid-resolution-of-lst-data","implicit":true,"key":"Hd3WwLm70O"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This code snippet first normalizes the land cover dataset (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"q9yZejHk5S"},{"type":"inlineCode","value":"lc_ds_sub","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RuOwZEVwB3"},{"type":"text","value":") to standardize its values using the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"axLNIYTpNm"},{"type":"inlineCode","value":"normalize_op","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"UmPl5GoL8G"},{"type":"text","value":" operation. It then coregisters the normalized land cover dataset (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"MeVdCXomCd"},{"type":"inlineCode","value":"lc_ds_sub","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hZhafuNq5w"},{"type":"text","value":") with the land surface temperature dataset (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"jmJ0oVDrGE"},{"type":"inlineCode","value":"lst_ds_sub","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"DhwRFCEZ8Z"},{"type":"text","value":") using the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bPYyQxWIGb"},{"type":"inlineCode","value":"coregister_op","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"HUvfQNfjvG"},{"type":"text","value":" operation, aligning their spatial grids and downsampling the land cover data to match the LST grid using the “mode” method for categorical data.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"z34dNKbTDf"}],"key":"mSR8LmsQAZ"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Resampling categorical data presents a challenge because traditional statistical methods like averaging are not suitable. Instead, mode-based aggregation must be used to preserve the integrity of categorical classifications, ensuring that the dominant class in each new grid cell accurately reflects the underlying data.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"QbM0cdxOuB"}],"key":"OZFl3WR7QL"}],"key":"iGu665kgoE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"normalize_op = get_op('normalize')\n\nlc_ds_sub = normalize_op(ds=lc_ds_sub)\n\ncoregister_op = get_op('coregister')\n\ndownsampled_lc = coregister_op(\n    ds_primary=lst_ds_sub,\n    ds_replica=lc_ds_sub,\n    method_ds=\"mode\"\n)\ndownsampled_lc","key":"FTUA34Um1y"},{"type":"output","id":"9w0_Sp9c0xtO8tXj6DZ8b","data":[{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"1b72b9da46191475b54cd5667a795c5e","path":"/cci-notebook-viewers/build/1b72b9da46191475b54cd5667a795c5e.html"},"text/plain":{"content":"\u003cxarray.Dataset\u003e Size: 41kB\nDimensions:     (lat: 101, lon: 100, time: 1)\nCoordinates:\n  * lat         (lat) float32 404B 52.51 52.51 52.53 52.53 ... 53.48 53.49 53.51\n  * lon         (lon) float32 400B -1.495 -1.485 -1.475 ... -0.525 -0.515 -0.505\n  * time        (time) datetime64[ns] 8B 2015-07-03\nData variables:\n    lccs_class  (time, lat, lon) float32 40kB dask.array\u003cchunksize=(1, 101, 100), meta=np.ndarray\u003e\nAttributes: (12/40)\n    Conventions:                CF-1.6\n    TileSize:                   2048:2048\n    catalogue_url:              https://catalogue.ceda.ac.uk/uuid/b382ebe6679...\n    cdm_data_type:              grid\n    comment:                    \n    contact:                    landcover-cci@uclouvain.be\n    ...                         ...\n    time_coverage_start:        2015-07-03T00:00:00\n    title:                      ESA CCI Land Cover Map\n    tracking_id:                12590bad-9014-4a91-9048-d06b67965490\n    type:                       ESACCI-LC-L4-LCCS-Map-300m-P1Y\n    geospatial_bounds_crs:      CRS84\n    geospatial_bounds:          POLYGON((-1.4999972581863403 52.5000038146972...","content_type":"text/plain"}}}],"key":"YW2J4HqTcO"}],"key":"ItiuQgaQrn"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plotting the resulting LC field. You can have a look into the metadata of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jiCntuAtUY"},{"type":"inlineCode","value":"lccs_class","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SYjFTsIqqH"},{"type":"text","value":" variable to get the meaning of each land cover flag.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l0Ytk11NQx"}],"key":"pKVdHzpHRq"}],"key":"f8w8lXqeC2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create a colormap for land cover categories (e.g., forest, urban, water)\n\nplot_op(\n    ds=downsampled_lc,           # Dataset variable (should be xarray.Dataset or DataArray)\n    var='lccs_class',            # Variable name\n    title=\"Downsampled Land Cover Map\",\n    properties=\"cmap='tab20'\"    # Choose a colormap suitable for categorical data\n)","key":"cgQnWpDXpM"},{"type":"output","id":"KiMb4SYV96zd3tDox40vq","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"09551e3da80524b11a9cadcd5ee19863","path":"/cci-notebook-viewers/build/09551e3da80524b11a9cadcd5ee19863.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"CRdPHrxYmr"}],"key":"on8ykXlZci"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Identify urban and non-urban grid points","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"czjQfbwIzj"}],"identifier":"identify-urban-and-non-urban-grid-points","label":"Identify urban and non-urban grid points","html_id":"identify-urban-and-non-urban-grid-points","implicit":true,"key":"uAPVD8njl6"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Information on the flag for urban grid points is stored in the meta data for the variable lccs_class of the LC data. To check if the masks for urban and non-urban grid points look reasonable, we plot both fields.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"n2F2EGRQXy"}],"key":"srqTRZLbC4"}],"key":"qUzrelZihP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Urban flag value based on the land cover data\nurban_flag = 190\n\n# Apply the threshold to create the urban mask\nurban_mask = downsampled_lc['lccs_class'] \u003e= urban_flag  # Boolean mask for urban points\nurban_mask_da = urban_mask.astype(int).to_dataset(name=\"urban_mask\")  # Convert to dataset with int values\n\n# Plot the urban mask\nplot_op(\n    ds=urban_mask_da,          # Dataset variable\n    var='urban_mask',          # Variable name\n    title=\"Urban Mask\",\n    properties=\"cmap='Greys'\"  # Use a greyscale colormap\n)\n\n# Apply the threshold to create the non-urban mask\nnon_urban_mask = ~urban_mask  # Invert the urban mask\nnon_urban_mask_da = non_urban_mask.astype(int).to_dataset(name=\"non_urban_mask\")  # Convert to dataset with int values\n\n# Plot the non-urban mask\nplot_op(\n    ds=non_urban_mask_da,      # Dataset variable\n    var='non_urban_mask',      # Variable name\n    title=\"Non-Urban Mask\",\n    properties=\"cmap='Greys'\"  # Use a greyscale colormap\n)\n","key":"MoplHfFqvD"},{"type":"output","id":"R5LC6xWJepNcKE1oaslRI","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"15457dddd978d2117e0bd3eeab188d30","path":"/cci-notebook-viewers/build/15457dddd978d2117e0bd3eeab188d30.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"20e6bc2ba0c6c4082d0f6c814573e9b7","path":"/cci-notebook-viewers/build/20e6bc2ba0c6c4082d0f6c814573e9b7.png"},"text/plain":{"content":"\u003cFigure size 640x480 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"yNVk2V7TDj"}],"key":"zCSkQToTD5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we apply this mask to the data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qIruZobEy9"}],"key":"rAs1Kogsy1"}],"key":"jCiMuuhNol"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Extract the LST variable as an xarray.DataArray\nlst_data_array = lst_ds_clim['lst']  # Replace 'lst' with the correct variable name\n\n# Flip the urban_mask along the latitude axis\nurban_mask_flipped = np.flipud(urban_mask)  # Flip along the vertical axis\n\n# Apply the flipped mask to the LST data\nurban_lst = xr.where(urban_mask_flipped, lst_data_array, np.nan)\nnon_urban_lst = xr.where(~urban_mask_flipped, lst_data_array, np.nan)\n\n# Plot an example time step\ntime_step = lst_data_array.time[5]  # Choose the sixth time step for June\nplt.figure(figsize=(12, 6))\n\n# Plot Urban LST\nplt.subplot(1, 2, 1)\nurban_lst.sel(time=time_step).plot(cmap=\"viridis\")\nplt.title(f\"Urban LST at {time_step.values}\")\n\n# Plot Non-Urban LST\nplt.subplot(1, 2, 2)\nnon_urban_lst.sel(time=time_step).plot(cmap=\"viridis\")\nplt.title(f\"Non-Urban LST at {time_step.values}\")\n\nplt.tight_layout()\nplt.show()\n\n","key":"mIW42TdK9P"},{"type":"output","id":"cZG7WBuyTDL-6rTNm8kqB","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ffba5f91ff88cfcff8afd34cb0c54e22","path":"/cci-notebook-viewers/build/ffba5f91ff88cfcff8afd34cb0c54e22.png"},"text/plain":{"content":"\u003cFigure size 1200x600 with 4 Axes\u003e","content_type":"text/plain"}}}],"key":"PCXIgv5dSi"}],"key":"D5R1dJ1ZAx"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compare urban and non-urban grid points","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K61CYuH8Iu"}],"identifier":"compare-urban-and-non-urban-grid-points","label":"Compare urban and non-urban grid points","html_id":"compare-urban-and-non-urban-grid-points","implicit":true,"key":"kpAEfqb27D"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"When comparing urban and non-urban mean LST time series, keep in mind that the differing number of grid points can bias results. Urban areas often cover fewer, geographically clustered points, while non-urban areas span diverse climates, potentially skewing averages. Thus, we should consider including uncertainty bounds, noting the grid point counts, and normalizing results to improve comparability.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"wwBnyltaHH"}],"key":"GGKkjqK8IV"}],"key":"p34BXi09en"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Compute the mean LST for urban and non-urban pixels over time\nurban_mean = urban_lst.mean(dim=[\"lat\", \"lon\"])\nnon_urban_mean = non_urban_lst.mean(dim=[\"lat\", \"lon\"])\n\n# Plot the time series\nplt.figure(figsize=(10, 6))\nurban_mean.plot(label=\"Urban\")\nnon_urban_mean.plot(label=\"Non-Urban\")\nplt.title(\"Mean LST Over Time\")\nplt.ylabel(\"LST (K)\")\nplt.xlabel(\"Time\")\nplt.legend()\nplt.show()\n\n# Compute the number of grid points explicitly\nurban_count = urban_mask.sum().compute()  # Trigger computation for the Dask array\nnon_urban_count = non_urban_mask.sum().compute()\n\n# Print the results\nprint(f\"Number of Urban Grid Points: {urban_count.values}\")\nprint(f\"Number of Non-Urban Grid Points: {non_urban_count.values}\")\n\nnormalized_urban_mean = urban_mean / urban_count\nnormalized_non_urban_mean = non_urban_mean / non_urban_count\n\n# Plot the normalized time series\nplt.figure(figsize=(10, 6))\nnormalized_urban_mean.plot(label=\"Urban normalized\")\nnormalized_non_urban_mean.plot(label=\"Non-Urban normalized\")\nplt.title(\"Normalized LST Over Time\")\nplt.ylabel(\"normalized LST\")\nplt.xlabel(\"Time\")\nplt.legend()\nplt.show()","key":"uZ1IPOLGSR"},{"type":"output","id":"esA8G45x-NEInvWj1VgYB","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"68a7fb4539b14dfbfb0334fe74002599","path":"/cci-notebook-viewers/build/68a7fb4539b14dfbfb0334fe74002599.png"},"text/plain":{"content":"\u003cFigure size 1000x600 with 1 Axes\u003e","content_type":"text/plain"}}},{"name":"stdout","output_type":"stream","text":"Number of Urban Grid Points: 1331\nNumber of Non-Urban Grid Points: 8769\n"},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ed2f852dd5485ae8bd23b0aa883b678d","path":"/cci-notebook-viewers/build/ed2f852dd5485ae8bd23b0aa883b678d.png"},"text/plain":{"content":"\u003cFigure size 1000x600 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"KjpvX0hyZz"}],"key":"Kt5EOykm5u"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3. Explore uncertainties","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C8fDpiMLod"}],"identifier":"id-3-explore-uncertainties","label":"3. Explore uncertainties","html_id":"id-3-explore-uncertainties","implicit":true,"key":"Tj7JHa0rbL"},{"type":"heading","depth":4,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Discussion on Uncertainties in LST Data","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sLPIz4qtyn"}],"identifier":"discussion-on-uncertainties-in-lst-data","label":"Discussion on Uncertainties in LST Data","html_id":"discussion-on-uncertainties-in-lst-data","implicit":true,"key":"PJeSFpftlv"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Land Surface Temperature (LST) data from the ESA CCI include detailed uncertainty estimates to account for the challenges of measuring surface temperatures from space. These uncertainties arise from factors such as sensor differences, atmospheric corrections, and surface characteristics, all of which can impact data quality. In this section, we explore the different sources of uncertainty, visualize their spatial and temporal distributions, and discuss how they contribute to the total uncertainty provided with the LST products. Understanding these uncertainties is essential for interpreting the data and ensuring confidence in its applications.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HySFfB4EMK"}],"key":"fFvNBSzIgj"}],"key":"QdsfddPexb"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s use as an example the LST data for one random year.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w2VBYbSMIF"}],"key":"BCU62giSui"}],"key":"Nf71NDjgH2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lst_example = subset_temporal_op(ds=lst_ds_sub, time_range=['2011-01-01', '2011-12-01'])","key":"xDSdhHLNOm"},{"type":"output","id":"H-Kg03Ns608XZP67nLrrg","data":[],"key":"sfhNq7AGUz"}],"key":"Xc0cX8Uabl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 1: Visualize Total Uncertainty","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sj6nZR3xq8"}],"identifier":"step-1-visualize-total-uncertainty","label":"Step 1: Visualize Total Uncertainty","html_id":"step-1-visualize-total-uncertainty","implicit":true,"key":"SCJ5c6FVSb"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"wQyjrx812P"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"total uncertainty","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"wXPBj9iatd"}],"key":"qxvIUBFusL"},{"type":"text","value":" in the CCI LST data represents the overall error estimate associated with each LST measurement. It combines contributions from multiple sources of uncertainty, including:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"DZhDBHs1O4"}],"key":"tuG2mShcIC"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Random Errors","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cqEvydwudc"}],"key":"wIKvZ2DNt7"},{"type":"text","value":":","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WTV860jrYS"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Noise in the sensor measurements and other uncorrelated sources of error.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZJ5c5qejnV"}],"key":"eY81JOBVO6"}],"key":"oCsymVew45"}],"key":"Ckap2AHKBI"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Locally Correlated Errors","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"w7xZRQIe1F"}],"key":"bk4lo4uh89"},{"type":"text","value":":","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bnsLbFiqD4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Errors linked to specific spatial and temporal conditions, such as:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"SSZZRuZFFh"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Atmospheric Scale Errors","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"syAGVzRca5"}],"key":"dOOjGw135D"},{"type":"text","value":": Uncertainty from atmospheric corrections.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rknmQYSFMV"}],"key":"ue5m7rpo1Z"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Surface Scale Errors","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Z49xpSaAAN"}],"key":"mxJUdx8vmQ"},{"type":"text","value":": Uncertainty due to surface emissivity and heterogeneity.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"B4jYjFqVEq"}],"key":"frWvksl66f"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"LST Correction Errors","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"poi5C6ZG8C"}],"key":"hfFnTBGVEn"},{"type":"text","value":": Errors introduced during LST algorithm corrections.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"mMB88tOYDS"}],"key":"gxyYXnZGbF"}],"key":"R9lfe8GdSQ"}],"key":"Vxuddcpqya"}],"key":"umeGtYN2OY"}],"key":"eN4U6sT8TX"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Systematic Errors","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"sg5EJjUY1l"}],"key":"ulMMSDwxLf"},{"type":"text","value":":","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"UnhBEmKgq6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Larger-scale, persistent biases across the dataset, such as calibration differences between sensors or long-term trends in instrument performance.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"XiMeyvYcxj"}],"key":"zftcZBi5RM"}],"key":"a1Lu0iNVcO"}],"key":"KeL7CETGsg"}],"key":"NTJrwSZy0i"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"By aggregating these components, the total uncertainty provides a comprehensive error estimate for each pixel, helping users to assess the reliability of the data for their specific applications.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"LshGONqzbW"}],"key":"ZsnhkLsxzh"}],"key":"nx5Qku9KBN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Extract the total uncertainty variable\ntotal_uncertainty = lst_example['lst_uncertainty']  # That's the total uncertainty\n\n# Plot total uncertainty for a specific time step\ntime_step = total_uncertainty.time[5]  # Choose the sixth time step for June\nplt.figure(figsize=(8, 6))\ntotal_uncertainty.sel(time=time_step).plot(cmap=\"viridis\")  # Xarray handles the colorbar\nplt.title(f\"Total LST Uncertainty at {time_step.values}\")\nplt.show()","key":"jYllgAn49O"},{"type":"output","id":"eXwzSUT1Miffy5XzBKLJ7","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3ffcf309d9da9d6cfbae60e1f115501b","path":"/cci-notebook-viewers/build/3ffcf309d9da9d6cfbae60e1f115501b.png"},"text/plain":{"content":"\u003cFigure size 800x600 with 2 Axes\u003e","content_type":"text/plain"}}}],"key":"Wk2CvZl1OK"}],"key":"OT3S37w5BN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 2: Compare Uncertainty Components","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B9WYJpkZBR"}],"identifier":"step-2-compare-uncertainty-components","label":"Step 2: Compare Uncertainty Components","html_id":"step-2-compare-uncertainty-components","implicit":true,"key":"SGdTmc0J0H"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"To better understand the sources of uncertainty in the LST data, we visualize the spatial distribution of each component:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ine4i4Inpb"}],"key":"yJtYvgV1rs"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Atmospheric Errors","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CEAqm4okwF"}],"key":"ePGNbsicUu"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"LST Correction Errors","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Gg75SeFRLh"}],"key":"OrRftg0hI6"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Surface Errors","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FlAVs3lfyP"}],"key":"PNGlZEGUW7"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Random Errors","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"EQdWEvS8tt"}],"key":"QSA1OoGH0i"}],"key":"rwX40qm15N"}],"key":"btkhDsCgHt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Extract individual uncertainty components\nunc_loc_atm = lst_example['lst_unc_loc_atm']\nunc_loc_cor = lst_example['lst_unc_loc_cor']\nunc_loc_sfc = lst_example['lst_unc_loc_sfc']\nunc_ran = lst_example['lst_unc_ran']\n\n# Plot individual components for a specific time step\nfig, axs = plt.subplots(2, 2, figsize=(12, 10))\ncomponents = [unc_loc_atm, unc_loc_cor, unc_loc_sfc, unc_ran]\ntitles = [\n    \"Atmospheric Uncertainty (loc_atm)\",\n    \"LST Corrections Uncertainty (loc_cor)\",\n    \"Surface Uncertainty (loc_sfc)\",\n    \"Random Uncertainty (ran)\"\n]\n\nfor ax, comp, title in zip(axs.flat, components, titles):\n    comp.sel(time=time_step).plot(ax=ax, cmap=\"coolwarm\")\n    ax.set_title(title)\n\nplt.suptitle(f\"LST Uncertainty Components at {time_step.values}\")\nplt.tight_layout()\nplt.show()\n","key":"LiVDulhd0Q"},{"type":"output","id":"I93Hjr0ULGK2uusTbWYpV","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d01cb4f18f7adb8c33048bb918e78251","path":"/cci-notebook-viewers/build/d01cb4f18f7adb8c33048bb918e78251.png"},"text/plain":{"content":"\u003cFigure size 1200x1000 with 8 Axes\u003e","content_type":"text/plain"}}}],"key":"kRjghYuX96"}],"key":"X5cBYKlVIJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 3: Contribution to Total Uncertainty","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YpkBL1hzVP"}],"identifier":"step-3-contribution-to-total-uncertainty","label":"Step 3: Contribution to Total Uncertainty","html_id":"step-3-contribution-to-total-uncertainty","implicit":true,"key":"R9f5BWtvdL"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Let’s have a look at the contribution of each uncertainty component to the total uncertainty.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hafOIl2wyO"}],"key":"BemXoOnq9v"}],"key":"KyxAzuu1Kw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Compute mean uncertainty components over the region and time\nmean_unc_loc_atm = unc_loc_atm.mean(dim=[\"lat\", \"lon\"]).sel(time=time_step)\nmean_unc_loc_cor = unc_loc_cor.mean(dim=[\"lat\", \"lon\"]).sel(time=time_step)\nmean_unc_loc_sfc = unc_loc_sfc.mean(dim=[\"lat\", \"lon\"]).sel(time=time_step)\nmean_unc_ran = unc_ran.mean(dim=[\"lat\", \"lon\"]).sel(time=time_step)\nmean_total_unc = total_uncertainty.mean(dim=[\"lat\", \"lon\"]).sel(time=time_step)\n\n# Plot the contributions\ncontributions = [\n    mean_unc_loc_atm, mean_unc_loc_cor, mean_unc_loc_sfc, mean_unc_ran\n]\nlabels = [\"Loc Atm\", \"Loc Cor\", \"Loc Sfc\", \"Random\"]\n\nplt.figure(figsize=(8, 6))\nsome_colors = [\"#2a9d8f\", \"#264653\", \"#e9c46a\", \"#e76f51\"]\nplt.bar(labels, [c.values for c in contributions], color=some_colors)\nplt.axhline(y=mean_total_unc.values, color=\"black\", linestyle=\"--\", label=\"Total\")\nplt.title(f\"Contribution of Uncertainty Components at {time_step.values}\")\nplt.ylabel(\"Mean Uncertainty (K)\")\nplt.legend()\nplt.show()\n","key":"tGMJB4tGz5"},{"type":"output","id":"3jsOspIt1ySyyLF53wcAy","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ee392246d4d461c0fa56a88e41778487","path":"/cci-notebook-viewers/build/ee392246d4d461c0fa56a88e41778487.png"},"text/plain":{"content":"\u003cFigure size 800x600 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"Gq9GWvLc4E"}],"key":"SYfMb01TPl"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Random errors contribute the most to the total uncertainty in LST data because they arise from sensor noise, atmospheric variability, and surface heterogeneity, which are inherently unpredictable and uncorrelated across space and time. These errors are amplified in challenging conditions, such as areas with variable cloud cover, complex terrain, or mixed land cover types, where accurate retrieval of surface temperatures becomes more difficult. Additionally, the high-resolution nature of the data means more detailed measurements, which can increase the influence of random fluctuations compared to systematic or locally correlated errors.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kug7XTMJuY"}],"key":"kBh5y7luDW"}],"key":"GbeVTsXoB4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 4: Temporal Trends in Uncertainties","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xczNwYulzW"}],"identifier":"step-4-temporal-trends-in-uncertainties","label":"Step 4: Temporal Trends in Uncertainties","html_id":"step-4-temporal-trends-in-uncertainties","implicit":true,"key":"YjFhHFzIre"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Here, we aim to identify how different sources of uncertainty in LST data vary over time. By examining temporal patterns, we hope to:","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"uGH3iCF7zF"}],"key":"Yd0BEqmPdQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Detect seasonal trends, such as higher uncertainties during periods of increased cloud cover or surface variability.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q07scrPmib"}],"key":"SL8sYKzfdr"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Assess whether uncertainties remain stable over the dataset’s time span or change due to factors like sensor transitions or calibration updates.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"iQQSPQ3O3D"}],"key":"buRHwgI3FR"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Understand how each component contributes to the total uncertainty across different periods, which can provide insights into the consistency and reliability of the LST dataset for long-term climate studies.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qulLqWSsJ2"}],"key":"IYEQ0pljaA"}],"key":"UuRsOhaYAj"}],"key":"Z4OH0N8dXT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Compute mean uncertainty components over time\nmean_unc_loc_atm_time = unc_loc_atm.mean(dim=[\"lat\", \"lon\"]).dropna(dim=\"time\")\nmean_unc_loc_cor_time = unc_loc_cor.mean(dim=[\"lat\", \"lon\"]).dropna(dim=\"time\")\nmean_unc_loc_sfc_time = unc_loc_sfc.mean(dim=[\"lat\", \"lon\"]).dropna(dim=\"time\")\nmean_unc_ran_time = unc_ran.mean(dim=[\"lat\", \"lon\"]).dropna(dim=\"time\")\nmean_total_unc_time = total_uncertainty.mean(dim=[\"lat\", \"lon\"]).dropna(dim=\"time\")\n\n# Plot the time series\nplt.figure(figsize=(10, 6))\nmean_unc_loc_atm_time.plot(label=\"Loc Atm\")\nmean_unc_loc_cor_time.plot(label=\"Loc Cor\")\nmean_unc_loc_sfc_time.plot(label=\"Loc Sfc\")\nmean_unc_ran_time.plot(label=\"Random\")\nmean_total_unc_time.plot(label=\"Total\", linestyle=\"--\", color=\"black\")\nplt.title(\"Temporal Variation of LST Uncertainty Components\")\nplt.ylabel(\"Mean Uncertainty (K)\")\nplt.xlabel(\"Time\")\nplt.legend()\nplt.show()","key":"AgXmUsQroW"},{"type":"output","id":"7GLzuQSqeYtutUOXK2wVm","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c83c7fe65920bed825c4b1550bff1689","path":"/cci-notebook-viewers/build/c83c7fe65920bed825c4b1550bff1689.png"},"text/plain":{"content":"\u003cFigure size 1000x600 with 1 Axes\u003e","content_type":"text/plain"}}}],"key":"q3pEC3hYxP"}],"key":"ck5RtIzgDH"}],"key":"w0SVXyqv3u"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Questions We Aim to Explore","url":"/external-notebooks/esa-cci/ect-training/lps-vienna-06-2025/lps-intermediate-level-elnino","group":"Lps Vienna 06 2025"}}},"domain":"http://localhost:3000"},"project":{"subject":"CCI Examples","title":"CCI Examples","description":"Collection of examples relevant to the CCI activity","github":"https://github.com/esa-cci/cci-notebook-viewers","id":"5aa0318b-5bc1-41e2-b1d4-053e8b61961b","exports":[],"bibliography":[],"index":"readme","pages":[{"title":"External Notebooks","level":1},{"title":"Esa Cci","level":2},{"title":"Cci Notebooks","level":3},{"slug":"external-notebooks.esa-cci.cci-notebooks.readme","title":"cci-notebooks","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"Notebooks","level":4},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.aerosol-cci","title":"Getting Started with Aerosol CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.biomass-cci","title":"Getting Started with Biomass CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.cloud-cci","title":"Getting Started with Cloud CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.fire-cci","title":"Getting Started with Fire CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ghg-cci","title":"Getting Started with Greenhouse Gases CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.icesheets-cci","title":"Getting Started with Ice Sheets CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lakes-cci","title":"Getting Started with Lakes CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.landcover-cci","title":"Getting Started with Land Cover CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.lst-cci","title":"Getting Started with Land Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.oceancolour-cci","title":"Getting Started with Ocean Colour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.ozone-cci","title":"Getting Started with Ozone CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.permafrost-cci","title":"Getting Started with Permafrost CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.seaice-cci","title":"Getting Started with Sea Ice CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sealevel-cci","title":"Getting Started with Sea Level CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.snow-cci","title":"Getting Started with Snow CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.soilmoisture-cci","title":"Getting Started with Soil Moisture CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sss-cci","title":"Getting Started with Sea Surface Salinity CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.sst-cci","title":"Getting Started with Sea Surface Temperature CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.vegetation-cci","title":"Getting Started with Vegetation CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.cci-notebooks.notebooks.watervapour-cci","title":"Getting Started with Water Vapour CCI Data","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Ect Training","level":3},{"slug":"external-notebooks.esa-cci.ect-training.readme","title":"ect-training","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":4},{"title":"ESA Climate Change Competition","level":4},{"slug":"external-notebooks.esa-cci.ect-training.esa-climate-change-competition.competition-forests-in-a-changing-climate","title":"Explore forests in a changing climate with the ESA CCI datasets","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/0c8875bc8759d8e556047e98366f9196.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lps Vienna 06 2025","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-beginner","title":"Step 1. Setup \u0026 Imports","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-cloud-uncertainties","title":"1. Import Necessary Packages","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"slug":"external-notebooks.esa-cci.ect-training.lps-vienna-06-2025.lps-intermediate-level-elnino","title":"Questions We Aim to Explore","description":"","date":"","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5},{"title":"Lst Leicester 12 2024","level":4},{"slug":"external-notebooks.esa-cci.ect-training.lst-leicester-12-2024.lst-training","title":"Analyzing Land Surface Temperature and Uncertainties: Insights from ESA CCI Data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":5}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/cci-notebook-viewers/build/manifest-ED236704.js";
import * as route0 from "/cci-notebook-viewers/build/root-ZJOPFBMV.js";
import * as route1 from "/cci-notebook-viewers/build/routes/$-CQPS5IOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/cci-notebook-viewers/build/entry.client-UNPC4GT3.js");</script></body></html>