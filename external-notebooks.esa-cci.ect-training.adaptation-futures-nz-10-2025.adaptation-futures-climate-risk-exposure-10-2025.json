{"version":2,"kind":"Notebook","sha256":"502d0b7c32782db9d643f168694fe607a59eda203c936311ebcbd4c929c9a551","slug":"external-notebooks.esa-cci.ect-training.adaptation-futures-nz-10-2025.adaptation-futures-climate-risk-exposure-10-2025","location":"/external_notebooks/esa-cci/ect-training/adaptation-futures_NZ_10_2025/Adaptation-Futures_Climate-Risk-Exposure_10_2025.ipynb","dependencies":[],"frontmatter":{"title":"Adaptation Futures Conference (AF2025) Training - Illustrating Climate Risk Exposure with CCI Data","content_includes_title":false,"kernelspec":{"name":"conda-env-esa-cci-adaptation-futures-esa-cci-adaptation-futures-esa-climate-toolbox-nz-py","display_name":"esa-cci-adaptation-futures-esa-cci-adaptation-futures-esa-climate-toolbox-nz","language":"python"},"github":"https://github.com/esa-cci/cci-notebook-viewers","subject":"CCI Examples","numbering":{"title":{"offset":4}},"edit_url":"https://github.com/esa-cci/cci-notebook-viewers/blob/main/external_notebooks/esa-cci/ect-training/adaptation-futures_NZ_10_2025/Adaptation-Futures_Climate-Risk-Exposure_10_2025.ipynb","thumbnail":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","exports":[{"format":"ipynb","filename":"Adaptation-Futures_Climate-Risk-Exposure_10_2025.ipynb","url":"/cci-notebook-viewers/build/Adaptation-Futures_C-861296dd7b05439bb187c459cdb8ff1c.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/cci-notebook-viewers/build/3367d0fe69599d226222995bf18e04c0.png","alt":"cci_logo.png","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ohQxK2Rby7","urlSource":"data:image/png;base64,iVBORw0KGg...ORK5CYII=\n"}],"key":"rF2pGqc4rC"},{"type":"block","kind":"notebook-content","children":[{"type":"div","style":{"backgroundColor":"#e6f3ff","padding":"10px","borderLeft":"5px solid #e6f3ff"},"children":[{"type":"heading","depth":2,"children":[{"type":"text","value":"1. Introduction:","key":"BHApDRNWbW"}],"identifier":"id-1-introduction","label":"1. Introduction:","html_id":"id-1-introduction","implicit":true,"key":"GCm1FSmkwX"},{"type":"paragraph","children":[{"type":"text","value":"In this beginner-friendly notebook, we will use real satellite-based Essential Climate Variables (ECVs) data from the ","key":"NjihRdXNSv"},{"type":"link","url":"https://climate.esa.int/en/odp/#/dashboard","children":[{"type":"text","value":"ESA Climate Change Initiative (CCI)","key":"QGCpQJ6lOS"}],"urlSource":"https://climate.esa.int/en/odp/#/dashboard","key":"KEKAeTMyM5"},{"type":"text","value":" to explore recent climate trends. We will also look at how to combine population dataset with ECVs to have a first-order estimation of risk exposure caused by extreme weather events.","key":"cSHigMSSw7"}],"key":"N2U2VuJG3I"},{"type":"paragraph","children":[{"type":"text","value":"This notebook is designed for ","key":"Pwnikow06X"},{"type":"strong","children":[{"type":"text","value":"participants with no prior experience in Python or climate data analysis","key":"GQqV8loeSr"}],"key":"tSurzMdr4y"},{"type":"text","value":". You will learn:","key":"hrhTgecv0G"}],"key":"m7L2jilQJH"},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"How to access CCI ECVs using the CCI Toolbox python Package","key":"hUWvRreYx5"}],"key":"RvpSziUxY6"}],"key":"AK5dc1shrw"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"How to navigate and subset climate data using Xarray","key":"Na6Zr6A0Yg"}],"key":"x6xJrV3U49"}],"key":"bGP3BALyDG"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"How to compute basic plots using Matplotlib","key":"nTfDbpv8UU"}],"key":"FiFnoiV4B4"}],"key":"bayPBJ04NG"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"How to save a figure you generated","key":"PlyaJNHXp1"}],"key":"pe5N4wmfLu"}],"key":"XfGCeeZHT1"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"How to map and interpret ECVs changes over time and space","key":"xkkECzL8MM"}],"key":"UZutJTs4YJ"}],"key":"Hd5CKhssoG"}],"key":"uXEbiIBzdn"}],"key":"IBZQbq0weN"}],"key":"J1qSuNTY3r"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 1. Setup & Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tkJwHKko8h"}],"identifier":"step-1-setup-imports","label":"Step 1. Setup & Imports","html_id":"step-1-setup-imports","implicit":true,"key":"jl2GRklNxw"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Before we start working with the data, we need to import a few Python libraries. These libraries provide useful tools for working with satellite data, performing simple calculations, and creating visualizations.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"effHRvzAvH"}],"key":"hp6nBB3t9H"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Don‚Äôt worry if you‚Äôre not familiar with these yet ‚Äî we will explain what you need as we go.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gHLlyPCUPc"}],"key":"PDXPiBXGRS"}],"key":"xcy8gqmsjr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# ESA Climate Toolbox imports for accessing and plotting ESA CCI data\nfrom esa_climate_toolbox.core import get_op              # Get predefined operations (e.g., time series, averages)\nfrom esa_climate_toolbox.core import list_ecv_datasets   # List available datasets per ECV (Essential Climate Variable)\nfrom esa_climate_toolbox.core import get_store           # Connect to an ESA data store\nfrom esa_climate_toolbox.core import list_datasets       # List all datasets in a store\nfrom esa_climate_toolbox.core import search\nfrom esa_climate_toolbox.ops import plot                 # High-level plotting functions for CCI data\n\n# Used for connecting to remote data sources (e.g., ESA CCI ODP)\nfrom xcube.core.store import new_data_store\n\n# For displaying geographic regions interactively (if desired)\nfrom IPython.display import GeoJSON\nimport shapely.geometry   # Handling geometric objects like bounding boxes\n\n# Core data science libraries\nimport pandas as pd       # For tabular data handling and time manipulation\nimport numpy as np        # For numerical operations\nimport xarray as xr       # For multi-dimensional climate data structures\n\n# Mapping and plotting\nimport matplotlib.pyplot as plt       # Plotting library\nfrom matplotlib.colors import TwoSlopeNorm\nimport cartopy.crs as ccrs            # Cartographic projections for spatial data\nimport cartopy.feature as cfeature\nimport rasterio                       # Used to read GeoTIFF files\n\n# Notebook settings\nimport warnings\nwarnings.filterwarnings(\"ignore\") # Suppressing warnings to keep notebook output clean\n%matplotlib inline","key":"mjmb00GiSy"},{"type":"output","id":"Wz2D_5n6hQQk2m-a-Ihe1","data":[],"key":"MfuqgDBzfl"}],"key":"XjtB0ggHwq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Why we need those Python packages:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"va3pf2rJSy"}],"key":"TAe3ZdObyo"}],"identifier":"why-we-need-those-python-packages","label":"Why we need those Python packages:","html_id":"why-we-need-those-python-packages","implicit":true,"key":"uaFjXpT16O"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineCode","value":"numpy","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"K9kibxpcNa"},{"type":"text","value":": helps with numbers and arrays.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"e2s4B5euGA"}],"key":"YeasYQ4zcP"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"inlineCode","value":"matplotlib","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"KHs2kMesS1"},{"type":"text","value":": lets us create plots and maps.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JRjOKkq8gQ"}],"key":"WXPrqgQUo3"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"xarray","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"mcocly3vLZ"},{"type":"text","value":": makes it easy to work with climate datasets.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VO9gKSfJI0"}],"key":"fuwWTMO72S"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"inlineCode","value":"cartopy","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"zU2YC92IWW"},{"type":"text","value":": helps plot maps with geographic context.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Nra8EE2elw"}],"key":"UiQtmEP7cW"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"inlineCode","value":"Toolbox","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FLosXpi8zu"},{"type":"text","value":": a package that facilitates access and computation of CCI data","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Gtci3dJpKP"}],"key":"rgfaDQyO4y"}],"key":"gAvvZBhTm5"},{"type":"heading","depth":5,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Up next:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"oQLj0YlPUm"}],"key":"V7RgSaOZHF"}],"key":"zJmaQCzbfw"},{"type":"text","value":" We will learn how to ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"KqH68BMgst"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"access ECVs","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hZmGJpT79G"}],"key":"woL7nkWeLE"},{"type":"text","value":" from the CCI Toolbox.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Va9gLkj7bU"}],"identifier":"up-next-we-will-learn-how-to-access-ecvs-from-the-cci-toolbox","label":"Up next: We will learn how to access ECVs from the CCI Toolbox.","html_id":"up-next-we-will-learn-how-to-access-ecvs-from-the-cci-toolbox","implicit":true,"key":"YkUcqMEfKP"}],"key":"ImZXhpo8un"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#list_datasets(\"esa-cci-zarr\")","key":"GUGc7olSte"},{"type":"output","id":"MsWG-PPUNZ8Rw2ejpZO1u","data":[],"key":"DWlRBSSMIk"}],"key":"soD3j7SLPn"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Step 2: Load & Visualize Land Surface Temperature data (LST)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UNFWas6Mbt"}],"identifier":"step-2-load-visualize-land-surface-temperature-data-lst","label":"Step 2: Load & Visualize Land Surface Temperature data (LST)","html_id":"step-2-load-visualize-land-surface-temperature-data-lst","implicit":true,"key":"NJrSsnFVA4"},{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Define the Dataset ID","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hzMPtYFnaZ"}],"identifier":"define-the-dataset-id","label":"Define the Dataset ID","html_id":"define-the-dataset-id","implicit":true,"key":"uieoNG9YQb"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"To work with a specific ESA CCI dataset, we need to specify its ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hTjk1tzwvu"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"dataset ID","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jJk487EWIh"}],"key":"zUrBRLKg5m"},{"type":"text","value":". This unique identifier tells the toolbox which variable and product we want to access.\nWhen using the command ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iHFbN24T75"},{"type":"inlineCode","value":"list_ecv_datasets","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eMT1gvihBC"},{"type":"text","value":", you can see all available datasets for the chosen parameter (in this case ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rTdLgPzA9P"},{"type":"inlineCode","value":"\"LST\"","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fecHzLlcX8"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FY3k1SLEba"}],"key":"M3D3ecA5Bj"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"First, we define the dataset ID and the store from which we retrieve the data (for the LST file it is ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"wb6Un3kkS4"},{"type":"inlineCode","value":"esa-cci","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"oRtHoc46AS"},{"type":"text","value":").\nIn this section, we are using ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"lzUl4vPfqs"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"land surface temperature (LST)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Us1ki5pEoY"}],"key":"yhcbN49hrC"},{"type":"text","value":" data from the esa-cci-zarr store. You can find the variables of the products under ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"J2TF1IJmP5"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"data_vars","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"YWRp5vmKx0"}],"key":"J9vXidcR6D"},{"type":"text","value":". For the LST, we will use the variable ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"zZAMTyUP95"},{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"lst","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"RRhlEYTwfh"}],"key":"YiuvnHZIHR"},{"type":"text","value":".","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"eLqCZaUHXm"}],"key":"S76gPfoPoJ"}],"key":"sSCPDEfOLp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Uncomment (-> remove the \"# \") the next line, if you wish to see all available datafiles for the LST\n#list_ecv_datasets(\"LST\")","key":"bcrNydKQgg"},{"type":"output","id":"9lfGKF_ItwI8VSfGu6avk","data":[],"key":"XJuo264Ryv"}],"key":"MMnt7E1P1V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Open the ESA CCI store\ncci_store = new_data_store(\"esa-cci-zarr\")\n# define the dataset ID\ndata_id = 'ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_DAY-1995-2020-fv3.00.zarr'","key":"WLFqwfTa3Y"},{"type":"output","id":"lJlPmLweFMuKoLw1xURAK","data":[],"key":"sANvecYciB"}],"key":"igsbV2qR2x"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Describe Dataset (Check Available Variables and Metadata)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yiz8Embau2"}],"identifier":"describe-dataset-check-available-variables-and-metadata","label":"Describe Dataset (Check Available Variables and Metadata)","html_id":"describe-dataset-check-available-variables-and-metadata","implicit":true,"key":"hJ0DMrdHCd"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Before loading the full dataset, it‚Äôs helpful to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mWE34HBAoi"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"inspect the metadata","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XsPRIkIkF2"}],"key":"W5aGTp375f"},{"type":"text","value":" to understand its structure by using the command ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"swvF6AY4FP"},{"type":"inlineCode","value":"describe_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zuFmdSdVok"},{"type":"text","value":". This includes:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qynfe1KRsM"}],"key":"QNv5vzHwCR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Available variables (e.g., lst, uncertainty estimates)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zV2aycY1vF"}],"key":"RBVMVVNYjz"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Temporal and spatial coverage","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"SbZnRXZEa3"}],"key":"vyw8ItCroc"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Data format and structure","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"CbFK1xLIK2"}],"key":"rUyc2wy6IU"}],"key":"Jndk44QJ8d"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"This step ensures we know what the dataset contains and how to work with it. It also helps confirm that the variable we want to plot or analyze is actually included.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"HcRXrbWiKl"}],"key":"NiODriRVcu"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"üõ†Ô∏è Tip: You can use the description to verify variable names, dimensions (e.g., ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"xxZTCxTmUj"},{"type":"inlineCode","value":"lat","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"UcCtl9eNmM"},{"type":"text","value":", ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"HJEwvdYlky"},{"type":"inlineCode","value":"lon","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"NU4qxjTn82"},{"type":"text","value":", ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"dEbCfMJ7Ot"},{"type":"inlineCode","value":"time","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"WvrDDBDgNm"},{"type":"text","value":"), and time coverage. Under ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Qtij87g9Ix"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"data_vars","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Uf1VTg9lEs"}],"key":"rTHwMoh2b0"},{"type":"text","value":" you can find the data variables and the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"GF4vNoBIjK"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"attrs","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"QJIgh0rq09"}],"key":"DJGd4oNlQ4"},{"type":"text","value":" within the ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"W8osZFB1QA"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"data_vars","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"dzeZ5saAQf"}],"key":"trR1oWmREI"},{"type":"text","value":" section show you the data attributes, e.g. the long name of the variable or the unit.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"RLTWiuM26t"}],"key":"lxhOAF5Bng"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"üìò More on dataset structure:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"msljMcQRjR"},{"type":"break","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"frCWWr5YkZ"},{"type":"text","value":"üîó ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"LJ6Ov8EssR"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#accessing-data","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"ESA Climate Toolbox ‚Äì Data Access","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"LNG71Loglb"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/quick_start.html#accessing-data","key":"WUwXvnM2O5"}],"key":"nlaBgjUZtl"}],"key":"IyVcFSRIJb"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"# Inspect the data structure\ncci_store.describe_data(data_id)","key":"wDvgtgNiC4"},{"type":"output","id":"dRfd8VsNCNjjgddt23V5g","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"application/json":{"content":"{\"attrs\":{\"Conventions\":\"CF-1.8\",\"catalogue_url\":\"https://catalogue.ceda.ac.uk/uuid/6babb8d9a8d247bcb3da6aed42f4b59a\",\"cdm_data_type\":\"grid\",\"comment\":\"These data were produced as part of the ESA LST CCI project.\",\"creator_email\":\"djg20@le.ac.uk\",\"creator_name\":\"University of Leicester Surface Temperature Group\",\"creator_url\":\"https://climate.esa.int/en/projects/land-surface-temperature\",\"date_created\":\"20220616T135239Z\",\"doi\":\"10.5285/785ef9d3965442669bff899540747e28\",\"format_version\":\"CCI Data Standards v2.2\",\"geospatial_lat_max\":89.99498748779297,\"geospatial_lat_min\":-89.99500274658203,\"geospatial_lat_resolution\":0.009999999776482582,\"geospatial_lat_units\":\"degrees_north\",\"geospatial_lon_max\":179.9949951171875,\"geospatial_lon_min\":-179.9949951171875,\"geospatial_lon_resolution\":0.009999999776482582,\"geospatial_lon_units\":\"degrees_east\",\"geospatial_vertical_max\":0,\"geospatial_vertical_min\":0,\"history\":\"Created using software developed at University of Leicester\",\"id\":\"ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_DAY-20201201000000-fv2.00.nc\",\"institution\":\"University of Leicester\",\"key_variables\":\"land_surface_temperature\",\"keywords\":\"Earth Science; Land Surface; Land Temperature; Land Surface Temperature\",\"keywords_vocabulary\":\"NASA Global change Master Directory (GCMD) Science Keywords\",\"license\":\"ESA CCI Data Policy: free and open access\",\"naming_authority\":\"le.ac.uk\",\"platform\":\"Sentinel-3A\",\"product_version\":\"2.00\",\"project\":\"Climate Change Initiative - European Space Agency\",\"references\":\"https://climate.esa.int/en/projects/land-surface-temperature\",\"sensor\":\"SLSTRA\",\"source\":\"ESA LST CCI IRCDR L3S V2.00\",\"spatial_resolution\":\"0.01 degree\",\"standard_name_vocabulary\":\"CF Standard Name Table v71\",\"summary\":\"This file contains level L3S global land surface temperatures from SLSTRA. L3S data are derived from more than one sensor combined on a space and/or time grid.\",\"time_coverage_duration\":\"P1M\",\"time_coverage_end\":\"19700101T000001Z\",\"time_coverage_resolution\":\"P1M\",\"time_coverage_start\":\"19700101T000001Z\",\"title\":\"ESA LST CCI land surface temperature time series from multiple IR sensors on LEO platforms.\"},\"bbox\":[-179.99999511705187,-90.00000274631076,179.99999511705187,89.9999874875217],\"coords\":{\"channel\":{\"attrs\":{\"long_name\":\"channel wavelength in microns\",\"units\":\"microns\",\"valid_max\":15000,\"valid_min\":0},\"dims\":[\"channel\"],\"dtype\":\"float64\",\"name\":\"channel\"},\"lat\":{\"attrs\":{\"long_name\":\"latitude_coordinates\",\"reference_datum\":\"geographical coordinates, WGS84 projection\",\"standard_name\":\"latitude\",\"units\":\"degrees_north\",\"valid_max\":90,\"valid_min\":-90},\"dims\":[\"lat\"],\"dtype\":\"float32\",\"name\":\"lat\"},\"lon\":{\"attrs\":{\"long_name\":\"longitude_coordinates\",\"reference_datum\":\"geographical coordinates, WGS84 projection\",\"standard_name\":\"longitude\",\"units\":\"degrees_east\",\"valid_max\":180,\"valid_min\":-180},\"dims\":[\"lon\"],\"dtype\":\"float32\",\"name\":\"lon\"},\"time\":{\"attrs\":{\"long_name\":\"reference time of file\",\"standard_name\":\"time\"},\"dims\":[\"time\"],\"dtype\":\"datetime64[ns]\",\"name\":\"time\"}},\"data_id\":\"ESACCI-LST-L3S-LST-IRCDR_-0.01deg_1MONTHLY_DAY-1995-2020-fv3.00.zarr\",\"data_type\":\"dataset\",\"data_vars\":{\"dtime\":{\"attrs\":{\"long_name\":\"time difference from reference time\",\"valid_max\":2678400,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"timedelta64[ns]\",\"name\":\"dtime\"},\"lcc\":{\"attrs\":{\"flag_meanings\":\"cropland_rainfed cropland_rainfed_herbaceous_cover cropland_rainfed_tree_or_shrub_cover cropland_irrigated mosaic_cropland mosaic_natural_vegetation tree_broadleaved_evergreen_closed_to_open tree_broadleaved_deciduous_closed_to_open tree_broadleaved_deciduous_closed tree_broadleaved_deciduous_open tree_needleleaved_evergreen_closed_to_open tree_needleleaved_evergreen_closed tree_needleleaved_evergreen_open tree_needleleaved_deciduous_closed_to_open tree_needleleaved_deciduous_closed tree_needleleaved_deciduous_open tree_mixed mosaic_tree_and_shrub mosaic_herbaceous shrubland shrubland_evergreen shrubland_deciduous grassland lichens_and_mosses sparse_vegetation sparse_tree sparse_shrub sparse_herbaceous tree_cover_flooded_fresh_or_brakish_water tree_cover_flooded_saline_water shrub_or_herbaceous_cover_flooded urban Bare_areas_of_soil_types_not_contained_in_biomes_203_to_207 Unconsolidated_bare_areas_of_soil_types_not_contained_in_biomes_203_to_207 Consolidated_bare_areas_of_soil_types_not_contained_in_biomes_203_to_207 Bare_areas_of_soil_type_Entisols_Orthents Bare_areas_of_soil_type_Shifting_sand Bare_areas_of_soil_type_Aridisols_Calcids Bare_areas_of_soil_type_Aridisols_Cambids Bare_areas_of_soil_type_Gelisols_Orthels water snow_and_ice Sea_ice\",\"flag_values\":[10,11,12,20,30,40,50,60,61,62,70,71,72,80,81,82,90,100,110,120,121,122,130,140,150,151,152,153,160,170,180,190,200,201,202,203,204,205,206,207,210,220,230],\"long_name\":\"land cover class\",\"units\":\"1\",\"valid_max\":230,\"valid_min\":10},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float32\",\"name\":\"lcc\"},\"lst\":{\"attrs\":{\"long_name\":\"land surface temperature\",\"units\":\"kelvin\",\"valid_max\":7685,\"valid_min\":-8315},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"lst\"},\"lst_unc_loc_atm\":{\"attrs\":{\"long_name\":\"uncertainty from locally correlated errors on atmospheric scales\",\"units\":\"kelvin\",\"valid_max\":10000,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"lst_unc_loc_atm\"},\"lst_unc_loc_cor\":{\"attrs\":{\"long_name\":\"uncertainty from locally correlated errors on LST corrections\",\"units\":\"kelvin\",\"valid_max\":10000,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"lst_unc_loc_cor\"},\"lst_unc_loc_sfc\":{\"attrs\":{\"long_name\":\"uncertainty from locally correlated errors on surface scales\",\"units\":\"kelvin\",\"valid_max\":10000,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"lst_unc_loc_sfc\"},\"lst_unc_ran\":{\"attrs\":{\"long_name\":\"uncertainty from uncorrelated errors\",\"units\":\"kelvin\",\"valid_max\":10000,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"lst_unc_ran\"},\"lst_unc_sys\":{\"attrs\":{\"long_name\":\"uncertainty from large-scale systematic errors\",\"units\":\"kelvin\",\"valid_max\":10000,\"valid_min\":0},\"chunks\":[1],\"dims\":[\"length_scale\"],\"dtype\":\"float64\",\"name\":\"lst_unc_sys\"},\"lst_uncertainty\":{\"attrs\":{\"long_name\":\"land surface temperature total uncertainty\",\"units\":\"kelvin\",\"valid_max\":10000,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"lst_uncertainty\"},\"n\":{\"attrs\":{\"long_name\":\"number of clear-sky pixels\",\"valid_max\":18750,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float32\",\"name\":\"n\"},\"sataz\":{\"attrs\":{\"long_name\":\"satellite azimuth angle\",\"units\":\"degrees\",\"valid_max\":18000,\"valid_min\":-18000},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"sataz\"},\"satze\":{\"attrs\":{\"long_name\":\"satellite zenith angle\",\"units\":\"degrees\",\"valid_max\":18000,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"satze\"},\"solaz\":{\"attrs\":{\"long_name\":\"solar azimuth angle\",\"units\":\"degrees\",\"valid_max\":18000,\"valid_min\":-18000},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"solaz\"},\"solze\":{\"attrs\":{\"long_name\":\"solar zenith angle\",\"units\":\"degrees\",\"valid_max\":18000,\"valid_min\":0},\"chunks\":[1,2250,2250],\"dims\":[\"time\",\"lat\",\"lon\"],\"dtype\":\"float64\",\"name\":\"solze\"}},\"dims\":{\"channel\":2,\"lat\":18000,\"length_scale\":294,\"lon\":36000,\"time\":294},\"time_range\":[\"1995-08-01\",\"2020-12-01\"]}","content_type":"application/json"},"text/plain":{"content":"<xcube.core.store.descriptor.DatasetDescriptor at 0x7fecd8f738c0>","content_type":"text/plain"}}}],"key":"LBMnbvkprA"}],"key":"KFLaR0Vb2j"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load the Dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dFafaCvSfc"}],"identifier":"load-the-dataset","label":"Load the Dataset","html_id":"load-the-dataset","implicit":true,"key":"YwGlmf7vvH"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Now that we have an understanding of the data structure and have defined the data store and ID, we can open the dataset by using the command ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sH4bN41hh3"},{"type":"inlineCode","value":"open_data","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"S6LjPFP8V8"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"usRFf3N8Ur"}],"key":"ap9fEOPOma"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We can then inspect the data structure and content by displaying the dataset. The displayed dataset is interactive in Jupyter Notebooks, thus you can use the arrows to see the content of the dataset, e.g. the Data variables or Coordinates and you can click on the container symbol ‚ò∞ to see what is inside.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"STdGxQ7ruQ"}],"key":"ZzWWhT7uBa"}],"key":"rkhl2CZEIR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lst_ds = cci_store.open_data(\n    data_id=data_id,\n)\ndisplay(lst_ds)","key":"IqROnOUer3"},{"type":"output","id":"ZUfMJNorsWcRu3i98WBko","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"9b9746ea92211e2752eb1a8d62b4dade","path":"/cci-notebook-viewers/build/9b9746ea92211e2752eb1a8d62b4dade.html"},"text/plain":{"content":"<xarray.Dataset> Size: 18TB\nDimensions:          (time: 294, lat: 18000, lon: 36000, length_scale: 294,\n                      channel: 2)\nCoordinates:\n  * channel          (channel) float64 16B 11.0 12.0\n  * lat              (lat) float32 72kB -90.0 -89.99 -89.98 ... 89.98 89.99\n  * lon              (lon) float32 144kB -180.0 -180.0 -180.0 ... 180.0 180.0\n  * time             (time) datetime64[ns] 2kB 1995-08-01 ... 2020-12-01\nDimensions without coordinates: length_scale\nData variables: (12/14)\n    dtime            (time, lat, lon) timedelta64[ns] 2TB dask.array<chunksize=(1, 2250, 2250), meta=np.ndarray>\n    lcc              (time, lat, lon) float32 762GB dask.array<chunksize=(1, 2250, 2250), meta=np.ndarray>\n    lst              (time, lat, lon) float64 2TB dask.array<chunksize=(1, 2250, 2250), meta=np.ndarray>\n    lst_unc_loc_atm  (time, lat, lon) float64 2TB dask.array<chunksize=(1, 2250, 2250), meta=np.ndarray>\n    lst_unc_loc_cor  (time, lat, lon) float64 2TB dask.array<chunksize=(1, 2250, 2250), meta=np.ndarray>\n    lst_unc_loc_sfc  (time, lat, lon) float64 2TB dask.array<chunksize=(1, 2250, 2250), meta=np.ndarray>\n    ...               ...\n    lst_uncertainty  (time, lat, lon) float64 2TB dask.array<chunksize=(1, 2250, 2250), meta=np.ndarray>\n    n                (time, lat, lon) float32 762GB dask.array<chunksize=(1, 2250, 2250), meta=np.ndarray>\n    sataz            (time, lat, lon) float64 2TB dask.array<chunksize=(1, 2250, 2250), meta=np.ndarray>\n    satze            (time, lat, lon) float64 2TB dask.array<chunksize=(1, 2250, 2250), meta=np.ndarray>\n    solaz            (time, lat, lon) float64 2TB dask.array<chunksize=(1, 2250, 2250), meta=np.ndarray>\n    solze            (time, lat, lon) float64 2TB dask.array<chunksize=(1, 2250, 2250), meta=np.ndarray>\nAttributes: (12/42)\n    Conventions:                CF-1.8\n    catalogue_url:              https://catalogue.ceda.ac.uk/uuid/6babb8d9a8d...\n    cdm_data_type:              grid\n    comment:                    These data were produced as part of the ESA L...\n    creator_email:              djg20@le.ac.uk\n    creator_name:               University of Leicester Surface Temperature G...\n    ...                         ...\n    summary:                    This file contains level L3S global land surf...\n    time_coverage_duration:     P1M\n    time_coverage_end:          19700101T000001Z\n    time_coverage_resolution:   P1M\n    time_coverage_start:        19700101T000001Z\n    title:                      ESA LST CCI land surface temperature time ser...","content_type":"text/plain"}}}],"key":"TgJfuEFhEf"}],"key":"RvtLrYbO0q"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a spatial subset of the LST data:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"brNp1qg98f"}],"identifier":"create-a-spatial-subset-of-the-lst-data","label":"Create a spatial subset of the LST data:","html_id":"create-a-spatial-subset-of-the-lst-data","implicit":true,"key":"zFGPraGkos"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To focus our analysis on New Zealand, we now extract a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LzWbgoQJ1J"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"spatial subset","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MueWjUtRSM"}],"key":"KGVUh7ImyK"},{"type":"text","value":" from the global LST dataset.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uhFbVg44WF"}],"key":"uqo4riqdH4"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Using the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xAh9eLhCO8"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"bounding box (bbox)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"i2yxBQQ5RX"}],"key":"j2oSI7kqJX"},{"type":"text","value":" we define here, the function ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NRVLf0pksO"},{"type":"inlineCode","value":"subset_spatial","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"D27YFXLQhn"},{"type":"text","value":" filters the dataset to include only the relevant area.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BM2MiwhVVC"}],"key":"Avn458kkBE"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"This helps ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IczD8MSglQ"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"reduce data volume","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"su9W6MAsgZ"}],"key":"y1xW22X2x7"},{"type":"text","value":" and enables more ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XNWQgqi9bf"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"targeted visualizations and calculations","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vnCFQTfffP"}],"key":"C0AXiT4ewi"},{"type":"text","value":" in the following steps.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"X15gqoUVDg"}],"key":"RyZ6pANeAi"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Below are several longitudes and latitudes to choose from. In the comment above, you can read which area they cover.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hkqiFalJqw"}],"key":"kOoRPLi1Kw"}],"key":"PLyM6m2k0Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set bounding box to New Zealand \n#lat_min = -53.0\n#lat_max = -33.0\n#lon_min = 165.0\n#lon_max = 180.0  # Chatham Islands cannot be included here, as it is behind the 180th meridian of the longitude","key":"Mn0P74PKIG"},{"type":"output","id":"bHcGnfLx0QIlAy1hH9_Va","data":[],"key":"ao4yAcIzCL"}],"key":"Vj2UKHiiXa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# # Set bounding box to Christchurch\nlat_min = -44\nlat_max = -43.2\nlon_min = 172.3\nlon_max = 173.8","key":"xs45NQeZch"},{"type":"output","id":"IexsGRRmYtFEHoOJ8zh-E","data":[],"key":"WHCBjDsRuw"}],"key":"eVaRMSn9JD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set bounding box to South Island\nlat_min = -47.78\nlat_max = -39.23\nlon_min = 166.1\nlon_max = 174.9","key":"U568WORlnG"},{"type":"output","id":"2YzM8V5vL_cUK_W6gQ8_I","data":[],"key":"Ea900GWurt"}],"key":"q6CYcxSQ2H"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Set bounding box to North Island\nlat_min = -42.0\nlat_max = -34.0\nlon_min = 172.0\nlon_max = 180.0","key":"GauGl3Z97Q"},{"type":"output","id":"j1aDeLLoJa9iUWOpCH7y2","data":[],"key":"MWgNAdQSDa"}],"key":"QlFHR3HrJd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bbox = (lon_min, lat_min, lon_max, lat_max)  # Fixed order: (lon_min, lat_min, lon_max, lat_max)\n# Display bounding box for reference\nGeoJSON(shapely.geometry.box(*bbox).__geo_interface__)","key":"ruZy2aNBLA"},{"type":"output","id":"1A3-SApBabSRxvGaZK-E2","data":[{"output_type":"display_data","metadata":{"application/geo+json":{"expanded":false,"root":"root"}},"data":{"application/geo+json":{"content":"{\"coordinates\":[[[174.9,-47.78],[174.9,-39.23],[166.1,-39.23],[166.1,-47.78],[174.9,-47.78]]],\"type\":\"Polygon\"}","content_type":"application/geo+json"},"text/plain":{"content":"<IPython.display.GeoJSON object>","content_type":"text/plain"}}}],"key":"lFYO9LzDrS"}],"key":"fWXUAV3uVV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Choosing an operator","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vLmMoRVnaj"}],"identifier":"choosing-an-operator","label":"Choosing an operator","html_id":"choosing-an-operator","implicit":true,"key":"cyMczotYrx"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The toolbox offers a variety of operators to choose which we can apply on the dataset. For creating a spatial subset, we would use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NwfM87kiNn"},{"type":"inlineCode","value":"subset_spatial","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"a5fMvNzd9F"},{"type":"text","value":" operator, for the temporal subset, we would use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OflInp6jkl"},{"type":"inlineCode","value":"subset_temporal","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IGChauySxL"},{"type":"text","value":" operator. In the following cells, you can see how we call the operators and how we apply them to the data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OUqlWfC8Ze"}],"key":"Lhe87wXZT0"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Hoh2i77KDp"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/notebooks/Using_Operations/1-ECT_Finding_Operations.html#Finding-Operations","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"available operators","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GeBMkZh3NY"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/notebooks/Using_Operations/1-ECT_Finding_Operations.html#Finding-Operations","key":"Mk6HL3X39r"},{"type":"text","value":" can be listed via ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wk44DR7TUW"},{"type":"inlineCode","value":"list_operations","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sZNLbAJBO3"},{"type":"text","value":" as shown below.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eAoEHDpWdD"}],"key":"nMyqF8aLEq"}],"key":"Tas0PZw8yc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Toolbox operators\nfrom esa_climate_toolbox.core import list_operations\nlist_operations()","key":"U4AAY3CL51"},{"type":"output","id":"tfevZ0KX9fhNFxL3mUhxj","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"['add_dataset_values_to_geodataframe',\n 'adjust_spatial_attrs',\n 'adjust_temporal_attrs',\n 'aggregate_statistics',\n 'animate_map',\n 'anomaly_external',\n 'anomaly_internal',\n 'arithmetics',\n 'as_geodataframe',\n 'climatology',\n 'coregister',\n 'data_frame_max',\n 'data_frame_min',\n 'data_frame_subset',\n 'detect_outliers',\n 'diff',\n 'find_closest',\n 'fourier_analysis',\n 'gapfill',\n 'merge',\n 'normalize',\n 'plot',\n 'plot_contour',\n 'plot_hist',\n 'plot_line',\n 'plot_map',\n 'plot_scatter',\n 'query',\n 'reduce',\n 'resample',\n 'select_features',\n 'select_var',\n 'statistics',\n 'subset_spatial',\n 'subset_temporal',\n 'subset_temporal_index',\n 'temporal_aggregation',\n 'to_dataframe',\n 'to_dataset',\n 'tseries_mean',\n 'tseries_point']","content_type":"text/plain"}}}],"key":"fj43gsU5Mf"}],"key":"AHtLEcYdip"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If you would like to read more about the different operations, e.g. what they are doing, what is needed as input and output, you can retrieve this information as shown below.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ac7R3zTFAV"}],"key":"vjl8Tns3Ny"}],"key":"Cz0j07L7rZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import JSON\nfrom esa_climate_toolbox.core import get_op_meta_info\n\nJSON(get_op_meta_info('subset_spatial'))","key":"UPgLL8NAjZ"},{"type":"output","id":"8tQdiEhQB389sU7J_eDwD","data":[{"output_type":"execute_result","execution_count":10,"metadata":{"application/json":{"expanded":false,"root":"root"}},"data":{"application/json":{"content":"{\"has_monitor\":true,\"header\":{\"description\":\"Do a spatial subset of the dataset\",\"tags\":[\"geometric\",\"spatial\",\"subset\"],\"version\":\"1.0\"},\"inputs\":{\"ds\":{\"data_type\":\"xarray.core.dataset.Dataset\",\"description\":\"Dataset to subset\",\"position\":0},\"mask\":{\"data_type\":\"bool\",\"default_value\":true,\"description\":\"Should values falling in the bounding box of the polygon but not the polygon itself be masked with NaN.\",\"position\":2},\"region\":{\"data_type\":\"esa_climate_toolbox.core.types.PolygonLike\",\"description\":\"Spatial region to subset\",\"position\":1}},\"outputs\":{\"return\":{\"add_history\":true,\"data_type\":\"xarray.core.dataset.Dataset\",\"description\":\"Subset dataset\"}},\"qualified_name\":\"esa_climate_toolbox.ops.subset.subset_spatial\"}","content_type":"application/json"},"text/plain":{"content":"<IPython.core.display.JSON object>","content_type":"text/plain"}}}],"key":"PUfDENUjYh"}],"key":"VdSyywnl7N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create the spatial subset with the bbox defined above\nsubset_spatial_op = get_op('subset_spatial')\nlst_ds_sub = subset_spatial_op(ds=lst_ds, region=bbox)\nlst_ds_sub","key":"kD6SKhk1iP"},{"type":"output","id":"MC7-dXOUxLyQX8J8LsvpY","data":[{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"240863c9288af966b51c799827973eff","path":"/cci-notebook-viewers/build/240863c9288af966b51c799827973eff.html"},"text/plain":{"content":"<xarray.Dataset> Size: 21GB\nDimensions:          (time: 294, lat: 857, lon: 882, length_scale: 294,\n                      channel: 2)\nCoordinates:\n  * channel          (channel) float64 16B 11.0 12.0\n  * lat              (lat) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.22\n  * lon              (lon) float32 4kB 166.1 166.1 166.1 ... 174.9 174.9 174.9\n  * time             (time) datetime64[ns] 2kB 1995-08-01 ... 2020-12-01\nDimensions without coordinates: length_scale\nData variables: (12/14)\n    dtime            (time, lat, lon) timedelta64[ns] 2GB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    lcc              (time, lat, lon) float32 889MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    lst              (time, lat, lon) float64 2GB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    lst_unc_loc_atm  (time, lat, lon) float64 2GB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    lst_unc_loc_cor  (time, lat, lon) float64 2GB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    lst_unc_loc_sfc  (time, lat, lon) float64 2GB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    ...               ...\n    lst_uncertainty  (time, lat, lon) float64 2GB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    n                (time, lat, lon) float32 889MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    sataz            (time, lat, lon) float64 2GB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    satze            (time, lat, lon) float64 2GB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    solaz            (time, lat, lon) float64 2GB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    solze            (time, lat, lon) float64 2GB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\nAttributes: (12/44)\n    Conventions:                CF-1.8\n    catalogue_url:              https://catalogue.ceda.ac.uk/uuid/6babb8d9a8d...\n    cdm_data_type:              grid\n    comment:                    These data were produced as part of the ESA L...\n    creator_email:              djg20@le.ac.uk\n    creator_name:               University of Leicester Surface Temperature G...\n    ...                         ...\n    time_coverage_end:          19700101T000001Z\n    time_coverage_resolution:   P1M\n    time_coverage_start:        19700101T000001Z\n    title:                      ESA LST CCI land surface temperature time ser...\n    geospatial_bounds_crs:      CRS84\n    geospatial_bounds:          POLYGON((166.08999633789062 -47.7900009155273...","content_type":"text/plain"}}}],"key":"vn2wQoBtIW"}],"key":"eA9HtuWdi0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Climatology operator","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hk0W3pfnl8"}],"identifier":"climatology-operator","label":"Climatology operator","html_id":"climatology-operator","implicit":true,"key":"NuntLKjnqR"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To create a ‚Äúmean over years‚Äù dataset, the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hvUeAv66DB"},{"type":"link","url":"https://esa-climate-toolbox.readthedocs.io/en/latest/api_reference.html#esa_climate_toolbox.ops.climatology","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"climatology operator","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pMTN2wEAjt"}],"urlSource":"https://esa-climate-toolbox.readthedocs.io/en/latest/api_reference.html#esa_climate_toolbox.ops.climatology","key":"b01540QR5g"},{"type":"text","value":" averages the values of the given input data over all years. This is applied in the same time resolution as the given dataset, meaning - a daily dataset will calculate a daily average over all years, a monthly dataset will calculate a monthly average accross all years.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"U86LR3AOR0"}],"key":"e8fiwp1lbU"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Note: the resulting monthly or daily data will be attributed to the first time array. In the case below, the dataset has a time array rom 1995 containing all averages from 1995-2020.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cdpXrRUkE1"}],"key":"KnNGBBd2k2"}],"key":"vEA0OKskYr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"climatology_op = get_op('climatology')\nlst_ds_clim = climatology_op(ds=lst_ds_sub)\nlst_ds_clim # use this to have a quick look into the metadata","key":"dVjATFD2T0"},{"type":"output","id":"_PlwT0IAG5EbQkoOdh0Jl","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"34ac115c517c96e7e5452be94bf72c31","path":"/cci-notebook-viewers/build/34ac115c517c96e7e5452be94bf72c31.html"},"text/plain":{"content":"<xarray.Dataset> Size: 871MB\nDimensions:             (time: 12, lat: 857, lon: 882, length_scale: 294,\n                         channel: 2, nv: 2)\nCoordinates:\n  * channel             (channel) float64 16B 11.0 12.0\n  * lat                 (lat) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.22\n  * lon                 (lon) float32 4kB 166.1 166.1 166.1 ... 174.9 174.9\n  * time                (time) datetime64[ns] 96B 1995-01-01 ... 1995-12-01\nDimensions without coordinates: length_scale, nv\nData variables: (12/15)\n    dtime               (time, lat, lon) timedelta64[ns] 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    lcc                 (time, lat, lon) float32 36MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    lst                 (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    lst_unc_loc_atm     (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    lst_unc_loc_cor     (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    lst_unc_loc_sfc     (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    ...                  ...\n    n                   (time, lat, lon) float32 36MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    sataz               (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    satze               (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    solaz               (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    solze               (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    climatology_bounds  (time, nv) datetime64[us] 192B dask.array<chunksize=(1, 2), meta=np.ndarray>\nAttributes: (12/44)\n    Conventions:                CF-1.8\n    catalogue_url:              https://catalogue.ceda.ac.uk/uuid/6babb8d9a8d...\n    cdm_data_type:              grid\n    comment:                    These data were produced as part of the ESA L...\n    creator_email:              djg20@le.ac.uk\n    creator_name:               University of Leicester Surface Temperature G...\n    ...                         ...\n    time_coverage_end:          19700101T000001Z\n    time_coverage_resolution:   P1M\n    time_coverage_start:        19700101T000001Z\n    title:                      ESA LST CCI land surface temperature time ser...\n    geospatial_bounds_crs:      CRS84\n    geospatial_bounds:          POLYGON((166.08999633789062 -47.7900009155273...","content_type":"text/plain"}}}],"key":"QxEvyDk44R"}],"key":"FZiedDC8Fj"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot a spatial map using the toolbox","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hZxet6F2YL"}],"identifier":"plot-a-spatial-map-using-the-toolbox","label":"Plot a spatial map using the toolbox","html_id":"plot-a-spatial-map-using-the-toolbox","implicit":true,"key":"zOJZECCMp1"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Let‚Äôs plot the climatology dataset using the toolbox. As index, we choose ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"iNjJjpR5dG"},{"type":"inlineCode","value":"'time' : '1995-01-01'","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zim1EBdHte"},{"type":"text","value":", meaning, we look at the mean LST in January from 1995-2020.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zssu08rwKO"}],"key":"HYTOx3eLdK"}],"key":"YV9qa2s26u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plot_op = get_op('plot')\n# Create a plot of the LST data\n\nplot_op(\n    ds=lst_ds_clim,  # Dataset variable\n    var='lst',       # Variable you want to plot  # Specify the date\n    title=\"Average Land Surface Temperature in January (1995-2020)\",\n     indexers={'time': '1995-01-01'},  # Specify the date\n    properties=\"cmap='hot_r', vmin=275, vmax= 325\", # Pass other properties here, such as color\n)\n\n#\n#Latitude, 43¬∞ 31' 55.39\"S. Longitude, 172¬∞ 38' 10.41\"E\ncity_lat, city_lon = -43.353, 172.636\nplt.plot(city_lon, city_lat, linestyle='--', marker='o', color='k', label='≈åtautahi - Christchurch ')\nplt.legend()\n","key":"nkrXyHJH58"},{"type":"output","id":"pK3Tt6_yYzcoXpnfp5jLw","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d150170b8bd9cb98d5f0fdb1ce1862a6","path":"/cci-notebook-viewers/build/d150170b8bd9cb98d5f0fdb1ce1862a6.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"key":"gR1Oec0fUt"}],"key":"PUiL5txBf1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Temporal subset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j9e6TIfawR"}],"identifier":"temporal-subset","label":"Temporal subset","html_id":"temporal-subset","implicit":true,"key":"ZzpdqmfZCa"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Next, we do a temporal subset of the dataset and choose only 2019.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"f4bU04Gh1G"}],"key":"HroipfPamI"}],"key":"zSIQKW5LQr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"subset_temporal_op = get_op('subset_temporal')\nlst_ds_sub = subset_temporal_op(ds=lst_ds_sub, time_range=['2019-01-01', '2019-12-01'])\nlst_ds_sub ","key":"kzsN1hpFLF"},{"type":"output","id":"7Vvla_PGG2mgHCAoX9s8t","data":[{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"ba202f97054ecc8a417b861ff462bac7","path":"/cci-notebook-viewers/build/ba202f97054ecc8a417b861ff462bac7.html"},"text/plain":{"content":"<xarray.Dataset> Size: 871MB\nDimensions:          (time: 12, lat: 857, lon: 882, length_scale: 294,\n                      channel: 2)\nCoordinates:\n  * channel          (channel) float64 16B 11.0 12.0\n  * lat              (lat) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.22\n  * lon              (lon) float32 4kB 166.1 166.1 166.1 ... 174.9 174.9 174.9\n  * time             (time) datetime64[ns] 96B 2019-01-01 ... 2019-12-01\nDimensions without coordinates: length_scale\nData variables: (12/14)\n    dtime            (time, lat, lon) timedelta64[ns] 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    lcc              (time, lat, lon) float32 36MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    lst              (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    lst_unc_loc_atm  (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    lst_unc_loc_cor  (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    lst_unc_loc_sfc  (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    ...               ...\n    lst_uncertainty  (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    n                (time, lat, lon) float32 36MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    sataz            (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    satze            (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    solaz            (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\n    solze            (time, lat, lon) float64 73MB dask.array<chunksize=(1, 279, 882), meta=np.ndarray>\nAttributes: (12/44)\n    Conventions:                CF-1.8\n    catalogue_url:              https://catalogue.ceda.ac.uk/uuid/6babb8d9a8d...\n    cdm_data_type:              grid\n    comment:                    These data were produced as part of the ESA L...\n    creator_email:              djg20@le.ac.uk\n    creator_name:               University of Leicester Surface Temperature G...\n    ...                         ...\n    time_coverage_end:          2019-12-01T00:00:00\n    time_coverage_resolution:   P1M\n    time_coverage_start:        2019-01-01T00:00:00\n    title:                      ESA LST CCI land surface temperature time ser...\n    geospatial_bounds_crs:      CRS84\n    geospatial_bounds:          POLYGON((166.08999633789062 -47.7900009155273...","content_type":"text/plain"}}}],"key":"EAP5RUB2lg"}],"key":"YWSHR9mUw8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let‚Äôs look at a heatwave year: 2019, in particular we will focus on January to see how we can combine LST and population data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sta47Fb9ca"}],"key":"BAE74DPn5b"}],"key":"LUHd5kGn7Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#January 2019 LST data selection\nlst_19_j=lst_ds_sub.lst.sel(time='2019-01-01')-273.15","key":"m8nYDKlvYI"},{"type":"output","id":"5_xehe9gRxHJUHICRt8PQ","data":[],"key":"Ye7ciD4Vlw"}],"key":"jukA9ERpZW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"extent=[lon_min,lon_max,lat_min,lat_max]","key":"Wor0nvvZex"},{"type":"output","id":"foN7ar-sNMKuah6Q7mD2S","data":[],"key":"ThKoby5vyA"}],"key":"mPKX2hNgx7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Combine the land surface temperature data with a population density map","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GrT7PmEQoN"}],"identifier":"combine-the-land-surface-temperature-data-with-a-population-density-map","label":"Combine the land surface temperature data with a population density map","html_id":"combine-the-land-surface-temperature-data-with-a-population-density-map","implicit":true,"key":"XOCWFUtKiM"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We can combine satellite data with socio-economic data, such as density population maps.\nThe data is retrieved from the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ebjPG8xTHa"},{"type":"link","url":"https://human-settlement.emergency.copernicus.eu/download.php","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Global Human Settlement Layer","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"GDqOm5ZSE8"}],"key":"DIUspTdfVw"}],"urlSource":"https://human-settlement.emergency.copernicus.eu/download.php","key":"GJbOioaLG3"},{"type":"text","value":" from 2020 (note, that 2019 is not available). The resolution is 30 arcsec and the coordination system is WGS84. The data can be downloaded as ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"WwyS7whrMY"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"tif","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"GLRDuZ5yC4"}],"key":"f1Mx6xPCUq"},{"type":"text","value":" file for several grids and the grids covering New Zealand have already been merged and can be found inside the same folder, where the Jupyter Notebook is stored.\nThe ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zm1R3Owzqe"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"tif","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"N6gyYhMiZ8"}],"key":"qbOhLV1PrN"},{"type":"text","value":" format includes relevant metadata, such as latitude and longitude, which allows us to combine it with the satellite data.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ZUqOosuCfo"}],"key":"L7IsRtIF36"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The data is licensed under ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"QGqnCUENoG"},{"type":"link","url":"https://creativecommons.org/licenses/by/4.0/","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"CC BY 4.0","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"IyNEmNtfbn"}],"urlSource":"https://creativecommons.org/licenses/by/4.0/","key":"GQINatXDar"},{"type":"text","value":".","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rjTuyTJA23"}],"key":"xqXvjvVPz3"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"The data has been processed (merged and clipped) for visualisation purposes in this notebook.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Q4o2ZzwJVB"}],"key":"v8ZL7ynXwD"}],"key":"Dh3V2gC3mn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Load population density raster\nwith rasterio.open(\"merged_population_NewZealand2020_density.tif\") as src:\n    pop_density = src.read(1) \n    bounds = src.bounds  # get the geographical boundaries of the tif file (left, bottom, right, top)\n    extent = [bounds.left, bounds.right, bounds.bottom, bounds.top] # define the extent of the tif file","key":"ygRD91z563"},{"type":"output","id":"lf6Vr2DHzOQvwJZF0_1j1","data":[],"key":"exRXoDJmfE"}],"key":"fgViEgL7ZU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lst_da_crs = lst_19_j.rio.write_crs(\"EPSG:4326\", inplace=True) #coordinates are in degrees: use EPSG:4326.\nlst_da_crs","key":"aJ70bcJ7Od"},{"type":"output","id":"vXPFQuJirYomzsho0D_9K","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"‚ñ∫\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"‚ñº\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;lst&#x27; (lat: 857, lon: 882)&gt; Size: 6MB\ndask.array&lt;sub, shape=(857, 882), dtype=float64, chunksize=(578, 882), chunktype=numpy.ndarray&gt;\nCoordinates:\n  * lat          (lat) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.24 -39.22\n  * lon          (lon) float32 4kB 166.1 166.1 166.1 166.1 ... 174.9 174.9 174.9\n    time         datetime64[ns] 8B 2019-01-01\n    spatial_ref  int64 8B 0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'lst'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 857</li><li><span class='xr-has-index'>lon</span>: 882</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-3d705b8b-6e40-4832-b6db-b02117d340fc' class='xr-array-in' type='checkbox' checked><label for='section-3d705b8b-6e40-4832-b6db-b02117d340fc' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(279, 882), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>\n    <tr>\n        <td>\n            <table style=\"border-collapse: collapse;\">\n                <thead>\n                    <tr>\n                        <td> </td>\n                        <th> Array </th>\n                        <th> Chunk </th>\n                    </tr>\n                </thead>\n                <tbody>\n                    \n                    <tr>\n                        <th> Bytes </th>\n                        <td> 5.77 MiB </td>\n                        <td> 3.89 MiB </td>\n                    </tr>\n                    \n                    <tr>\n                        <th> Shape </th>\n                        <td> (857, 882) </td>\n                        <td> (578, 882) </td>\n                    </tr>\n                    <tr>\n                        <th> Dask graph </th>\n                        <td colspan=\"2\"> 2 chunks in 6 graph layers </td>\n                    </tr>\n                    <tr>\n                        <th> Data type </th>\n                        <td colspan=\"2\"> float64 numpy.ndarray </td>\n                    </tr>\n                </tbody>\n            </table>\n        </td>\n        <td>\n        <svg width=\"170\" height=\"166\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n\n  <!-- Horizontal lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"120\" y2=\"0\" style=\"stroke-width:2\" />\n  <line x1=\"0\" y1=\"37\" x2=\"120\" y2=\"37\" />\n  <line x1=\"0\" y1=\"116\" x2=\"120\" y2=\"116\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"116\" style=\"stroke-width:2\" />\n  <line x1=\"120\" y1=\"0\" x2=\"120\" y2=\"116\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"0.0,0.0 120.0,0.0 120.0,116.59863945578232 0.0,116.59863945578232\" style=\"fill:#ECB172A0;stroke-width:0\"/>\n\n  <!-- Text -->\n  <text x=\"60.000000\" y=\"136.598639\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >882</text>\n  <text x=\"140.000000\" y=\"58.299320\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,140.000000,58.299320)\">857</text>\n</svg>\n        </td>\n    </tr>\n</table></div></div></li><li class='xr-section-item'><input id='section-f61d52a3-ee43-4f9d-9f84-5a97d412d28d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f61d52a3-ee43-4f9d-9f84-5a97d412d28d' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-47.78 -47.78 ... -39.24 -39.22</div><input id='attrs-031ea43a-0cb0-456d-920f-20d24688aef1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-031ea43a-0cb0-456d-920f-20d24688aef1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-da79673d-e336-4dc2-a15d-6ac1586216f1' class='xr-var-data-in' type='checkbox'><label for='data-da79673d-e336-4dc2-a15d-6ac1586216f1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude_coordinates</dd><dt><span>reference_datum :</span></dt><dd>geographical coordinates, WGS84 projection</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>valid_max :</span></dt><dd>90.0</dd><dt><span>valid_min :</span></dt><dd>-90.0</dd></dl></div><div class='xr-var-data'><pre>array([-47.785, -47.775, -47.765, ..., -39.245, -39.235, -39.225],\n      shape=(857,), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>166.1 166.1 166.1 ... 174.9 174.9</div><input id='attrs-7139dac6-94ec-4a2e-ae8b-22077357f359' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7139dac6-94ec-4a2e-ae8b-22077357f359' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb916846-9bd0-4d1b-9478-ce0209157936' class='xr-var-data-in' type='checkbox'><label for='data-eb916846-9bd0-4d1b-9478-ce0209157936' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude_coordinates</dd><dt><span>reference_datum :</span></dt><dd>geographical coordinates, WGS84 projection</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>valid_max :</span></dt><dd>180.0</dd><dt><span>valid_min :</span></dt><dd>-180.0</dd></dl></div><div class='xr-var-data'><pre>array([166.095  , 166.10501, 166.11499, ..., 174.88501, 174.89499, 174.905  ],\n      shape=(882,), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2019-01-01</div><input id='attrs-b3abb15f-e345-4a4d-bb8c-db5155392098' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b3abb15f-e345-4a4d-bb8c-db5155392098' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb3f3800-35a9-4a1c-827b-d82a619b669d' class='xr-var-data-in' type='checkbox'><label for='data-eb3f3800-35a9-4a1c-827b-d82a619b669d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>reference time of file</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2019-01-01T00:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-ad183140-287e-44c1-9334-d5c9647f01d8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ad183140-287e-44c1-9334-d5c9647f01d8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2a95cb70-b9a9-49d7-a0fd-d5cef77c699e' class='xr-var-data-in' type='checkbox'><label for='data-2a95cb70-b9a9-49d7-a0fd-d5cef77c699e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>grid_mapping_name :</span></dt><dd>latitude_longitude</dd><dt><span>spatial_ref :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-49c544a3-63bc-41ef-a938-3500c57a4004' class='xr-section-summary-in' type='checkbox'  ><label for='section-49c544a3-63bc-41ef-a938-3500c57a4004' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-e2237d94-8da6-4589-9c02-dba19aec6c45' class='xr-index-data-in' type='checkbox'/><label for='index-e2237d94-8da6-4589-9c02-dba19aec6c45' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -47.78499984741211, -47.775001525878906,  -47.76499938964844,\n       -47.755001068115234, -47.744998931884766,  -47.73500061035156,\n       -47.724998474121094,  -47.71500015258789,  -47.70499801635742,\n        -47.69499969482422,\n       ...\n       -39.314998626708984,  -39.30500030517578,  -39.29499816894531,\n        -39.28499984741211, -39.275001525878906,  -39.26499938964844,\n       -39.255001068115234, -39.244998931884766,  -39.23500061035156,\n       -39.224998474121094],\n      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;, length=857))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-967fc68d-7379-481e-b3fe-36d7916f4071' class='xr-index-data-in' type='checkbox'/><label for='index-967fc68d-7379-481e-b3fe-36d7916f4071' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([166.09500122070312, 166.10501098632812,   166.114990234375,\n                  166.125,   166.135009765625, 166.14498901367188,\n       166.15499877929688, 166.16500854492188, 166.17498779296875,\n       166.18499755859375,\n       ...\n       174.81500244140625, 174.82501220703125, 174.83499145507812,\n       174.84500122070312, 174.85501098632812,   174.864990234375,\n                  174.875,   174.885009765625, 174.89498901367188,\n       174.90499877929688],\n      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=882))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f407cebc-fc64-4860-927c-b43e6ee538a4' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f407cebc-fc64-4860-927c-b43e6ee538a4' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'lst' (lat: 857, lon: 882)> Size: 6MB\ndask.array<sub, shape=(857, 882), dtype=float64, chunksize=(578, 882), chunktype=numpy.ndarray>\nCoordinates:\n  * lat          (lat) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.24 -39.22\n  * lon          (lon) float32 4kB 166.1 166.1 166.1 166.1 ... 174.9 174.9 174.9\n    time         datetime64[ns] 8B 2019-01-01\n    spatial_ref  int64 8B 0","content_type":"text/plain"}}}],"key":"JjqXUoAEZd"}],"key":"XQ2A5PzQnu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Matching Population density data grid to the LST grid\nimport rioxarray\n\n# Load population density  as xarray DataArray\npop_da = rioxarray.open_rasterio(\"merged_population_NewZealand2020_density.tif\", masked=True).squeeze()\n\n# Regrid to LST dataset grid\npop_da_matched = pop_da.rio.reproject_match(lst_da_crs)\n\nextent = [float(pop_da_matched.x.min()), float(pop_da_matched.x.max()),\n          float(pop_da_matched.y.min()), float(pop_da_matched.y.max())]","key":"GCvrz3XN8A"},{"type":"output","id":"vp50VAdE-Xo9e6zWvPrOk","data":[],"key":"hODjSF5CHY"}],"key":"vzEyd7oH9m"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pop_da_matched","key":"Uovgcd1RaR"},{"type":"output","id":"VnWfCHO2_sUnPedRbZ5r3","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"‚ñ∫\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"‚ñº\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (y: 857, x: 882)&gt; Size: 6MB\narray([[0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       ...,\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.]], shape=(857, 882))\nCoordinates:\n    band         int64 8B 1\n    spatial_ref  int64 8B 0\n  * x            (x) float32 4kB 166.1 166.1 166.1 166.1 ... 174.9 174.9 174.9\n  * y            (y) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.24 -39.22\nAttributes:\n    AREA_OR_POINT:  Area\n    scale_factor:   1.0\n    add_offset:     0.0\n    _FillValue:     nan</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>y</span>: 857</li><li><span class='xr-has-index'>x</span>: 882</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-bb354066-e1db-40a5-861d-e093150f6abf' class='xr-array-in' type='checkbox' checked><label for='section-bb354066-e1db-40a5-861d-e093150f6abf' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0</span></div><div class='xr-array-data'><pre>array([[0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       ...,\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.]], shape=(857, 882))</pre></div></div></li><li class='xr-section-item'><input id='section-34d86aa3-417b-412f-8095-f4cb885f3e73' class='xr-section-summary-in' type='checkbox'  checked><label for='section-34d86aa3-417b-412f-8095-f4cb885f3e73' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>band</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1</div><input id='attrs-78f38f93-fa06-4755-86c4-a8f5b7d02351' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-78f38f93-fa06-4755-86c4-a8f5b7d02351' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-903b624e-1d1f-450d-afb3-2c1404c171fe' class='xr-var-data-in' type='checkbox'><label for='data-903b624e-1d1f-450d-afb3-2c1404c171fe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-d9486e0a-429c-4dbd-acaa-a378d78fc2d6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d9486e0a-429c-4dbd-acaa-a378d78fc2d6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-809b2219-aa67-4e09-89ac-cd29a701fadb' class='xr-var-data-in' type='checkbox'><label for='data-809b2219-aa67-4e09-89ac-cd29a701fadb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>grid_mapping_name :</span></dt><dd>latitude_longitude</dd><dt><span>spatial_ref :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>166.09000122208872 0.00999999722882378 0.0 -47.789999848214265 0.0 0.010000001604311934</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>166.1 166.1 166.1 ... 174.9 174.9</div><input id='attrs-c601fd10-3e35-4c5f-bb02-6ecbbae6cbaa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c601fd10-3e35-4c5f-bb02-6ecbbae6cbaa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9c131999-266f-48d5-b52e-da77f983703a' class='xr-var-data-in' type='checkbox'><label for='data-9c131999-266f-48d5-b52e-da77f983703a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([166.095  , 166.10501, 166.11499, ..., 174.88501, 174.89499, 174.905  ],\n      shape=(882,), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-47.78 -47.78 ... -39.24 -39.22</div><input id='attrs-acb6bb6c-967c-49b7-8de2-4a319e0347af' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-acb6bb6c-967c-49b7-8de2-4a319e0347af' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-00a7a584-46fe-49f9-9064-30e149fafdfc' class='xr-var-data-in' type='checkbox'><label for='data-00a7a584-46fe-49f9-9064-30e149fafdfc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-47.785, -47.775, -47.765, ..., -39.245, -39.235, -39.225],\n      shape=(857,), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1b09b199-373d-4153-83fd-40e0361c6a56' class='xr-section-summary-in' type='checkbox'  ><label for='section-1b09b199-373d-4153-83fd-40e0361c6a56' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5791f263-55b5-4cae-8c01-2fd4033b206f' class='xr-index-data-in' type='checkbox'/><label for='index-5791f263-55b5-4cae-8c01-2fd4033b206f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([166.09500122070312, 166.10501098632812,   166.114990234375,\n                  166.125,   166.135009765625, 166.14498901367188,\n       166.15499877929688, 166.16500854492188, 166.17498779296875,\n       166.18499755859375,\n       ...\n       174.81500244140625, 174.82501220703125, 174.83499145507812,\n       174.84500122070312, 174.85501098632812,   174.864990234375,\n                  174.875,   174.885009765625, 174.89498901367188,\n       174.90499877929688],\n      dtype=&#x27;float32&#x27;, name=&#x27;x&#x27;, length=882))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d37c4151-1821-447b-8452-02659ffef015' class='xr-index-data-in' type='checkbox'/><label for='index-d37c4151-1821-447b-8452-02659ffef015' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -47.78499984741211, -47.775001525878906,  -47.76499938964844,\n       -47.755001068115234, -47.744998931884766,  -47.73500061035156,\n       -47.724998474121094,  -47.71500015258789,  -47.70499801635742,\n        -47.69499969482422,\n       ...\n       -39.314998626708984,  -39.30500030517578,  -39.29499816894531,\n        -39.28499984741211, -39.275001525878906,  -39.26499938964844,\n       -39.255001068115234, -39.244998931884766,  -39.23500061035156,\n       -39.224998474121094],\n      dtype=&#x27;float32&#x27;, name=&#x27;y&#x27;, length=857))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-57ec5806-7b2d-4372-8fec-1ba6bd3ba19e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-57ec5806-7b2d-4372-8fec-1ba6bd3ba19e' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>scale_factor :</span></dt><dd>1.0</dd><dt><span>add_offset :</span></dt><dd>0.0</dd><dt><span>_FillValue :</span></dt><dd>nan</dd></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray (y: 857, x: 882)> Size: 6MB\narray([[0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       ...,\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.]], shape=(857, 882))\nCoordinates:\n    band         int64 8B 1\n    spatial_ref  int64 8B 0\n  * x            (x) float32 4kB 166.1 166.1 166.1 166.1 ... 174.9 174.9 174.9\n  * y            (y) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.24 -39.22\nAttributes:\n    AREA_OR_POINT:  Area\n    scale_factor:   1.0\n    add_offset:     0.0\n    _FillValue:     nan","content_type":"text/plain"}}}],"key":"esvFw15CIx"}],"key":"DZWcIQ1Zi6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Creating an xarray for population density\npop_dens= xr.DataArray(pop_da_matched, coords=lst_19_j.coords, dims=lst_19_j.dims)","key":"BOEZK5xv1j"},{"type":"output","id":"PXqWr03-uP_7mvsPDdY8p","data":[],"key":"CMRdPbopZD"}],"key":"SGaFpG3pSb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create side-by-side subplots\nfig, axes = plt.subplots(ncols=2, figsize=(12, 6), subplot_kw={\"projection\": ccrs.PlateCarree()})\n\n# Plotting LST\nplot_lst= lst_19_j.plot(ax=axes[0], cmap='hot_r', vmin=0, vmax=50, transform=ccrs.PlateCarree(),\n                       cbar_kwargs={'label': 'Land Surface Temperature (¬∞C)', 'orientation': 'vertical', 'shrink': 0.7})\n\n# Add coastlines and borders\naxes[0].add_feature(cfeature.COASTLINE, linewidth=1)\naxes[0].add_feature(cfeature.BORDERS, linestyle=':')\n# Set map extent (adjust as needed)\naxes[0].set_extent(extent)\n#cbar0.set_label('LST Risk Level', fontsize=10)\ngl0 = axes[0].gridlines(draw_labels=True, linewidth=0.5, color='gray', alpha=0.7, linestyle='--')\ngl0.top_labels = False\ngl0.right_labels = False\n\naxes[0].set_title('Hazard: LST Levels - January 2019', fontsize=12)\naxes[0].set_xlabel('Longitude [¬∞E]')\naxes[0].set_ylabel('Latitude [¬∞N]')\n\n#Plotting population density\nplot_pop= pop_dens.plot(ax=axes[1],cmap='Reds', vmin=0, vmax=10000,  transform=ccrs.PlateCarree(),  \n                        cbar_kwargs={'label': 'Population Density (people/km¬≤)', 'orientation': 'vertical', 'shrink': 0.7})\naxes[1].add_feature(cfeature.COASTLINE, linewidth=1)\naxes[1].add_feature(cfeature.BORDERS, linestyle=':')\naxes[1].set_extent(extent)\n# Add colorbar\ngl1 = axes[1].gridlines( draw_labels=True, linewidth=0.5, color='gray', alpha=0.7, linestyle='--')\ngl1.top_labels = False\ngl1.right_labels = False\n\naxes[1].set_title('Exposure:  Population Density Levels - 2019', fontsize=12)\naxes[1].set_xlabel('Longitude [¬∞E]')\naxes[1].set_ylabel('Latitude [¬∞N]')\n\nplt.suptitle('New Zealand 2019 Heatwave', fontsize=14, y=0.97)\nplt.tight_layout()\nplt.show()","key":"thejIeRb0S"},{"type":"output","id":"C_bk1VgP_caNKenW4DfNA","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a4feb1f6f364764c36a63eff05c0122b","path":"/cci-notebook-viewers/build/a4feb1f6f364764c36a63eff05c0122b.png"},"text/plain":{"content":"<Figure size 1200x600 with 4 Axes>","content_type":"text/plain"}}}],"key":"Hc1zIkLqgP"}],"key":"mQmEbM9l3z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Reclassifying LST and population density for risk maps","key":"Q3Yv6Z7hDA"},{"type":"output","id":"Gz9ZBKFBp1ZerDJtAL1xt","data":[],"key":"zGBFD2Sswz"}],"key":"gwLl5n9m0R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Define classes for grouping LST data\n#low : , medium: , high: \n#LST levels \n\n#very low < 20 value 1 \n#low < 20-30¬∞C value 2 \n#Medium 30-35 ¬∞C value 3 \n#High <35¬∞ - 40¬∞C value 4  \n#Very High 40‚Äì50\t5\n#Extreme >50¬∞  value 6\nlst_bins   = [20, 30, 35, 40, 50]\nlst_values = [1, 2, 3, 4, 5]","key":"fA98t0yRYJ"},{"type":"output","id":"y-jEO35c36mZXdaxFnL9y","data":[],"key":"oeiSEWteaY"}],"key":"QMvOBudtnB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Function to reclassify data to match each value ranges to a level of risk\ndef reclassify_with_numpy_ge(array, bins, new_values):\n    reclassified_array = np.zeros_like(array)\n    reclassified_array[array < bins[0]] = new_values[0]  # below first bin\n    for i in range(len(bins) - 1):\n        reclassified_array[(array >= bins[i]) & (array < bins[i + 1])] = new_values[i]\n    reclassified_array[array >= bins[-1]] = new_values[-1]  # above last bin\n    return reclassified_array","key":"KwzWFcvlQT"},{"type":"output","id":"SaodgwkLGRRxQ0aP0G-iy","data":[],"key":"YT5DWj2YTT"}],"key":"CAvHuXCbFn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Apply the reclassification function\nlst_class = reclassify_with_numpy_ge(lst_19_j.values, bins=lst_bins, new_values=lst_values)","key":"h7BnSqiLoy"},{"type":"output","id":"HuqWW01R5wDfGfJ3rapk7","data":[],"key":"OGJt2iTLLH"}],"key":"CqfhKHgzNE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Convert the reclassified array back to xarray DataArray for plotting\nlst_class_da = xr.DataArray(lst_class, coords=lst_19_j.coords, dims=lst_19_j.dims)","key":"ZOti6Ueecm"},{"type":"output","id":"DndLKBYYjsk3PDjzmlUfr","data":[],"key":"wLgF5p6Hct"}],"key":"piORBLGnML"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cmap = plt.get_cmap('YlOrRd', 5) \n\n\nfig, ax = plt.subplots(figsize=(8,6), subplot_kw={\"projection\": ccrs.PlateCarree()})\n\n# Plot the data\nplot_lst= lst_class_da.plot(ax=ax, cmap=cmap, vmin=1, vmax=5, transform=ccrs.PlateCarree() , add_colorbar=False)\n\n# Add New Zealand coastlines\nax.add_feature(cfeature.COASTLINE, linewidth=1)\nax.add_feature(cfeature.BORDERS, linestyle=':')\nax.set_ylim(lat_min,lat_max)\nax.set_xlim(lon_min,lon_max)\n\n# Colorbar\ncbar = fig.colorbar(plot_lst, ticks=[1.25, 3., 4.25])\ncbar.ax.set_yticklabels(['Low', 'Medium', 'Very High'], size=10)\n\n#very low < 20 value 1 \n#low < 20-30¬∞C value 2 \n#Medium 30-40 ¬∞C value 3 \n#High <40¬∞ - 50¬∞C value 4  \n#Very High 50‚Äì55\t5\n#Extreme >55¬∞  value 6\n\n# Add gridlines with labels\ngrid = ax.gridlines(draw_labels=True, crs=ccrs.PlateCarree(), linewidth=0.5, color='gray', alpha=0.7, linestyle='--')\ngrid.top_labels = False\ngrid.right_labels = False\n\nax.set_xlabel('lon [deg_east]')\nax.set_ylabel('lat [deg_north]')\nplt.title('LST Levels during January 2019', size=12)\nplt.show()","key":"d6qwuhnJxh"},{"type":"output","id":"l1pdc2Q13egbIUmX3Gw0U","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fc3529ebe7d352271c45f058fb85f816","path":"/cci-notebook-viewers/build/fc3529ebe7d352271c45f058fb85f816.png"},"text/plain":{"content":"<Figure size 800x600 with 2 Axes>","content_type":"text/plain"}}}],"key":"AJeyeNEquD"}],"key":"uo4kuxmbL7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Reclassifying Population Density for risk maps","key":"rh37nvUBwx"},{"type":"output","id":"UPhehi7qr3yagZdLrDCDW","data":[],"key":"WqrGGFuAlW"}],"key":"AiZXNmKfYo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#defining level ranges for population density \npop_bins = [0, 50, 100, 1000, 10000]  # Effect on the human health\npop_values = [1, 2, 3, 4, 5]","key":"FFGigjxlpv"},{"type":"output","id":"8TYSjhS5xFD8wjsiQNiRY","data":[],"key":"QJrC8rlAKE"}],"key":"AFHue65O60"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Apply the reclassification function\npop_class = reclassify_with_numpy_ge(pop_da_matched, bins=pop_bins, new_values=pop_values)","key":"MYaJzfI04a"},{"type":"output","id":"PyJRJ3A-SQUJ877i_PWd0","data":[],"key":"LI0ayMJb3L"}],"key":"Yqqma479Bf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Creating an xarray for population density classified\npop_class_da = xr.DataArray(pop_class, coords=lst_19_j.coords, dims=lst_19_j.dims)","key":"Tcs5Sh23Dc"},{"type":"output","id":"I4d7EdB1XSESG8-nN8FTW","data":[],"key":"JKR2YW52w3"}],"key":"AB1biJIVvj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cmap = plt.get_cmap('YlOrBr', 5) \nfig, ax = plt.subplots(figsize=(8,6), subplot_kw={\"projection\": ccrs.PlateCarree()})\nplot_pop= pop_class_da.plot(ax=ax, cmap=cmap, vmin=1, vmax=5, transform=ccrs.PlateCarree(),  add_colorbar=False,)\n\ncbar = fig.colorbar(plot_pop, ticks=[1.25, 3., 4.25])\ncbar.ax.set_yticklabels(['Low', 'Medium', 'Very High'], size=10)\n\n# Add New Zealand coastlines\nax.add_feature(cfeature.COASTLINE, linewidth=1)\nax.add_feature(cfeature.BORDERS, linestyle=':')\nax.set_ylim(lat_min,lat_max)\nax.set_xlim(lon_min,lon_max)\n\n# Add gridlines with labels\ngrid = ax.gridlines(draw_labels=True, crs=ccrs.PlateCarree(), linewidth=0.5, color='gray', alpha=0.7, linestyle='--')\ngrid.top_labels = False\ngrid.right_labels = False\n\nplt.title(\"Population Density\")\nplt.tight_layout()\nplt.show()","key":"H4E7cEL2Rz"},{"type":"output","id":"es-1Bx7J8W9B-RWj7pyaa","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fde479484cdc741d59ab0d30974b6a98","path":"/cci-notebook-viewers/build/fde479484cdc741d59ab0d30974b6a98.png"},"text/plain":{"content":"<Figure size 800x600 with 2 Axes>","content_type":"text/plain"}}}],"key":"owUrQdBLm3"}],"key":"XSYUNGuftS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Risk exposure to heat\nrisk_map = lst_class_da + pop_class\nrisk_map","key":"shHN5Fn167"},{"type":"output","id":"M8BjnzQwZZ62TUgj3qmqW","data":[{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"‚ñ∫\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"‚ñº\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (lat: 857, lon: 882)&gt; Size: 6MB\narray([[1., 1., 1., ..., 1., 1., 1.],\n       [1., 1., 1., ..., 1., 1., 1.],\n       [1., 1., 1., ..., 1., 1., 1.],\n       ...,\n       [1., 1., 1., ..., 2., 2., 2.],\n       [1., 1., 1., ..., 2., 2., 2.],\n       [1., 1., 1., ..., 2., 2., 2.]], shape=(857, 882))\nCoordinates:\n  * lat          (lat) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.24 -39.22\n  * lon          (lon) float32 4kB 166.1 166.1 166.1 166.1 ... 174.9 174.9 174.9\n    time         datetime64[ns] 8B 2019-01-01\n    spatial_ref  int64 8B 0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 857</li><li><span class='xr-has-index'>lon</span>: 882</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-7e0ef64f-c206-451f-b499-0510bb034ba0' class='xr-array-in' type='checkbox' checked><label for='section-7e0ef64f-c206-451f-b499-0510bb034ba0' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.0 1.0 1.0 1.0 1.0 1.0 1.0 1.0 ... 2.0 2.0 2.0 2.0 2.0 2.0 2.0 2.0</span></div><div class='xr-array-data'><pre>array([[1., 1., 1., ..., 1., 1., 1.],\n       [1., 1., 1., ..., 1., 1., 1.],\n       [1., 1., 1., ..., 1., 1., 1.],\n       ...,\n       [1., 1., 1., ..., 2., 2., 2.],\n       [1., 1., 1., ..., 2., 2., 2.],\n       [1., 1., 1., ..., 2., 2., 2.]], shape=(857, 882))</pre></div></div></li><li class='xr-section-item'><input id='section-733ae89e-037c-46e9-834a-b3c4553e1b1e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-733ae89e-037c-46e9-834a-b3c4553e1b1e' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-47.78 -47.78 ... -39.24 -39.22</div><input id='attrs-8084ad83-ee71-4ef7-8c26-a76f2a70f810' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8084ad83-ee71-4ef7-8c26-a76f2a70f810' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e8d7418d-cc61-4b5f-ba93-aea35163f39e' class='xr-var-data-in' type='checkbox'><label for='data-e8d7418d-cc61-4b5f-ba93-aea35163f39e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude_coordinates</dd><dt><span>reference_datum :</span></dt><dd>geographical coordinates, WGS84 projection</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>valid_max :</span></dt><dd>90.0</dd><dt><span>valid_min :</span></dt><dd>-90.0</dd></dl></div><div class='xr-var-data'><pre>array([-47.785, -47.775, -47.765, ..., -39.245, -39.235, -39.225],\n      shape=(857,), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>166.1 166.1 166.1 ... 174.9 174.9</div><input id='attrs-e375e461-c75c-42e8-ba05-b3c927cbb9a7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e375e461-c75c-42e8-ba05-b3c927cbb9a7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3c618ec0-0e84-493e-ab6e-ba4bd9cba4a9' class='xr-var-data-in' type='checkbox'><label for='data-3c618ec0-0e84-493e-ab6e-ba4bd9cba4a9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude_coordinates</dd><dt><span>reference_datum :</span></dt><dd>geographical coordinates, WGS84 projection</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>valid_max :</span></dt><dd>180.0</dd><dt><span>valid_min :</span></dt><dd>-180.0</dd></dl></div><div class='xr-var-data'><pre>array([166.095  , 166.10501, 166.11499, ..., 174.88501, 174.89499, 174.905  ],\n      shape=(882,), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2019-01-01</div><input id='attrs-4b2ff06f-4ba5-48b5-9f85-d9570ac9825e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4b2ff06f-4ba5-48b5-9f85-d9570ac9825e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-21ca9135-0d8c-4b43-b724-78e062c92597' class='xr-var-data-in' type='checkbox'><label for='data-21ca9135-0d8c-4b43-b724-78e062c92597' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>reference time of file</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2019-01-01T00:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-d41ba0b3-abd1-492f-bf06-a30cd5f4c4f6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d41ba0b3-abd1-492f-bf06-a30cd5f4c4f6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1e7ec7f6-2c23-45c4-bec3-c3d0f6b1e6ce' class='xr-var-data-in' type='checkbox'><label for='data-1e7ec7f6-2c23-45c4-bec3-c3d0f6b1e6ce' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>grid_mapping_name :</span></dt><dd>latitude_longitude</dd><dt><span>spatial_ref :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b87a4a1b-5779-4e3a-86b3-4526f7b38d3d' class='xr-section-summary-in' type='checkbox'  ><label for='section-b87a4a1b-5779-4e3a-86b3-4526f7b38d3d' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-70c4be6b-2cc3-4efb-b4ba-f5f6b30aac0e' class='xr-index-data-in' type='checkbox'/><label for='index-70c4be6b-2cc3-4efb-b4ba-f5f6b30aac0e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ -47.78499984741211, -47.775001525878906,  -47.76499938964844,\n       -47.755001068115234, -47.744998931884766,  -47.73500061035156,\n       -47.724998474121094,  -47.71500015258789,  -47.70499801635742,\n        -47.69499969482422,\n       ...\n       -39.314998626708984,  -39.30500030517578,  -39.29499816894531,\n        -39.28499984741211, -39.275001525878906,  -39.26499938964844,\n       -39.255001068115234, -39.244998931884766,  -39.23500061035156,\n       -39.224998474121094],\n      dtype=&#x27;float32&#x27;, name=&#x27;lat&#x27;, length=857))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-0df50217-7eaf-4139-bfee-4bdcd0af366b' class='xr-index-data-in' type='checkbox'/><label for='index-0df50217-7eaf-4139-bfee-4bdcd0af366b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([166.09500122070312, 166.10501098632812,   166.114990234375,\n                  166.125,   166.135009765625, 166.14498901367188,\n       166.15499877929688, 166.16500854492188, 166.17498779296875,\n       166.18499755859375,\n       ...\n       174.81500244140625, 174.82501220703125, 174.83499145507812,\n       174.84500122070312, 174.85501098632812,   174.864990234375,\n                  174.875,   174.885009765625, 174.89498901367188,\n       174.90499877929688],\n      dtype=&#x27;float32&#x27;, name=&#x27;lon&#x27;, length=882))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-dc27300d-7b70-4b03-8a7b-cfaedf6bce72' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-dc27300d-7b70-4b03-8a7b-cfaedf6bce72' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray (lat: 857, lon: 882)> Size: 6MB\narray([[1., 1., 1., ..., 1., 1., 1.],\n       [1., 1., 1., ..., 1., 1., 1.],\n       [1., 1., 1., ..., 1., 1., 1.],\n       ...,\n       [1., 1., 1., ..., 2., 2., 2.],\n       [1., 1., 1., ..., 2., 2., 2.],\n       [1., 1., 1., ..., 2., 2., 2.]], shape=(857, 882))\nCoordinates:\n  * lat          (lat) float32 3kB -47.78 -47.78 -47.76 ... -39.24 -39.24 -39.22\n  * lon          (lon) float32 4kB 166.1 166.1 166.1 166.1 ... 174.9 174.9 174.9\n    time         datetime64[ns] 8B 2019-01-01\n    spatial_ref  int64 8B 0","content_type":"text/plain"}}}],"key":"xLLbQHIt4Y"}],"key":"T6PFjVdmDf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Now let's plot the risk exposure map showing where high heat coincides with high pop exposure\n#Risk=LST¬†Level+Population¬†Density¬†Level\nfig, ax = plt.subplots(figsize=(8, 6), subplot_kw={\"projection\": ccrs.PlateCarree()})\nrisk_plot= risk_map.plot(ax=ax, vmin=0, vmax=10, cmap=cmap,  add_colorbar=False, transform=ccrs.PlateCarree())\n\ncbar = fig.colorbar(risk_plot, ticks=[2, 5,  10], pad=0.09, shrink=0.8, fraction=0.03) #pad: reduce space between plot/colorbar\ncbar.ax.set_yticklabels([ 'Low', 'Medium', 'Very high'], size=10)\nax.set_title('Heatwave Risk Exposure Map (Jan 2019)')\nax.add_feature(cfeature.COASTLINE, linewidth=1)\nax.add_feature(cfeature.BORDERS, linestyle=':')\nax.set_extent(extent)\n#PLot around Christchurch only:\n#ax.set_extent([172.3, 173.8, -44, -43.2], crs=ccrs.PlateCarree())\nax.gridlines(draw_labels=True, linewidth=0.3, color='gray', alpha=0.5, linestyle='--')\n\nplt.tight_layout()\n\nplt.savefig('risk_map.png')\nplt.show()","key":"weOJcocrub"},{"type":"output","id":"pVqPfDA6VeCaz5LxVrQBe","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3a9ae3650431238f712acada62ed7e95","path":"/cci-notebook-viewers/build/3a9ae3650431238f712acada62ed7e95.png"},"text/plain":{"content":"<Figure size 800x600 with 2 Axes>","content_type":"text/plain"}}}],"key":"mIaNxkKuA7"}],"key":"yMtiSBBTr8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Zoom into Christchurch:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wU8SXBwQ44"}],"key":"Fzyf6pLciA"}],"key":"l6Pi6u7V0l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Now let's plot the risk exposure map showing where high heat coincides with high pop exposure\nfig, ax = plt.subplots(figsize=(8, 6), subplot_kw={\"projection\": ccrs.PlateCarree()})\nrisk_plot= risk_map.plot(ax=ax, vmin=0, vmax=10, cmap=cmap,  add_colorbar=False, transform=ccrs.PlateCarree())\n\ncbar = fig.colorbar(risk_plot, ticks=[2, 5,  10], pad=0.09, shrink=0.8, fraction=0.03) #pad: reduce space between plot/colorbar\ncbar.ax.set_yticklabels([ 'Low', 'Medium', 'Very high'], size=10)\nax.set_title('Heatwave Risk Exposure Map (Jan 2019)')\nax.add_feature(cfeature.COASTLINE, linewidth=1)\nax.add_feature(cfeature.BORDERS, linestyle=':')\n#ax.set_extent(extent)\n#PLot around Christchurch only:\nax.set_extent([172.3, 173.8, -44, -43.2], crs=ccrs.PlateCarree())\nax.gridlines(draw_labels=True, linewidth=0.3, color='gray', alpha=0.5, linestyle='--')\n\nplt.tight_layout()\n\nplt.savefig('risk_map_Christchurch.png')\nplt.show()","key":"FP3sSP2pGP"},{"type":"output","id":"Tm-fo3roL0fFKP2HTYvAT","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d457e6d584a759c646d9f3ecb3963a34","path":"/cci-notebook-viewers/build/d457e6d584a759c646d9f3ecb3963a34.png"},"text/plain":{"content":"<Figure size 800x600 with 2 Axes>","content_type":"text/plain"}}}],"key":"NPFyVyOPAl"}],"key":"FcUr2gvWfE"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"span","style":{"color":"blue"},"children":[{"type":"text","value":"‚Üí How to save the dataset","key":"gzmPaiVdqY"}],"key":"DN3NYD5wua"}],"identifier":"id-how-to-save-the-dataset","label":"‚Üí How to save the dataset","html_id":"id-how-to-save-the-dataset","implicit":true,"key":"kSzhJPixia"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We created a datarray file regridded on the LST grid from the population TIF dataset.\nYou can also save this dataset in your folder either as NetCDF or Zarr file like this:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JBeMx2BkBU"}],"key":"q6PbsSviFz"},{"type":"code","lang":"","value":"# For NetCDF\npop_dens.to_netcdf(\"population_density_2020.nc\")\n\n# For Zarr\npop_dens.to_zarr(\"population_density_2020.zarr\")","position":{"start":{"line":6,"column":1},"end":{"line":12,"column":1}},"key":"tzewxXIkam"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"‚Üí see next cell, where you can uncomment the command.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"KlOJ1fyQmY"}],"key":"SD3nz2BpBb"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"span","style":{"color":"blue"},"children":[{"type":"strong","children":[{"type":"text","value":"PLEASE NOTE","key":"BG48yVSdDJ"}],"key":"swYd6PpgYT"},{"type":"text","value":" : The data is very large, please ensure you have enough space to save it.","key":"Il0eWcrmgx"}],"key":"q2aZB5UmJs"}],"key":"mFZMoNyEdk"}],"key":"xw4DA3KcYq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# For NetCDF\n#pop_dens.to_netcdf(\"population_density_2020.nc\")\n\n# For Zarr\n#pop_dens.to_zarr(\"population_density_2020.zarr\")","key":"LQMAHcnSf3"},{"type":"output","id":"0d4IyXi_EFO7FpIXxeO9w","data":[],"key":"oRfSCJyBc8"}],"key":"C7Qdq4GzkL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let‚Äôs plot the time series of LST over Christchurch","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xdThjQKaqS"}],"key":"H1ixySU5bi"}],"key":"ysn2JLxcYS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#LST over CHristchurch\nlat_min = -44\nlat_max = -43.2\nlon_min = 172.3\nlon_max = 173.8\nbbox = (lon_min, lat_min, lon_max, lat_max) \nsubset_spatial_op = get_op('subset_spatial')\nlst_ds_C = subset_spatial_op(ds=lst_ds, region=bbox)\nlst_ds_C","key":"MVp97pOUbg"},{"type":"output","id":"K2DLn9X_-dgYC4CGbKQQz","data":[{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"9997be65499699b34e5292227f2625de","path":"/cci-notebook-viewers/build/9997be65499699b34e5292227f2625de.html"},"text/plain":{"content":"<xarray.Dataset> Size: 349MB\nDimensions:          (time: 294, lat: 82, lon: 151, length_scale: 294,\n                      channel: 2)\nCoordinates:\n  * channel          (channel) float64 16B 11.0 12.0\n  * lat              (lat) float32 328B -44.01 -43.99 -43.99 ... -43.21 -43.19\n  * lon              (lon) float32 604B 172.3 172.3 172.3 ... 173.8 173.8 173.8\n  * time             (time) datetime64[ns] 2kB 1995-08-01 ... 2020-12-01\nDimensions without coordinates: length_scale\nData variables: (12/14)\n    dtime            (time, lat, lon) timedelta64[ns] 29MB dask.array<chunksize=(1, 82, 151), meta=np.ndarray>\n    lcc              (time, lat, lon) float32 15MB dask.array<chunksize=(1, 82, 151), meta=np.ndarray>\n    lst              (time, lat, lon) float64 29MB dask.array<chunksize=(1, 82, 151), meta=np.ndarray>\n    lst_unc_loc_atm  (time, lat, lon) float64 29MB dask.array<chunksize=(1, 82, 151), meta=np.ndarray>\n    lst_unc_loc_cor  (time, lat, lon) float64 29MB dask.array<chunksize=(1, 82, 151), meta=np.ndarray>\n    lst_unc_loc_sfc  (time, lat, lon) float64 29MB dask.array<chunksize=(1, 82, 151), meta=np.ndarray>\n    ...               ...\n    lst_uncertainty  (time, lat, lon) float64 29MB dask.array<chunksize=(1, 82, 151), meta=np.ndarray>\n    n                (time, lat, lon) float32 15MB dask.array<chunksize=(1, 82, 151), meta=np.ndarray>\n    sataz            (time, lat, lon) float64 29MB dask.array<chunksize=(1, 82, 151), meta=np.ndarray>\n    satze            (time, lat, lon) float64 29MB dask.array<chunksize=(1, 82, 151), meta=np.ndarray>\n    solaz            (time, lat, lon) float64 29MB dask.array<chunksize=(1, 82, 151), meta=np.ndarray>\n    solze            (time, lat, lon) float64 29MB dask.array<chunksize=(1, 82, 151), meta=np.ndarray>\nAttributes: (12/44)\n    Conventions:                CF-1.8\n    catalogue_url:              https://catalogue.ceda.ac.uk/uuid/6babb8d9a8d...\n    cdm_data_type:              grid\n    comment:                    These data were produced as part of the ESA L...\n    creator_email:              djg20@le.ac.uk\n    creator_name:               University of Leicester Surface Temperature G...\n    ...                         ...\n    time_coverage_end:          19700101T000001Z\n    time_coverage_resolution:   P1M\n    time_coverage_start:        19700101T000001Z\n    title:                      ESA LST CCI land surface temperature time ser...\n    geospatial_bounds_crs:      CRS84\n    geospatial_bounds:          POLYGON((172.29998779296875 -44.0100021362304...","content_type":"text/plain"}}}],"key":"FH7M6gUjKn"}],"key":"MJ2jUfrdrq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#average LST around Christchurch area\nlst_ds_C_mean=lst_ds_C.lst.mean(dim=('lat','lon'))","key":"cTv4upU10r"},{"type":"output","id":"IMCJeYKT_cp32_HU-8rZb","data":[],"key":"WDUc2naQbU"}],"key":"afna1jHrx5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lst_ds_C_mean","key":"EzBy5JIcfF"},{"type":"output","id":"6ch3zr5oOvHsa-gCse4kT","data":[{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"‚ñ∫\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"‚ñº\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;lst&#x27; (time: 294)&gt; Size: 2kB\ndask.array&lt;mean_agg-aggregate, shape=(294,), dtype=float64, chunksize=(1,), chunktype=numpy.ndarray&gt;\nCoordinates:\n  * time     (time) datetime64[ns] 2kB 1995-08-01 1995-09-01 ... 2020-12-01</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'lst'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 294</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-bef49c7a-3762-40c1-80be-1518b69f36fd' class='xr-array-in' type='checkbox' checked><label for='section-bef49c7a-3762-40c1-80be-1518b69f36fd' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1,), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>\n    <tr>\n        <td>\n            <table style=\"border-collapse: collapse;\">\n                <thead>\n                    <tr>\n                        <td> </td>\n                        <th> Array </th>\n                        <th> Chunk </th>\n                    </tr>\n                </thead>\n                <tbody>\n                    \n                    <tr>\n                        <th> Bytes </th>\n                        <td> 2.30 kiB </td>\n                        <td> 8 B </td>\n                    </tr>\n                    \n                    <tr>\n                        <th> Shape </th>\n                        <td> (294,) </td>\n                        <td> (1,) </td>\n                    </tr>\n                    <tr>\n                        <th> Dask graph </th>\n                        <td colspan=\"2\"> 294 chunks in 5 graph layers </td>\n                    </tr>\n                    <tr>\n                        <th> Data type </th>\n                        <td colspan=\"2\"> float64 numpy.ndarray </td>\n                    </tr>\n                </tbody>\n            </table>\n        </td>\n        <td>\n        <svg width=\"170\" height=\"75\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n\n  <!-- Horizontal lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"120\" y2=\"0\" style=\"stroke-width:2\" />\n  <line x1=\"0\" y1=\"25\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"25\" style=\"stroke-width:2\" />\n  <line x1=\"6\" y1=\"0\" x2=\"6\" y2=\"25\" />\n  <line x1=\"12\" y1=\"0\" x2=\"12\" y2=\"25\" />\n  <line x1=\"18\" y1=\"0\" x2=\"18\" y2=\"25\" />\n  <line x1=\"24\" y1=\"0\" x2=\"24\" y2=\"25\" />\n  <line x1=\"31\" y1=\"0\" x2=\"31\" y2=\"25\" />\n  <line x1=\"37\" y1=\"0\" x2=\"37\" y2=\"25\" />\n  <line x1=\"44\" y1=\"0\" x2=\"44\" y2=\"25\" />\n  <line x1=\"50\" y1=\"0\" x2=\"50\" y2=\"25\" />\n  <line x1=\"56\" y1=\"0\" x2=\"56\" y2=\"25\" />\n  <line x1=\"62\" y1=\"0\" x2=\"62\" y2=\"25\" />\n  <line x1=\"69\" y1=\"0\" x2=\"69\" y2=\"25\" />\n  <line x1=\"75\" y1=\"0\" x2=\"75\" y2=\"25\" />\n  <line x1=\"82\" y1=\"0\" x2=\"82\" y2=\"25\" />\n  <line x1=\"88\" y1=\"0\" x2=\"88\" y2=\"25\" />\n  <line x1=\"94\" y1=\"0\" x2=\"94\" y2=\"25\" />\n  <line x1=\"100\" y1=\"0\" x2=\"100\" y2=\"25\" />\n  <line x1=\"107\" y1=\"0\" x2=\"107\" y2=\"25\" />\n  <line x1=\"113\" y1=\"0\" x2=\"113\" y2=\"25\" />\n  <line x1=\"120\" y1=\"0\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485\" style=\"fill:#8B4903A0;stroke-width:0\"/>\n\n  <!-- Text -->\n  <text x=\"60.000000\" y=\"45.412617\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >294</text>\n  <text x=\"140.000000\" y=\"12.706308\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,140.000000,12.706308)\">1</text>\n</svg>\n        </td>\n    </tr>\n</table></div></div></li><li class='xr-section-item'><input id='section-8a9ba622-24a9-47d7-bf77-0b14d5a29c94' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8a9ba622-24a9-47d7-bf77-0b14d5a29c94' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1995-08-01 ... 2020-12-01</div><input id='attrs-cda67f33-aacb-46d3-b350-8dea57030826' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cda67f33-aacb-46d3-b350-8dea57030826' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e28f8e21-601e-40e2-b133-6518a852f2cb' class='xr-var-data-in' type='checkbox'><label for='data-e28f8e21-601e-40e2-b133-6518a852f2cb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>reference time of file</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1995-08-01T00:00:00.000000000&#x27;, &#x27;1995-09-01T00:00:00.000000000&#x27;,\n       &#x27;1995-10-01T00:00:00.000000000&#x27;, ..., &#x27;2020-10-01T00:00:00.000000000&#x27;,\n       &#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;],\n      shape=(294,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c8eb0e6c-a808-46b9-b678-cce585709568' class='xr-section-summary-in' type='checkbox'  ><label for='section-c8eb0e6c-a808-46b9-b678-cce585709568' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-0d567496-dc3d-41f8-af26-2a4e13a3a6de' class='xr-index-data-in' type='checkbox'/><label for='index-0d567496-dc3d-41f8-af26-2a4e13a3a6de' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1995-08-01&#x27;, &#x27;1995-09-01&#x27;, &#x27;1995-10-01&#x27;, &#x27;1995-11-01&#x27;,\n               &#x27;1995-12-01&#x27;, &#x27;1996-07-01&#x27;, &#x27;1996-08-01&#x27;, &#x27;1996-09-01&#x27;,\n               &#x27;1996-10-01&#x27;, &#x27;1996-11-01&#x27;,\n               ...\n               &#x27;2020-03-01&#x27;, &#x27;2020-04-01&#x27;, &#x27;2020-05-01&#x27;, &#x27;2020-06-01&#x27;,\n               &#x27;2020-07-01&#x27;, &#x27;2020-08-01&#x27;, &#x27;2020-09-01&#x27;, &#x27;2020-10-01&#x27;,\n               &#x27;2020-11-01&#x27;, &#x27;2020-12-01&#x27;],\n              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=294, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-67d080dc-7c98-4750-99fe-ffb80617dd71' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-67d080dc-7c98-4750-99fe-ffb80617dd71' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'lst' (time: 294)> Size: 2kB\ndask.array<mean_agg-aggregate, shape=(294,), dtype=float64, chunksize=(1,), chunktype=numpy.ndarray>\nCoordinates:\n  * time     (time) datetime64[ns] 2kB 1995-08-01 1995-09-01 ... 2020-12-01","content_type":"text/plain"}}}],"key":"aog7QgChOO"}],"key":"MLc7egPnaf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure(figsize=(12,3))\n# Define the axes\nax = fig.add_subplot(1,1,1) \n\n# plot the yearly mean\nlst_ds_C_mean.plot(c='crimson',linewidth=1,label='daily',marker='.')\n\n# add the labels for the axes and the title and the legend\nplt.legend()\nplt.grid()\nplt.ylabel('LST (¬∞C)')\nplt.xlabel('Year')\nplt.title(\"Time series of the yearly LST mean around Christchurch (1995-2020)\")\nplt.show()","key":"mIHIXIApdt"},{"type":"output","id":"G4gaz5UM6Q4Vm-PkFgY4o","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"65b501169713198347dc389cc0a8e4fd","path":"/cci-notebook-viewers/build/65b501169713198347dc389cc0a8e4fd.png"},"text/plain":{"content":"<Figure size 1200x300 with 1 Axes>","content_type":"text/plain"}}}],"key":"d6HdI0uqI0"}],"key":"wH9qlyOH0r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lst_ds_C_mean","key":"JKtBUTcxmq"},{"type":"output","id":"3Kaf_SOqphZxfiM5PMdNN","data":[{"output_type":"execute_result","execution_count":58,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"‚ñ∫\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"‚ñº\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;lst&#x27; (time: 294)&gt; Size: 2kB\ndask.array&lt;mean_agg-aggregate, shape=(294,), dtype=float64, chunksize=(1,), chunktype=numpy.ndarray&gt;\nCoordinates:\n  * time     (time) datetime64[ns] 2kB 1995-08-01 1995-09-01 ... 2020-12-01</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'lst'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 294</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-c50a80e9-189d-497d-a1f8-c93deb9f938b' class='xr-array-in' type='checkbox' checked><label for='section-c50a80e9-189d-497d-a1f8-c93deb9f938b' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1,), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>\n    <tr>\n        <td>\n            <table style=\"border-collapse: collapse;\">\n                <thead>\n                    <tr>\n                        <td> </td>\n                        <th> Array </th>\n                        <th> Chunk </th>\n                    </tr>\n                </thead>\n                <tbody>\n                    \n                    <tr>\n                        <th> Bytes </th>\n                        <td> 2.30 kiB </td>\n                        <td> 8 B </td>\n                    </tr>\n                    \n                    <tr>\n                        <th> Shape </th>\n                        <td> (294,) </td>\n                        <td> (1,) </td>\n                    </tr>\n                    <tr>\n                        <th> Dask graph </th>\n                        <td colspan=\"2\"> 294 chunks in 5 graph layers </td>\n                    </tr>\n                    <tr>\n                        <th> Data type </th>\n                        <td colspan=\"2\"> float64 numpy.ndarray </td>\n                    </tr>\n                </tbody>\n            </table>\n        </td>\n        <td>\n        <svg width=\"170\" height=\"75\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n\n  <!-- Horizontal lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"120\" y2=\"0\" style=\"stroke-width:2\" />\n  <line x1=\"0\" y1=\"25\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" />\n\n  <!-- Vertical lines -->\n  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"25\" style=\"stroke-width:2\" />\n  <line x1=\"6\" y1=\"0\" x2=\"6\" y2=\"25\" />\n  <line x1=\"12\" y1=\"0\" x2=\"12\" y2=\"25\" />\n  <line x1=\"18\" y1=\"0\" x2=\"18\" y2=\"25\" />\n  <line x1=\"24\" y1=\"0\" x2=\"24\" y2=\"25\" />\n  <line x1=\"31\" y1=\"0\" x2=\"31\" y2=\"25\" />\n  <line x1=\"37\" y1=\"0\" x2=\"37\" y2=\"25\" />\n  <line x1=\"44\" y1=\"0\" x2=\"44\" y2=\"25\" />\n  <line x1=\"50\" y1=\"0\" x2=\"50\" y2=\"25\" />\n  <line x1=\"56\" y1=\"0\" x2=\"56\" y2=\"25\" />\n  <line x1=\"62\" y1=\"0\" x2=\"62\" y2=\"25\" />\n  <line x1=\"69\" y1=\"0\" x2=\"69\" y2=\"25\" />\n  <line x1=\"75\" y1=\"0\" x2=\"75\" y2=\"25\" />\n  <line x1=\"82\" y1=\"0\" x2=\"82\" y2=\"25\" />\n  <line x1=\"88\" y1=\"0\" x2=\"88\" y2=\"25\" />\n  <line x1=\"94\" y1=\"0\" x2=\"94\" y2=\"25\" />\n  <line x1=\"100\" y1=\"0\" x2=\"100\" y2=\"25\" />\n  <line x1=\"107\" y1=\"0\" x2=\"107\" y2=\"25\" />\n  <line x1=\"113\" y1=\"0\" x2=\"113\" y2=\"25\" />\n  <line x1=\"120\" y1=\"0\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" />\n\n  <!-- Colored Rectangle -->\n  <polygon points=\"0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485\" style=\"fill:#8B4903A0;stroke-width:0\"/>\n\n  <!-- Text -->\n  <text x=\"60.000000\" y=\"45.412617\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >294</text>\n  <text x=\"140.000000\" y=\"12.706308\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,140.000000,12.706308)\">1</text>\n</svg>\n        </td>\n    </tr>\n</table></div></div></li><li class='xr-section-item'><input id='section-f1b24da9-442e-4c06-875d-7da83768d73f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f1b24da9-442e-4c06-875d-7da83768d73f' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1995-08-01 ... 2020-12-01</div><input id='attrs-8e6fc4e3-5a05-4ae0-b514-569f5c07aa8a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8e6fc4e3-5a05-4ae0-b514-569f5c07aa8a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c72e4b33-8e61-4415-b4d4-88acdf21245f' class='xr-var-data-in' type='checkbox'><label for='data-c72e4b33-8e61-4415-b4d4-88acdf21245f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>reference time of file</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1995-08-01T00:00:00.000000000&#x27;, &#x27;1995-09-01T00:00:00.000000000&#x27;,\n       &#x27;1995-10-01T00:00:00.000000000&#x27;, ..., &#x27;2020-10-01T00:00:00.000000000&#x27;,\n       &#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;],\n      shape=(294,), dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a8aeb710-4373-4716-9305-0ffe0334f5c5' class='xr-section-summary-in' type='checkbox'  ><label for='section-a8aeb710-4373-4716-9305-0ffe0334f5c5' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-8c300258-ba4d-4ae7-bdfe-2b4d33b00e81' class='xr-index-data-in' type='checkbox'/><label for='index-8c300258-ba4d-4ae7-bdfe-2b4d33b00e81' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1995-08-01&#x27;, &#x27;1995-09-01&#x27;, &#x27;1995-10-01&#x27;, &#x27;1995-11-01&#x27;,\n               &#x27;1995-12-01&#x27;, &#x27;1996-07-01&#x27;, &#x27;1996-08-01&#x27;, &#x27;1996-09-01&#x27;,\n               &#x27;1996-10-01&#x27;, &#x27;1996-11-01&#x27;,\n               ...\n               &#x27;2020-03-01&#x27;, &#x27;2020-04-01&#x27;, &#x27;2020-05-01&#x27;, &#x27;2020-06-01&#x27;,\n               &#x27;2020-07-01&#x27;, &#x27;2020-08-01&#x27;, &#x27;2020-09-01&#x27;, &#x27;2020-10-01&#x27;,\n               &#x27;2020-11-01&#x27;, &#x27;2020-12-01&#x27;],\n              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=294, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-642a14ae-ca84-4f01-909c-65c809f9b666' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-642a14ae-ca84-4f01-909c-65c809f9b666' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'lst' (time: 294)> Size: 2kB\ndask.array<mean_agg-aggregate, shape=(294,), dtype=float64, chunksize=(1,), chunktype=numpy.ndarray>\nCoordinates:\n  * time     (time) datetime64[ns] 2kB 1995-08-01 1995-09-01 ... 2020-12-01","content_type":"text/plain"}}}],"key":"JnhRq3S6m2"}],"key":"uQglxhDYom"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"span","style":{"color":"blue"},"children":[{"type":"text","value":"‚Üí How to save the time series as csv","key":"MBGGUiKyqp"}],"key":"Y7qcBUGlZb"}],"identifier":"id-how-to-save-the-time-series-as-csv","label":"‚Üí How to save the time series as csv","html_id":"id-how-to-save-the-time-series-as-csv","implicit":true,"key":"aUsqMqCQ3i"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"You can save the time series as ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Hl5CDZMoUt"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"csv","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SMxpWnMaUD"}],"key":"xmMc6aYVcy"},{"type":"text","value":" file like this:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"R5fFYxxNSb"}],"key":"qvNJnJ9CVd"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineCode","value":"lst_ds_C_mean.to_dataframe(name=\"lst\").to_csv(\"lst_timeseries.csv\")","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iviAaiu1j6"}],"key":"MrJJirajHh"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"‚Üí see next cell, where you can uncomment the command","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cW0eCFeikO"}],"key":"keP7X67M5h"}],"key":"uBAFHpcJug"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lst_ds_C_mean.to_dataframe(name=\"lst\").to_csv(\"lst_timeseries.csv\")","key":"mLh1DiOZE3"},{"type":"output","id":"v8170QQJiqHb6_2Yw_sVG","data":[],"key":"AKQXqOEgtM"}],"key":"Zoq6ZlI2Dz"}],"key":"YoaehakPoU"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"ect-training","url":"/external-notebooks/esa-cci/ect-training/readme","group":"Ect Training"},"next":{"title":"README","url":"/external-notebooks/esa-cci/ect-training/adaptation-futures-nz-10-2025/readme","group":"Adaptation Futures NZ 10 2025"}}},"domain":"http://localhost:3000"}